jQuery((function(e){function t(t,i){var a={onChange:null},n={contain:null,pageLeft:null,pageRight:null,currentPage:null},o=function(){var e=n.currentPage.children().length,t=Number(n.currentPage.val());n.pageLeft.hide(),n.pageRight.hide(),t>1&&n.pageLeft.show(),t+1<=e&&n.pageRight.show()};this.getCurrentPage=function(){return n.currentPage.val()},this.setNumPage=function(t){n.currentPage.empty();for(var i=1;i<=t;i++)e(document.createElement("option")).val(i).text(i).appendTo(n.currentPage);o()},e.extend(n,{contain:t,pageLeft:t.find(".navigationLeft"),pageRight:t.find(".navigationRight"),currentPage:t.find(".navigationCurrentPage")}),e.extend(a,i),n.pageLeft.on("click",(function(){n.currentPage.val(Number(n.currentPage.val())-1),o(),a.onChange&&a.onChange(n.currentPage.val())})),n.pageRight.on("click",(function(){n.currentPage.val(Number(n.currentPage.val())+1),o(),a.onChange&&a.onChange(n.currentPage.val())})),n.currentPage.on("change",(function(){o(),a.onChange&&a.onChange(n.currentPage.val())}))}e.fn.wpProQuiz_preview=function(){var t=function(t){window.open(e(t).attr("href"),"wpProQuizPreview","width=900,height=900")};e(".wpProQuiz_prview").on("click",(function(e){t(this),e.preventDefault()}))},e.fn.wpProQuiz_quizOverall=function(){var t=function(t){$input=e(t),$export=e(".wpProQuiz_exportList"),$ul=$export.find("ul").first(),$export.find("li").remove(),e('input[name="exportItems"]').each((function(){if($this=e(this),this.checked){var t=$this.parent().parent().find(".wpProQuiz_quizName a:eq(0)").text();e("<li>"+t+"</li>").appendTo($ul)}}))},i=function(){return $ele=e('input[name="exportItems"]:checked'),$ele.length<1?(alert(wpProQuizLocalize.no_selected_quiz),!1):($hidden=e("#exportHidden"),$hidden.html(""),e('input[name="exportItems"]').each((function(){$this=e(this),this.checked&&e('<input type="hidden" value="'+this.value+'" name="exportIds[]">').appendTo($hidden)})),!0)};e(".wpProQuiz_delete").on("click",(function(e){return!!confirm(wpProQuizLocalize.delete_msg)||(e.preventDefault(),!1)})),e(".wpProQuiz_import").on("click",(function(t){t.preventDefault(),e(".wpProQuiz_importList").toggle("fast"),e(".wpProQuiz_exportList").hide(),e(".wpProQuiz_exportCheck").hide()})),e(".wpProQuiz_export").on("click",(function(t){t.preventDefault(),e(".wpProQuiz_exportList").toggle("fast"),e(".wpProQuiz_exportCheck").toggle("fast"),e(".wpProQuiz_importList").hide()})),e('input[name="exportItems"]').on("change",(function(){t(this)})),e('input[name="exportItemsAll"]').on("change",(function(){var t=e('input[name="exportItems"]');this.checked?t.attr("checked",!0):t.attr("checked",!1),t.change()})),e("#exportStart").on("click",(function(e){i()||e.preventDefault()}))},e.fn.wpProQuiz_questionOverall=function(){var t={saveSort:function(){var i={action:"wp_pro_quiz_update_sort",nonce:jQuery("#wpProQuiz_nonce").data("nonce"),sort:t.parseSortArray()},a=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=save_sort";e.post(a,i,(function(t){e("#sortMsg").show(400).delay(1e3).hide(400)}))},parseSortArray:function(){var t=new Array;return e("tbody tr").each((function(){t.push(this.id.replace("wpProQuiz_questionId_",""))})),t},sortUpdate:function(t,i){e(".wpProQuiz_questionOverall tbody").children().each((function(){$t=e(this).children().first().text(e(this).index()+1)}))},loadQuestionCopy:function(){var t=e("#questionCopySelect"),i=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_question",a={action:"wp_pro_quiz_load_question",nonce:jQuery("#wpProQuiz_nonce").data("nonce"),excludeId:1};t.hide(),t.empty(),e("#loadDataImg").show(),e.post(i,a,(function(i){e.each(i,(function(i,a){var n=e(document.createElement("optgroup"));n.attr("label",a.name),e.each(a.question,(function(t,i){e(document.createElement("option")).val(i.id).text(i.name).appendTo(n)})),t.append(n)})),e("#loadDataImg").hide(),t.show()}),"json")}};e(".wp-list-table tbody").sortable({handle:".wpProQuiz_move",update:t.sortUpdate}),e(".wpProQuiz_delete").on("click",(function(e){return!!confirm(wpProQuizLocalize.delete_msg)||(e.preventDefault(),!1)})),e("#wpProQuiz_saveSort").on("click",(function(e){e.preventDefault(),t.saveSort()})),e("#wpProQuiz_questionCopy").on("click",(function(i){var a=e(".wpProQuiz_questionCopy");a.is(":visible")?a.hide():(a.show(),t.loadQuestionCopy()),i.preventDefault()}))},e.fn.wpProQuiz_quizEdit=function(){var t={addResult:function(){e("#resultList").children().each((function(){if("none"==e(this).css("display")){var t=e(this),i=t.find('textarea[name="resultTextGrade[text][]"]'),a=i.attr("id"),n=!0;return t.find('input[name="resultTextGrade[prozent][]"]').val("1"),t.find('input[name="resultTextGrade[activ][]"]').val("1").keyup(),"undefined"==typeof tinymce||null==tinymce.editors[a]||tinymce.editors[a].isHidden()||(n=!1),null==switchEditors||n||(switchEditors.go(a,"toggle"),switchEditors.go(a,"toggle")),"undefined"!=typeof tinymce&&null!=tinymce.editors[a]?tinymce.editors[a].setContent(""):i.val(""),"undefined"==typeof tinymce||null==tinymce.editors[a]||n||tinyMCE.execCommand("mceRemoveControl",!1,a),t.parent().children(":visible").last().after(t),"undefined"==typeof tinymce||null==tinymce.editors[a]||n||tinyMCE.execCommand("mceAddControl",!1,a),e(this).show(),null==switchEditors||n||switchEditors.go(a,"toggle"),!1}}))},deleteResult:function(t){e(t).parent().parent().hide(),e(t).siblings('input[name="resultTextGrade[activ][]"]').val("0")},changeResult:function(i){var a=e(i);return t.validResultInput(a.val())?(a.siblings(".resultProzent").text(a.val()),a.removeAttr("style"),!0):(a.css("background-color","#FF9696"),!1)},validResultInput:function(e){return!i(e)&&(e=e.replace(/\,/,"."),!isNaN(e)&&Number(e)<=100&&Number(e)>=0&&(null==e.match(/\./)||e.split(".")[1].length<3))},validInput:function(){if(i(e("#wpProQuiz_title").val()))return alert(wpProQuizLocalize.no_title_msg),!1;var a="";if(a="undefined"==typeof tinymce||null==tinymce.editors.text||tinymce.editors.text.isHidden()?e('textarea[name="text"]').val():tinymce.editors.text.getContent(),i(a))return alert(wpProQuizLocalize.no_quiz_start_msg),!1;if(e("#wpProQuiz_resultGradeEnabled:checked").length){var n=!0;if(e("#resultList").children().each((function(){if(e(this).is(":visible")&&!t.validResultInput(e(this).find('input[name="resultTextGrade[prozent][]"]').val()))return n=!1,!1})),!n)return alert(wpProQuizLocalize.fail_grade_result),!1}return!0},resetLock:function(){var t=(window.location.pathname+window.location.search).replace("post.php","admin-ajax.php");t=t.replace("action=edit","action=reset_lock");var i=e('input[name="resetQuizLock"]').data("nonce");e.post(t,{action:"wp_pro_quiz_reset_lock",nonce:i},(function(t){e("#resetLockMsg").show("fast").delay(2e3).hide("fast")}))},generateFormIds:function(){var t=0;e("#form_table tbody > tr").each((function(){e(this).find('[name^="form[]"]').each((function(){var i=e(this).attr("name").substr(6);e(this).attr("name","form["+t+"]"+i)})),++t}))}},i=function(t){return!(t=e.trim(t))||0===t.length};e("#statistics_on").on("change",(function(){this.checked?(e("#statistics_ip_lock_tr").show(),e("#statistics_show_profile_tr").show()):(e("#statistics_ip_lock_tr").hide(),e("#statistics_show_profile_tr").hide())})),e(".addResult").on("click",(function(){t.addResult()})),e(".deleteResult").on("click",(function(e){t.deleteResult(this)})),e('input[name="resultTextGrade[prozent][]"]').keyup((function(e){t.changeResult(this)})).keydown((function(e){13==e.which&&e.preventDefault()})),e("#wpProQuiz_resultGradeEnabled").on("change",(function(){this.checked?(e("#resultGrade").show(),e("#resultNormal").hide()):(e("#resultGrade").hide(),e("#resultNormal").show())})),window.postL10n?(e("#wpProQuiz_save,input[name=save]").on("click",(function(i){t.generateFormIds(),e('select[name="prerequisiteList[]"] option').attr("selected","selected")})),e("#publish").on("click",(function(){t.generateFormIds(),e('select[name="prerequisiteList[]"] option').attr("selected","selected")})),e("#save-post").on("click",(function(){t.generateFormIds(),e('select[name="prerequisiteList[]"] option').attr("selected","selected")}))):window.wp.data.subscribe((()=>{!0===window.wp.data.select("core/editor").isSavingPost()&&(t.generateFormIds(),e('select[name="prerequisiteList[]"] option').attr("selected","selected"))})),e('input[name="template"]').on("click",(function(a){if("0"==e('select[name="templateSaveList"]').val()&&i(e('input[name="templateName"]').val()))return alert(wpProQuizLocalize.temploate_no_name),a.preventDefault(),!1;t.generateFormIds(),e('select[name="prerequisiteList[]"] option').attr("selected","selected")})),e('select[name="templateSaveList"]').on("change",(function(){var t=e('input[name="templateName"]');"0"==e(this).val()?t.show():t.hide()})).change(),e('input[name="quizRunOnce"]').on("change",(function(t){this.checked?(e("#wpProQuiz_quiz_run_once_type").show(),e('input[name="quizRunOnceType"]:checked').change()):e("#wpProQuiz_quiz_run_once_type").hide()})),e('input[name="quizRunOnceType"]').on("change",(function(t){!this.checked||"1"!=this.value&&"3"!=this.value?e("#wpProQuiz_quiz_run_once_cookie").hide():e("#wpProQuiz_quiz_run_once_cookie").show()})),e('input[name="resetQuizLock"]').on("click",(function(e){return t.resetLock(),!1})),e(".wpProQuiz_demoBox a").mouseover((function(t){var i=e(this),a=e(document).width(),n=i.siblings().outerWidth(!0);if(t.pageX+n>a){var o=a-(t.pageX+n+30);e(this).next().css("left",o+"px")}e(this).next().show()})).mouseout((function(){e(this).next().hide()})).on("click",(function(){return!1})),e('input[name="showMaxQuestion"]').on("change",(function(){this.checked?e("#wpProQuiz_showMaxBox").show():e("#wpProQuiz_showMaxBox").hide()})),e("#btnPrerequisiteAdd").on("click",(function(){e('select[name="quizList"] option:selected').removeAttr("selected").appendTo('select[name="prerequisiteList[]"]')})),e("#btnPrerequisiteDelete").on("click",(function(){e('select[name="prerequisiteList[]"] option:selected').removeAttr("selected").appendTo('select[name="quizList"]')})),e('input[name="prerequisite"]').on("change",(function(){this.checked?e("#prerequisiteBox").show():e("#prerequisiteBox").hide()})).change(),e('input[name="toplistDataAddMultiple"]').on("change",(function(){this.checked?e("#toplistDataAddBlockBox").show():e("#toplistDataAddBlockBox").hide()})).change(),e('input[name="toplistActivated"]').on("change",(function(){this.checked?e("#toplistBox > tr:gt(0)").show():e("#toplistBox > tr:gt(0)").hide()})).change(),e('input[name="showReviewQuestion"]').on("change",(function(){this.checked?e(".wpProQuiz_reviewQuestionOptions").show():e(".wpProQuiz_reviewQuestionOptions").hide()})).change(),e("#statistics_on").change(),e("#wpProQuiz_resultGradeEnabled").change(),e('input[name="quizRunOnce"]').change(),e('input[name="quizRunOnceType"]:checked').change(),e('input[name="showMaxQuestion"]').change(),e("#form_add").on("click",(function(){e("#form_table tbody > tr:eq(0)").clone(!0).appendTo("#form_table tbody").show(),e('#form_table tbody tr:last input[type="text"]').focus()})),e('input[name="form_delete"]').on("click",(function(){var t=e(this).parents("tr");"0"!=t.find('input[name="form[][form_id]"]').val()?(t.find('input[name="form[][form_delete]"]').val(1),t.hide()):t.remove()})),e("#form_table tbody").sortable({handle:".form_move",update:t.sortUpdate}),e(".form_move").on("click",(function(){return!1})),e('select[name="form[][type]"]').on("change",(function(){switch(Number(e(this).val())){case 7:case 8:e(this).siblings(".editDropDown").show();break;default:e(this).siblings(".editDropDown, .dropDownEditBox").hide()}})).change(),e(".editDropDown").on("click",(function(){return e(".dropDownEditBox").not(e(this).siblings(".dropDownEditBox").toggle()).hide(),!1})),e(".dropDownEditBox input").on("click",(function(){e(this).parent().hide()}))},e.fn.wpProQuiz_statistics=function(){var t="wpProQuiz_typeAnonymeUser",i=!0,a={loadStatistics:function(t){var i=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_statistics",n={action:"wp_pro_quiz_load_statistics",userId:t};e("#wpProQuiz_loadData").show(),e("#wpProQuiz_statistics_content, #wpProQuiz_statistics_overview").hide(),e.post(i,n,a.setStatistics,"json")},setStatistics:function(i){var a=e(".wpProQuiz_statistics_table"),n=a.find("tbody");if("wpProQuiz_typeOverview"!=t){var o=function(e,t,i){e.find(".wpProQuiz_cCorrect").text(t.cCorrect+" ("+t.pCorrect+"%)"),e.find(".wpProQuiz_cIncorrect").text(t.cIncorrect+" ("+t.pIncorrect+"%)"),e.find(".wpProQuiz_cTip").text(t.cTip),e.find(".wpProQuiz_cPoints").text(t.cPoints),1==i&&a.find(".wpProQuiz_cResult").text(t.result+"%")};o(a,i.clear,!1),e.each(i.items,(function(e,t){o(n.find("#wpProQuiz_tr_"+t.id),t,!1)})),o(a.find("tfoot"),i.global,!0),e("#wpProQuiz_loadData").hide(),e("#wpProQuiz_statistics_content, .wpProQuiz_statistics_table").show()}},loadOverview:function(){e(".wpProQuiz_statistics_table, #wpProQuiz_statistics_content, #wpProQuiz_statistics_overview").hide(),e("#wpProQuiz_loadData").show();var n=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_statistics",o={action:"wp_pro_quiz_load_statistics",overview:!0,pageLimit:e("#wpProQuiz_pageLimit").val(),onlyCompleted:Number(e("#wpProQuiz_onlyCompleted").is(":checked")),page:e("#wpProQuiz_currentPage").val(),generatePageNav:Number(i)};e.post(n,o,(function(n){if(e("#wpProQuiz_statistics_overview_data").empty(),"wpProQuiz_typeOverview"==t){var o=e('<tr><th><a href="#">---</a></th><th class="wpProQuiz_points">---</th><th class="wpProQuiz_cCorrect" style="color: green;">---</th><th class="wpProQuiz_cIncorrect" style="color: red;">---</th><th class="wpProQuiz_cTip">---</th><th class="wpProQuiz_cResult" style="font-weight: bold;">---</th></tr>');e.each(n.items,(function(t,i){var a=o.clone();a.find("a").text(i.userName).data("userId",i.userId).on("click",(function(){return e("#userSelect").val(e(this).data("userId")),e("#wpProQuiz_typeRegisteredUser").click(),!1})),i.completed?(a.find(".wpProQuiz_points").text(i.cPoints),a.find(".wpProQuiz_cCorrect").text(i.cCorrect+" ("+i.pCorrect+"%)"),a.find(".wpProQuiz_cIncorrect").text(i.cIncorrect+" ("+i.pIncorrect+"%)"),a.find(".wpProQuiz_cTip").text(i.cTip),a.find(".wpProQuiz_cResult").text(i.result+"%")):a.find("th").removeAttr("style"),e("#wpProQuiz_statistics_overview_data").append(a)})),null!=n.page&&(a.setPageNav(n.page),i=!1),e("#wpProQuiz_loadData").hide(),e("#wpProQuiz_statistics_overview").show()}}),"json")},loadFormOverview:function(){e("#wpProQuiz_tabFormOverview").show()},changeTab:function(i){t=i,"wpProQuiz_typeRegisteredUser"==i?a.loadStatistics(e("#userSelect").val()):"wpProQuiz_typeAnonymeUser"==i?a.loadStatistics(0):"wpProQuiz_typeForm"==i?a.loadFormOverview():a.loadOverview()},resetStatistic:function(i){var n="wpProQuiz_typeRegisteredUser"==t?e("#userSelect").val():0,o=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=reset",r={action:"wp_pro_quiz_statistics",userId:n,complete:i};e.post(o,r,(function(e){a.changeTab(t)}))},setPageNav:function(t){t=Math.ceil(t/e("#wpProQuiz_pageLimit").val()),e("#wpProQuiz_currentPage").empty();for(var i=1;i<=t;i++)e(document.createElement("option")).val(i).text(i).appendTo(e("#wpProQuiz_currentPage"));e("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").hide(),e("#wpProQuiz_currentPage option").length>1&&e("#wpProQuiz_pageRight").show()}};e(".wpProQuiz_tab").on("click",(function(t){var i=e(this);return i.hasClass("button-primary")||("wpProQuiz_typeRegisteredUser"==i.attr("id")?e("#wpProQuiz_userBox").show():e("#wpProQuiz_userBox").hide(),e(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary"),i.removeClass("button-secondary").addClass("button-primary"),a.changeTab(i.attr("id"))),!1})),e("#userSelect").on("change",(function(){a.changeTab("wpProQuiz_typeRegisteredUser")})),e(".wpProQuiz_update").on("click",(function(){return a.changeTab(t),!1})),e("#wpProQuiz_reset").on("click",(function(){return confirm(wpProQuizLocalize.reset_statistics_msg)&&a.resetStatistic(!1),!1})),e(".wpProQuiz_resetComplete").on("click",(function(){return confirm(wpProQuizLocalize.reset_statistics_msg)&&a.resetStatistic(!0),!1})),e("#wpProQuiz_pageLimit, #wpProQuiz_onlyCompleted").on("change",(function(){return e("#wpProQuiz_currentPage").val(0),i=!0,a.changeTab(t),!1})),e("#wpProQuiz_currentPage").on("change",(function(){e("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").hide(),1==e("#wpProQuiz_currentPage option").length||(e("#wpProQuiz_currentPage option:first-child:selected").length?e("#wpProQuiz_pageRight").show():e("#wpProQuiz_currentPage option:last-child:selected").length?e("#wpProQuiz_pageLeft").show():e("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").show()),a.changeTab(t)})),e("#wpProQuiz_pageRight").on("click",(function(){return e("#wpProQuiz_currentPage option:selected").next().attr("selected","selected"),e("#wpProQuiz_currentPage").change(),!1})),e("#wpProQuiz_pageLeft").on("click",(function(){return e("#wpProQuiz_currentPage option:selected").prev().attr("selected","selected"),e("#wpProQuiz_currentPage").change(),!1})),a.changeTab("wpProQuiz_typeAnonymeUser")},e.fn.wpProQuiz_toplist=function(){var t={sort:e("#wpProQuiz_sorting"),pageLimit:e("#wpProQuiz_pageLimit"),currentPage:e("#wpProQuiz_currentPage"),loadDataBox:e("#wpProQuiz_loadData"),pageLeft:e("#wpProQuiz_pageLeft"),pageRight:e("#wpProQuiz_pageRight"),dataBody:e("#wpProQuiz_toplistTable tbody"),rowClone:e("#wpProQuiz_toplistTable tbody tr:eq(0)").clone(),content:e("#wpProQuiz_content")},i={loadData:function(i){var a=(window.location.pathname+window.location.search).replace("admin.php","admin-ajax.php")+"&action=load_toplist",n=e("#wpProQuiz_loadData").data("nonce"),o=this,r={action:"wp_pro_quiz_load_toplist",nonce:n,sort:t.sort.val(),limit:t.pageLimit.val(),page:t.currentPage.val()};null!=i&&e.extend(r,i),t.loadDataBox.show(),t.content.hide(),e.post(a,r,(function(e){o.handleDataRequest(e.data),null!=e.nav&&o.handleNav(e.nav),t.loadDataBox.hide(),t.content.show()}),"json")},handleNav:function(i){t.currentPage.empty();for(var a=1;a<=i.pages;a++)e(document.createElement("option")).val(a).text(a).appendTo(t.currentPage);this.checkNav()},handleDataRequest:function(i){var a=this;t.dataBody.empty(),e.each(i,(function(e,i){var a=t.rowClone.clone().children();a.eq(0).children().val(i.id),a.eq(1).find("strong").text(i.name),a.eq(1).find(".inline_editUsername").val(i.name),a.eq(2).find(".wpProQuiz_email").text(i.email),a.eq(2).find("input").val(i.email),a.eq(3).text(i.type),a.eq(4).text(i.date),a.eq(5).text(i.points),a.eq(6).text(i.result),a.parent().show().appendTo(t.dataBody)})),i.length||e(document.createElement("td")).attr("colspan","7").text(wpProQuizLocalize.no_data_available).css({"font-weight":"bold","text-align":"center",padding:"5px"}).appendTo(document.createElement("tr")).appendTo(t.dataBody),e(".wpProQuiz_delete").on("click",(function(){if(confirm(wpProQuizLocalize.confirm_delete_entry)){var t=new Array(e(this).closest("tr").find('input[name="checkedData[]"]').val());a.loadData({a:"delete",toplistIds:t})}return!1})),e(".wpProQuiz_edit").on("click",(function(){var t=e(this).closest("tr");return t.find(".row-actions").hide(),t.find(".inline-edit").show(),t.find(".wpProQuiz_username, .wpProQuiz_email").hide(),t.find(".inline_editUsername, .inline_editEmail").show(),!1})),e(".inline_editSave").on("click",(function(){var t=e(this).closest("tr"),i=t.find(".inline_editUsername").val(),n=t.find(".inline_editEmail").val();return a.isEmpty(i)||a.isEmpty(n)?(alert(wpProQuizLocalize.not_all_fields_completed),!1):(a.loadData({a:"edit",toplistId:t.find('input[name="checkedData[]"]').val(),name:i,email:n}),!1)})),e(".inline_editCancel").on("click",(function(){var t=e(this).closest("tr");return t.find(".row-actions").show(),t.find(".inline-edit").hide(),t.find(".wpProQuiz_username, .wpProQuiz_email").show(),t.find(".inline_editUsername, .inline_editEmail").hide(),t.find(".inline_editUsername").val(t.find(".wpProQuiz_username").text()),t.find(".inline_editEmail").val(t.find(".wpProQuiz_email").text()),!1}))},checkNav:function(){var e=t.currentPage.val();1==e?t.pageLeft.hide():t.pageLeft.show(),e==t.currentPage.children().length?t.pageRight.hide():t.pageRight.show()},isEmpty:function(t){return!(t=e.trim(t))||0===t.length}};t.sort.on("change",(function(){i.loadData()})),t.pageLimit.on("change",(function(){i.loadData({nav:1})})),t.currentPage.on("change",(function(){i.checkNav(),i.loadData()})),t.pageLeft.on("click",(function(){t.currentPage.val(Number(t.currentPage.val())-1),i.checkNav(),i.loadData()})),t.pageRight.on("click",(function(){t.currentPage.val(Number(t.currentPage.val())+1),i.checkNav(),i.loadData()})),e("#wpProQuiz_deleteAll").on("click",(function(){i.loadData({a:"deleteAll"})})),e("#wpProQuiz_action").on("click",(function(){var t=e("#wpProQuiz_actionName").val();if("0"!=t){var a=e('input[name="checkedData[]"]:checked').map((function(){return e(this).val()})).get();i.loadData({a:t,toplistIds:a})}})),e("#wpProQuiz_checkedAll").on("change",(function(){this.checked?e('input[name="checkedData[]"]').attr("checked","checked"):e('input[name="checkedData[]"]').removeAttr("checked","checked")})),i.loadData({nav:1})},e(".wpProQuiz_quizOverall").length&&e(".wpProQuiz_quizOverall").wpProQuiz_preview(),e(".wpProQuiz_quizOverall").length&&e(".wpProQuiz_quizOverall").wpProQuiz_quizOverall(),e(".wpProQuiz_quizEdit").length&&e(".wpProQuiz_quizEdit").wpProQuiz_quizEdit(),e(".wpProQuiz_questionOverall").length&&e(".wpProQuiz_questionOverall").wpProQuiz_questionOverall(),e(".wpProQuiz_toplist").length&&e(".wpProQuiz_toplist").wpProQuiz_toplist(),function(){var i=this;function a(t){""!=t&&(e(t).css("float","none"),e(t).css("visibility","visible"),e(t).show())}function n(t){""!=t&&(e(t).hide(),e(t).css("visibility","hidden"))}function o(t){""!=t&&e(t).show().fadeOut(1500)}i={displayChecked:function(e,t,i,a){var n=i?!e.checked:e.checked;a?n?t.attr("disabled","disabled"):t.removeAttr("disabled"):n?t.show():t.hide()},isEmpty:function(t){return!(t=e.trim(t))||0===t.length},isNumber:function(t){return t=e.trim(t),!i.isEmpty(t)&&!isNaN(t)},getMceContent:function(t){if("undefined"==typeof tinymce||null==typeof tinymce||void 0===tinymce.editors)return e("#"+t).val();var i=tinymce.editors[t];return null==i||i.isHidden()?e("#"+t).val():i.getContent()},ajaxPost:function(t,i,a){var n={action:"wp_pro_quiz_admin_ajax",nonce:jQuery("#wpProQuiz_nonce").data("nonce"),func:t,data:i};e.post(ajaxurl,n,a,"json")}};var r=function(){var t=function(t){var r={categoryId:t};a(".categorySpinner"),i.ajaxPost("categoryDelete",r,(function(i){i.err||(n(".categorySpinner"),o(".categoryDeleteUpdate"),e('select[name="category"] option[value="'+t+'"]').remove(),e('select[name="category"]').change())}))},r=function(t,r){var s={categoryId:t,categoryName:e.trim(r)};i.isEmpty(r)?alert(wpProQuizLocalize.category_no_name):(a(".categorySpinner"),i.ajaxPost("categoryEdit",s,(function(i){i.err||(n(".categorySpinner"),o(".categoryEditUpdate"),e('select[name="category"] option[value="'+t+'"]').text(s.categoryName),e('select[name="category"]').val(""),e('select[name="category"]').change())})))},s=function(t,i){"0"!=i.val()&&e('input[name="'+t+'"]').val(i.val())},c=function(t,r){var s={templateId:t,type:r};a(r?".templateQuestionSpinner":".templateQuizSpinner"),i.ajaxPost("templateDelete",s,(function(i){i.err||(r?(n(".templateQuestionSpinner"),o(".templateQuestionDeleteUpdate"),e('select[name="templateQuestion"] option[value="'+t+'"]').remove(),e('select[name="templateQuestion"]').val(""),e('select[name="templateQuestion"]').change()):(n(".templateQuizSpinner"),o(".templateQuizDeleteUpdate"),e('select[name="templateQuiz"] option[value="'+t+'"]').remove(),e('select[name="templateQuiz"]').val(""),e('select[name="templateQuiz"]').change()))}))},u=function(t,r,s){if(i.isEmpty(r))alert(wpProQuizLocalize.category_no_name);else{var c={templateId:t,name:e.trim(r),type:s};a(s?".templateQuestionSpinner":".templateQuizSpinner"),i.ajaxPost("templateEdit",c,(function(i){i.err||(s?(n(".templateQuestionSpinner"),o(".templateQuestionEditUpdate"),e('select[name="templateQuestion"] option[value="'+t+'"]').text(c.name),e('select[name="templateQuestion"]').val(""),e('select[name="templateQuestion"]').change()):(n(".templateQuizSpinner"),o(".templateQuizEditUpdate"),e('select[name="templateQuiz"] option[value="'+t+'"]').text(c.name),e('select[name="templateQuiz"]').val(""),e('select[name="templateQuiz"]').change()))}))}};e('select[name="category"]').on("change",(function(){""!=e(this).val()?e('input[name="categoryEditText"]').val(e("option:selected",this).text()):e('input[name="categoryEditText"]').val("")})),e('input[name="categoryDelete"]').on("click",(function(){var i=e('select[name="category"] option:selected').val();""!=i&&t(i)})),e('input[name="categoryEdit"]').on("click",(function(){var t=e('select[name="category"] option:selected').val();if(""!=t){var i=e('input[name="categoryEditText"]').val();r(t,i)}})),e('select[name="templateQuiz"]').on("change",(function(){""!=e(this).val()?e('input[name="templateQuizEditText"]').val(e("option:selected",this).text()):e('input[name="templateQuizEditText"]').val("")})),e('input[name="templateQuizEdit"]').on("click",(function(){var t=e('select[name="templateQuiz"] option:selected').val();if(""!=t){var i=e('input[name="templateQuizEditText"]').val();u(t,i,0)}})),e('input[name="templateQuizDelete"]').on("click",(function(){var t=e('select[name="templateQuiz"] option:selected').val();""!=t&&c(t,0)})),e('select[name="templateQuestion"]').on("change",(function(){""!=e(this).val()?e('input[name="templateQuestionEditText"]').val(e("option:selected",this).text()):e('input[name="templateQuestionEditText"]').val("")})),e('input[name="templateQuestionEdit"]').on("click",(function(){var t=e('select[name="templateQuestion"] option:selected').val();if(""!=t){var i=e('input[name="templateQuestionEditText"]').val();u(t,i,1)}})),e('input[name="templateQuestionDelete"]').on("click",(function(){var t=e('select[name="templateQuestion"] option:selected').val();""!=t&&c(t,1)})),e("#statistic_time_format_select").on("change",(function(){s("statisticTimeFormat",e(this))})),e(document).bind("changeTab",(function(t){e("#problemInfo").hide("fast"),"#problemContent"===t.tabId&&e("#problemInfo").show("fast")}))},s=function(){var t,a=e.noop(),n={answerChildren:e(".answer_felder > div"),pointsModus:e('input[name="answerPointsActivated"]'),gPoints:e('input[name="points"]')};t={generateArrayIndex:function(){var t=e('input[name="answerType"]:checked').val();t="single"==t||"multiple"==t?"classic_answer":t,e(".answerList").each((function(){var i=e(this).parent().attr("class");e(this).children().each((function(a,n){e(this).find('[name^="answerData"]').each((function(){var e=this.name,n=e.search(/\](\[\w+\])+$/),o=t==i?a:"none";n>0&&(this.name="answerData["+o+e.substring(n,e.length))}))}))}))},globalValidate:function(){if("undefined"!==typenow&&"sfwd-question"==typenow){if(i.isEmpty(i.getMceContent("content")))return alert(wpProQuizLocalize.no_question_msg),!1}else if(i.isEmpty(i.getMceContent("question")))return alert(wpProQuizLocalize.no_question_msg),!1;if(!n.pointsModus.is(":checked")){var e=n.gPoints.val();if(!i.isNumber(e)||e<1)return alert(wpProQuizLocalize.no_nummber_points),!1}return!1!==a()},answerRemove:function(){var t=e(this).parent();return t.parent().children().length>1?t.remove():alert(wpProQuizLocalize.no_delete_answer),!1},addCategory:function(){var t=e.trim(e('input[name="categoryAdd"]').val()),a=jQuery("#wpProQuiz_nonce").data("nonce");if(!i.isEmpty(t)){var n={categoryName:t,nonce:a};i.ajaxPost("categoryAdd",n,(function(t){if(t.err)e("#categoryMsgBox").text(t.err).show("fast").delay(2e3).hide("fast");else{var i=e(document.createElement("option")).val(t.categoryId).text(t.categoryName).attr("selected","selected");e('select[name="category"]').append(i).change()}}))}},addMediaClick:function(){var t,i=e(this).closest("li"),a=i.find('input[name="answerData[][html]"]:eq(0)'),n=i.find(".wpProQuiz_text:eq(0)");void 0===t?((t=wp.media.frames.media_upload_frame=wp.media({frame:"select",library:{type:["image","audio","video"]},multiple:!1})).on("select",(function(){var e=t.state().get("selection").first().toJSON();"image"===e.type&&(n.val(n.val()+'<img src="'+e.url+'" alt="'+e.alt+'" />'),a.attr("checked",!0)),"audio"===e.type&&(n.val(n.val()+'[audio src="'+e.url+'"][/audio]'),a.attr("checked",!0)),"video"===e.type&&(n.val(n.val()+'[video src="'+e.url+'"][/video]'),a.attr("checked",!0))})),t.open()):t.open()}};var o={classic_answer:function(){var t=0,a=0,o=0;return e(".classic_answer .answerList").children().each((function(){var n=e(this);if(!i.isEmpty(n.find("textarea.wpProQuiz_single_text").val())){t++,n.find("input.wpProQuiz_classCorrect:checked").length&&a++;var r=n.find("input.wpProQuiz_points").val();i.isNumber(r)&&r>=0&&o++}})),t?a||e('input[name="disableCorrect"]').is(":checked")&&e('input[name="answerPointsDiffModusActivated"]').is(":checked")&&e('input[name="answerPointsActivated"]').is(":checked")&&("single"==e('input[name="answerType"]:checked').val()||"multiple"==e('input[name="answerType"]:checked').val())?o==t||!n.pointsModus.is(":checked")||(alert(wpProQuizLocalize.no_nummber_points_new),!1):(alert(wpProQuizLocalize.no_correct_msg),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},free_answer:function(){return!i.isEmpty(e(".free_answer textarea.wpProQuiz_free_text").val())||(alert(wpProQuizLocalize.no_answer_msg),!1)},cloze_answer:function(){return!i.isEmpty(i.getMceContent("cloze"))||(alert(wpProQuizLocalize.no_answer_msg),!1)},sort_answer:function(){var t=0,a=0;return e(".sort_answer .answerList").children().each((function(){var n=e(this);if(!i.isEmpty(n.find("textarea.wpProQuiz_sort_answer").val())){t++;var o=n.find("input.wpProQuiz_points").val();i.isNumber(o)&&o>=0&&a++}})),t?a==t||!n.pointsModus.is(":checked")||(alert(wpProQuizLocalize.no_nummber_points_new),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},matrix_sort_answer:function(){var t=0,a=0,o=!0,r=0;return e(".matrix_sort_answer .answerList").children().each((function(){var n=e(this),s=n.find("input.wpProQuiz_points").val();i.isEmpty(n.find("textarea.wpProQuiz_matrix_answer").val())?i.isEmpty(n.find("textareawpProQuiz_matrix_sort_string").val())||(r++,i.isNumber(s)&&s>=0&&a++):(t++,r++,i.isEmpty(n.find("textarea.wpProQuiz_matrix_sort_string").val())&&(o=!1),i.isNumber(s)&&s>=0&&a++)})),t?o?a==r||!n.pointsModus.is(":checked")||(alert(wpProQuizLocalize.no_nummber_points_new),!1):(alert(wpProQuizLocalize.no_sort_element_criterion),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},assessment_answer:function(){return!i.isEmpty(i.getMceContent("assessment"))||(alert(wpProQuizLocalize.no_answer_msg),!1)}};n.answerChildren.hide(),e("#wpProQuiz_tip").on("change",(function(){i.displayChecked(this,e("#wpProQuiz_tipBox"))})).change(),e("#wpProQuiz_correctSameText").on("change",(function(){i.displayChecked(this,e("#wpProQuiz_incorrectMassageBox"),!0),i.displayChecked(this,e("#learndash_question_message_incorrect_answer"),!0)})),e('input[name="answerType"]').on("click",(function(){n.answerChildren.hide();var t=this.value,i=!1;if(1==e('input[name="answerPointsActivated"]').is(":checked")&&(i=!0),"single"==t?("undefined"!==typenow&&"sfwd-question"==typenow?e("#learndash_question_single_choice_options").show():e("#singleChoiceOptions").show(),e('input[name="disableCorrect"]').change()):("undefined"!==typenow&&"sfwd-question"==typenow?e("#learndash_question_single_choice_options").hide():e("#singleChoiceOptions").hide(),e(".classic_answer .wpProQuiz_classCorrect").parent().parent().show()),"single"==t||"multiple"==t){var r="single"==t?"radio":"checkbox";t="classic_answer",e('input[name="points"]').attr("disabled",i),e("#wpProQuiz_answerPointsActivated").show(),e('input[name="answerPointsActivated"]').attr("disabled",!1),e('input[name="correctSameText"]').attr("disabled",!1),e(".wpProQuiz_classCorrect").each((function(){e("<input type="+r+" />").attr({name:this.name,value:this.value,checked:this.checked}).addClass("wpProQuiz_classCorrect wpProQuiz_checkbox").insertBefore(this)})).remove()}else"free_answer"==t||"sort_answer"==t||"matrix_sort_answer"==t||"cloze_answer"==t?(e('input[name="points"]').attr("disabled",i),e("#wpProQuiz_answerPointsActivated").show(),e('input[name="answerPointsActivated"]').attr("disabled",!1),e('input[name="correctSameText"]').attr("disabled",!1)):"assessment_answer"==t?(e('input[name="points"]').attr("disabled",i),e("#wpProQuiz_answerPointsActivated").show(),e('input[name="answerPointsActivated"]').attr("checked",!0),e('input[name="answerPointsActivated"]').attr("disabled",!0),e('input[name="correctSameText"]').attr("checked",!0),e('input[name="correctSameText"]').attr("disabled",!0),e("#learndash_question_message_incorrect_answer").hide()):"essay"==t?(e('input[name="answerPointsActivated"]').attr("checked",!1),e('input[name="showPointsInBox"]').attr("checked",!1),e('input[name="points"]').attr("disabled",!1),e("#wpProQuiz_answerPointsActivated").show(),e('input[name="answerPointsActivated"]').attr("checked",!1),e('input[name="answerPointsActivated"]').attr("disabled",!0),e('input[name="correctSameText"]').attr("checked",!0),e("#learndash_question_message_correct_answer .postbox-header h2").html(wpProQuizLocalize.metabox_title_correct_message_essay),e("#learndash_question_message_correct_answer .inside .learndash-same-answer-text").hide(),e("#learndash_question_message_correct_answer .inside p.description").hide(),e("#wpProQuiz_incorrectMassageBox").hide(),e("#learndash_question_message_incorrect_answer").hide(),e('textarea[name="incorrectMsg"]').val("")):(e("#wpProQuiz_answerPointsActivated").show(),e("#wpProQuiz_correctMessageBox").show(),e("#learndash_question_message_correct_answer").show(),e("#learndash_question_message_correct_answer .postbox-header h2").html(wpProQuizLocalize.metabox_title_correct_message),e("#learndash_question_message_correct_answer .inside .learndash-same-answer-text").show(),e("#learndash_question_message_correct_answer .inside p.description").show(),e("#wpProQuiz_incorrectMassageBox").show(),e("#learndash_question_message_incorrect_answer").show());a=null!=o[t]?o[t]:e.noop(),e("."+t).show()})),setTimeout((()=>{e('input[name="answerType"]:checked').click()}),500),e("#wpProQuiz_correctSameText").change(),e(".deleteAnswer").on("click",t.answerRemove),e(".addAnswer").on("click",(function(){var i=e(this).attr("data-default-value");null==i&&(i=0);var a=e(this).siblings("ul"),n=a.find("li:eq(0)").clone();return n.find(".wpProQuiz_checkbox").removeAttr("checked"),n.find(".wpProQuiz_text").val(""),n.find(".wpProQuiz_points").val(i),n.find(".deleteAnswer").on("click",t.answerRemove),n.find(".addMedia").on("click",t.addMediaClick),n.appendTo(a),!1})),e(".sort_answer ul, .classic_answer ul, .matrix_sort_answer ul").sortable({handle:".wpProQuiz_move"}),e("#saveQuestion").on("click",(function(){return!!t.globalValidate()&&(t.generateArrayIndex(),!0)})),e("#publish").on("click",(function(){return!!t.globalValidate()&&(t.generateArrayIndex(),!0)})),e("#save-post").on("click",(function(){return!!t.globalValidate()&&(t.generateArrayIndex(),!0)})),e(n.pointsModus).on("change",(function(){i.displayChecked(this,e(".wpProQuiz_answerPoints")),i.displayChecked(this,n.gPoints,!1,!0),i.displayChecked(this,e('input[name="answerPointsDiffModusActivated"]'),!0,!0),this.checked?(e('input[name="answerPointsDiffModusActivated"]').change(),e('input[name="disableCorrect"]').change(),e('input[name="showPointsInBox"]').attr("disabled",!1)):(e(".classic_answer .wpProQuiz_classCorrect").parent().parent().show(),e('input[name="disableCorrect"]').attr("disabled","disabled"),e('input[name="showPointsInBox"]').attr("disabled",!0))})).change(),e('select[name="category"]').on("change",(function(){var t=e(this),i=e("#categoryAddBox").hide();"-1"==t.val()&&i.show()})).change(),e("#categoryAddBtn").on("click",(function(){t.addCategory()})),e(".addMedia").on("click",t.addMediaClick),e('input[name="answerPointsDiffModusActivated"]').on("change",(function(){i.displayChecked(this,e('input[name="disableCorrect"]'),!0,!0),this.checked?e('input[name="disableCorrect"]').change():e(".classic_answer .wpProQuiz_classCorrect").parent().parent().show()})).change(),e('input[name="disableCorrect"]').on("change",(function(){i.displayChecked(this,e(".classic_answer .wpProQuiz_classCorrect").parent().parent(),!0)})).change(),e("#clickPointDia").on("click",(function(){return e(".pointDia").toggle("fast"),!1})),e('input[name="template"]').on("click",(function(a){if("0"==e('select[name="templateSaveList"]').val()&&i.isEmpty(e('input[name="templateName"]').val()))return alert(wpProQuizLocalize.temploate_no_name),a.preventDefault(),!1;t.generateArrayIndex()})),e('select[name="templateSaveList"]').on("change",(function(){var t=e('input[name="templateName"]');"0"==e(this).val()?t.show():t.hide()})).change()},c=function(){var t=this,a=e("#quizId").val(),n="users",o={currentPage:e("#wpProQuiz_currentPage"),pageLeft:e("#wpProQuiz_pageLeft"),pageRight:e("#wpProQuiz_pageRight"),testSelect:e("#testSelect")};t={loadStatistic:function(e,t){var a={userId:e};i.ajaxPost("statisticLoad",a,(function(e){}))},loadUsersStatistic:function(){var n={userId:e("#userSelect").val(),quizId:a,testId:e("#testSelect").val()};t.toggleLoadBox(!1),i.ajaxPost("statisticLoad",n,(function(i){e.each(i.question,(function(){var i=e("#wpProQuiz_tr_"+this.questionId);t.setStatisticData(i,this)})),e.each(i.category,(function(i,a){var n=e("#wpProQuiz_ctr_"+i);t.setStatisticData(n,a)})),e("#testSelect option:gt(0)").remove();var a=e("#testSelect");e.each(i.tests,(function(){var t=e(document.createElement("option"));t.val(this.id),t.text(this.date),i.testId==this.id&&t.attr("selected",!0),a.append(t)})),t.parseFormData(i.formData),t.toggleLoadBox(!0)}))},loadUsersStatistic_:function(n,o){var r={userId:n,quizId:a,testId:o};t.toggleLoadBox(!1),i.ajaxPost("statisticLoad",r,(function(i){e.each(i.question,(function(){var i=e("#wpProQuiz_tr_"+this.questionId);t.setStatisticData(i,this)})),e.each(i.category,(function(i,a){var n=e("#wpProQuiz_ctr_"+i);t.setStatisticData(n,a)})),e("#testSelect option:gt(0)").remove();var a=e("#testSelect");e.each(i.tests,(function(){var t=e(document.createElement("option"));t.val(this.id),t.text(this.date),i.testId==this.id&&t.attr("selected",!0),a.append(t)})),t.parseFormData(i.formData),e("#userSelect").val(n),e("#testSelect").val(o),t.toggleLoadBox(!0)}))},parseFormData:function(t){var i=e("#wpProQuiz_form_box");null!=t?(e.each(t,(function(t,i){e("#form_id_"+t).text(i)})),i.show()):i.hide()},setStatisticData:function(e,t){e.find(".wpProQuiz_cCorrect").text(t.correct),e.find(".wpProQuiz_cIncorrect").text(t.incorrect),e.find(".wpProQuiz_cTip").text(t.hint),e.find(".wpProQuiz_cPoints").text(t.points),e.find(".wpProQuiz_cResult").text(t.result),e.find(".wpProQuiz_cTime").text(t.questionTime),e.find(".wpProQuiz_cCreateTime").text(t.date)},toggleLoadBox:function(t){var i=e("#wpProQuiz_loadData"),a=e("#wpProQuiz_content");t?(i.hide(),a.show()):(a.hide(),i.show())},reset:function(n){var r=e("#userSelect").val();if(confirm(wpProQuizLocalize.reset_statistics_msg)){var s={quizId:a,userId:r,testId:o.testSelect.val(),type:n};t.toggleLoadBox(!1),i.ajaxPost("statisticReset",s,(function(){t.loadUsersStatistic()}))}},loadStatisticOverview:function(n){var r={quizId:a,pageLimit:e("#wpProQuiz_pageLimit").val(),onlyCompleted:Number(e("#wpProQuiz_onlyCompleted").is(":checked")),page:o.currentPage.val(),nav:Number(n)};t.toggleLoadBox(!1),i.ajaxPost("statisticLoadOverview",r,(function(i){var a=e("#wpProQuiz_statistics_overview_data"),n=a.children(),o=n.first().clone();n.slice(1).remove(),e.each(i.items,(function(){var i=o.clone();t.setStatisticData(i,this),i.find("a").text(this.userName).data("userId",this.userId).on("click",(function(){return e("#userSelect").val(e(this).data("userId")),e("#wpProQuiz_typeUser").click(),!1})),i.show().appendTo(a)})),o.remove(),t.toggleLoadBox(!0),null!=i.page&&t.handleNav(i.page)}))},handleNav:function(i){for(var a=e("#wpProQuiz_currentPage").empty(),n=1;n<=i;n++)e(document.createElement("option")).val(n).text(n).appendTo(a);t.checkNavBar()},checkNavBar:function(){var e=o.currentPage.val();1==e?o.pageLeft.hide():o.pageLeft.show(),e==o.currentPage.children().length?o.pageRight.hide():o.pageRight.show()},refresh:function(){"users"==n?t.loadUsersStatistic():"formOverview"==n?t.loadFormsOverview(!0):t.loadStatisticOverview(!0)},loadFormsOverview:function(n){var o={quizId:a,pageLimit:e("#wpProQuiz_fromPageLimit").val(),onlyUser:e("#wpProQuiz_formUser").val(),page:e("#wpProQuiz_formCurrentPage").val(),nav:Number(n)};t.toggleLoadBox(!1),i.ajaxPost("statisticLoadFormOverview",o,(function(i){var a=e("#wpProQuiz_statistics_form_data"),n=a.children(),o=n.first().clone();n.slice(1).remove(),e.each(i.items,(function(){var i=o.clone();t.setStatisticData(i,this),i.find("a").text(this.userName).data("userId",this.userId).data("testId",this.testId).on("click",(function(){return t.switchTabOnLoad("users"),t.loadUsersStatistic_(e(this).data("userId"),e(this).data("testId")),!1})),i.show().appendTo(a)})),o.remove(),t.toggleLoadBox(!0),null!=i.page&&t.handleFormNav(i.page)}))},handleFormNav:function(i){for(var a=e("#wpProQuiz_formCurrentPage").empty(),n=1;n<=i;n++)e(document.createElement("option")).val(n).text(n).appendTo(a);t.checkFormNavBar()},checkFormNavBar:function(){var t=e("#wpProQuiz_formCurrentPage").val();1==t?e("#wpProQuiz_formPageLeft").hide():e("#wpProQuiz_formPageLeft").show(),t==e("#wpProQuiz_formCurrentPage").children().length?e("#wpProQuiz_formPageRight").hide():e("#wpProQuiz_formPageRight").show()},switchTabOnLoad:function(t){e(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary"),e(".wpProQuiz_tabContent").hide();var i=e("#wpProQuiz_typeOverview");"users"==t?(n="users",e("#wpProQuiz_tabUsers").show(),i=e("#wpProQuiz_typeUser")):"formOverview"==t?(n="formOverview",e("#wpProQuiz_tabFormOverview").show(),i=e("#wpProQuiz_typeForm")):(n="overview",e("#wpProQuiz_tabOverview").show()),i.removeClass("button-secondary").addClass("button-primary")}};e("#userSelect, #testSelect").on("change",(function(){t.loadUsersStatistic()})),e(".wpProQuiz_update").on("click",(function(){t.refresh()})),e("#wpProQuiz_reset").on("click",(function(){t.reset(0)})),e("#wpProQuiz_resetUser").on("click",(function(){t.reset(1)})),e(".wpProQuiz_resetComplete").on("click",(function(){t.reset(2)})),e(".wpProQuiz_tab").on("click",(function(){var i=e(this);return e(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary"),i.removeClass("button-secondary").addClass("button-primary"),e(".wpProQuiz_tabContent").hide(),"wpProQuiz_typeUser"==i.attr("id")?(n="users",e("#wpProQuiz_tabUsers").show(),t.loadUsersStatistic()):"wpProQuiz_typeForm"==i.attr("id")?(n="formOverview",e("#wpProQuiz_tabFormOverview").show(),t.loadFormsOverview(!0)):(n="overview",e("#wpProQuiz_tabOverview").show(),t.loadStatisticOverview(!0)),!1})),e("#wpProQuiz_onlyCompleted").on("change",(function(){o.currentPage.val(1),t.loadStatisticOverview(!0)})),e("#wpProQuiz_pageLimit").on("change",(function(){o.currentPage.val(1),t.loadStatisticOverview(!0)})),o.pageLeft.on("click",(function(){o.currentPage.val(Number(o.currentPage.val())-1),t.loadStatisticOverview(!1),t.checkNavBar()})),o.pageRight.on("click",(function(){o.currentPage.val(Number(o.currentPage.val())+1),t.loadStatisticOverview(!1),t.checkNavBar()})),o.currentPage.on("change",(function(){t.loadStatisticOverview(!1),t.checkNavBar()})),e("#wpProQuiz_formUser, #wpProQuiz_fromPageLimit").on("change",(function(){e("#wpProQuiz_formCurrentPage").val(1),t.loadFormsOverview(!0)})),e("#wpProQuiz_formPageLeft").on("click",(function(){e("#wpProQuiz_formCurrentPage").val(Number(o.currentPage.val())-1),t.loadFormsOverview(!1),t.checkFormNavBar()})),e("#wpProQuiz_formPageRight").on("click",(function(){e("#wpProQuiz_formCurrentPage").val(Number(o.currentPage.val())+1),t.loadFormsOverview(!1),t.checkFormNavBar()})),e("#wpProQuiz_formCurrentPage").on("change",(function(){t.loadFormsOverview(!1),t.checkFormNavBar()})),t.loadUsersStatistic()},u=function(){var a=e("#quizId").val(),n=e("#quiz").val(),o=null,r=null,s={data:{quizId:a,quiz:n,users:-1,pageLimit:100,dateFrom:0,dateTo:0,generateNav:0},changeFilter:function(){var t=function(e){var t=e.datepicker("getDate");return null===t?0:t.getTime()/1e3},i=e("#wpProQuiz_historyUser").val();return void 0!==i&&""!==i&&null!==i||(i="-1"),e.extend(this.data,{users:i,pageLimit:e("#wpProQuiz_historyPageLimit").val(),dateFrom:t(e("#datepickerFrom")),dateTo:t(e("#datepickerTo")),generateNav:1}),this.data}},c={data:{pageLimit:100,onlyCompleted:0,generateNav:0,quizId:a,quiz:n},changeFilter:function(){e.extend(this.data,{pageLimit:e("#wpProQuiz_overviewPageLimit").val(),onlyCompleted:Number(e("#wpProQuiz_overviewOnlyCompleted").is(":checked")),generateNav:1})}},u=function(t,n){if(!confirm(wpProQuizLocalize.reset_statistics_msg))return!1;var o={refId:t,userId:n,quizId:a,type:0};i.ajaxPost("statisticResetNew",o,(function(){e("#wpProQuiz_user_overlay").hide(),s.changeFilter(),p.loadHistoryAjax(),c.changeFilter(),p.loadOverviewAjax()}))},l=function(){if(!confirm(wpProQuizLocalize.reset_statistics_msg))return!1;var e={quizId:a,type:1};i.ajaxPost("statisticResetNew",e,(function(){s.changeFilter(),p.loadHistoryAjax(),c.changeFilter(),p.loadOverviewAjax()}))},p={loadHistoryAjax:function(){var t=e.extend({page:s.data.generateNav?1:o.getCurrentPage()},s.data);p.loadBox(!0);var a=e("#wpProQuiz_historyLoadContext").hide();i.ajaxPost("statisticLoadHistory",t,(function(t){a.html(t.html).show(),t.navi&&o.setNumPage(t.navi),s.data.generateNav=0,a.find(".user_statistic").on("click",(function(){return p.loadUserAjax(0,e(this).data("ref_id"),!1),!1})),a.find(".wpProQuiz_delete").on("click",(function(){return u(e(this).parents("tr").find(".user_statistic").data("ref_id"),0),!1})),p.loadBox(!1)}))},loadUserAjax:function(t,n,o){e("#wpProQuiz_user_overlay, #wpProQuiz_loadUserData").show();var r=e("#wpProQuiz_user_content").hide(),s={quizId:a,userId:t,refId:n,avg:Number(o)};i.ajaxPost("statisticLoadUser",s,(function(i){r.html(i.html),r.find(".wpProQuiz_update").on("click",(function(){return p.loadUserAjax(t,n,o),!1})),r.find("#wpProQuiz_resetUserStatistic").on("click",(function(){u(n,t)})),r.find(".statistic_data").on("click",(function(){return e(this).parents("tr").next().toggle("fast"),!1})),e("#wpProQuiz_loadUserData").hide(),jQuery("body").trigger("learndash-statistics-contentchanged"),r.show()}))},loadBox:function(t,i){t?e("#wpProQuiz_loadDataHistory").show():e("#wpProQuiz_loadDataHistory").hide()},loadOverviewAjax:function(){var t=e.extend({page:c.data.generateNav?1:r.getCurrentPage()},c.data);e("#wpProQuiz_loadDataOverview").show();var a=e("#wpProQuiz_overviewLoadContext").hide();i.ajaxPost("statisticLoadOverviewNew",t,(function(t){a.html(t.html).show(),t.navi&&r.setNumPage(t.navi),c.data.generateNav=0,a.find(".user_statistic").on("click",(function(){return p.loadUserAjax(e(this).data("user_id"),0,!0),!1})),a.find(".wpProQuiz_delete").on("click",(function(){return u(0,e(this).parents("tr").find(".user_statistic").data("user_id")),!1})),e("#wpProQuiz_loadDataOverview").hide()}))},usersSelect2Ajax:function(t){var i=jQuery(t).data("nonce");return void 0===i||""===i?null:(jQuery(t).on("select2:unselect",(function(e){jQuery(t).trigger("change")})),{url:learndash_admin_settings_data.ajaxurl,dataType:"json",method:"post",delay:1500,cache:!0,data:function(t){return{action:"learndash_quiz_statistics_users_select2",nonce:i||"",search:t.term||"",page:t.page||1,quiz_pro_id:e("input#quizId").val(),quiz_post_id:e("input#quiz").val()}},processResults:function(e,t){return t.page=t.page||1,{results:e.items,pagination:{more:t.page<e.total_pages}}}})}};o=new t(e("#historyNavigation"),{onChange:function(){p.loadHistoryAjax()}}),r=new t(e("#overviewNavigation"),{onChange:function(){p.loadOverviewAjax()}}),wpProQuizLocalize.select2_enabled&&jQuery('#wpProQuiz_tabHistory select#wpProQuiz_historyUser[data-ld-select2="1"]').length&&jQuery('#wpProQuiz_tabHistory select#wpProQuiz_historyUser[data-ld-select2="1"]').each((function(e,t){var i=learndash_get_base_select2_args();i.width="auto";var a=jQuery(t).attr("placeholder");void 0!==a&&""!==a||(a=jQuery("option[value='']",t).text()),void 0!==a&&""!==a||(a="Select an option"),i.placeholder=a,wpProQuizLocalize.select2_fetch_enabled&&(i.ajax=p.usersSelect2Ajax(t)),jQuery(t).select2(i)})),(e("#datepickerFrom").length||e("#datepickerTo").length)&&(e(document).on("DOMNodeInserted",(function(t){"ui-datepicker-div"==t.target.id&&e("#ui-datepicker-div").addClass("learndash-datepicker")})),e("#datepickerFrom").datepicker({closeText:wpProQuizLocalize.closeText,currentText:wpProQuizLocalize.currentText,monthNames:wpProQuizLocalize.monthNames,monthNamesShort:wpProQuizLocalize.monthNamesShort,dayNames:wpProQuizLocalize.dayNames,dayNamesShort:wpProQuizLocalize.dayNamesShort,dayNamesMin:wpProQuizLocalize.dayNamesMin,dateFormat:wpProQuizLocalize.dateFormat,firstDay:wpProQuizLocalize.firstDay,changeMonth:!0,onClose:function(t){e("#datepickerTo").datepicker("option","minDate",t)}}),e("#datepickerTo").datepicker({closeText:wpProQuizLocalize.closeText,currentText:wpProQuizLocalize.currentText,monthNames:wpProQuizLocalize.monthNames,monthNamesShort:wpProQuizLocalize.monthNamesShort,dayNames:wpProQuizLocalize.dayNames,dayNamesShort:wpProQuizLocalize.dayNamesShort,dayNamesMin:wpProQuizLocalize.dayNamesMin,dateFormat:wpProQuizLocalize.dateFormat,firstDay:wpProQuizLocalize.firstDay,changeMonth:!0,onClose:function(t){e("#datepickerFrom").datepicker("option","maxDate",t)}})),e("#filter").on("click",(function(){s.changeFilter(),p.loadHistoryAjax()})),e("#wpProQuiz_overlay_close").on("click",(function(){e("#wpProQuiz_user_overlay").hide()})),e("#wpProQuiz_tabHistory .wpProQuiz_update").on("click",(function(){return s.changeFilter(),p.loadHistoryAjax(),!1})),e("#wpProQuiz_tabOverview .wpProQuiz_update").on("click",(function(){return c.changeFilter(),p.loadOverviewAjax(),!1})),e(".wpProQuiz_resetComplete").on("click",(function(){return l(),!1})),e("#overviewFilter").on("click",(function(){c.changeFilter(),p.loadOverviewAjax()})),s.changeFilter(),p.loadHistoryAjax(),c.changeFilter(),p.loadOverviewAjax()};!function(){e(".wpProQuiz_tab_wrapper a").on("click",(function(){var t=e(this),i=t.data("tab"),a=t.siblings(".button-primary").removeClass("button-primary").addClass("button-secondary");return t.removeClass("button-secondary").addClass("button-primary"),e(a.data("tab")).hide("fast"),e(i).show("fast"),e(document).trigger({type:"changeTab",tabId:i}),!1}));var t=e.noop;e(".wpProQuiz_questionEdit").length||e("body.learndash-post-type.sfwd-question").length?t=s:e(".wpProQuiz_globalSettings").length?t=r:e(".wpProQuiz_statistics").length?t=c:e(".wpProQuiz_statisticsNew").length&&(t=u),t(),e(".wpProQuiz_demoImgBox a").mouseover((function(t){var i=e(this),a=e(document).width(),n=i.siblings().outerWidth(!0);if(t.pageX+n>a){var o=a-(t.pageX+n+30);e(this).next().css("left",o+"px")}e(this).next().show()})).mouseout((function(){e(this).next().hide()})).on("click",(function(){return!1}))}()}()}));