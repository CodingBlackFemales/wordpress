var WPForms=window.WPForms||{};WPForms.Admin=WPForms.Admin||{},WPForms.Admin.Builder=WPForms.Admin.Builder||{},WPForms.Admin.Builder.ContextMenu=WPForms.Admin.Builder.ContextMenu||function(e,d,o){const s={},l={selectors:{contextMenu:".wpforms-context-menu",contextMenuItem:".wpforms-context-menu-list-item",contextMenuSelectiveItem:".wpforms-context-menu-list-item-selective",contextMenuDivider:".wpforms-context-menu-list-divider",builder:"#wpforms-builder"},init(){o(l.ready)},ready(){l.setup(),l.events()},setup(){s.$document=o(e),s.$contextMenu=o(l.selectors.contextMenu),s.$contextMenuItem=o(l.selectors.contextMenuItem),s.$contextMenuSelectiveItem=o(l.selectors.contextMenuSelectiveItem),s.$contextMenuDivider=o(l.selectors.contextMenuDivider),s.$builder=o(l.selectors.builder)},events(){s.$document.on("contextmenu",function(e){const t=o(e.target).closest(".wpforms-field");o(e.target).closest(l.selectors.contextMenu).length||!t.length||e.ctrlKey||(e.preventDefault(),l.hideMenu(),setTimeout(function(){l.checkMenuItemsVisibility(t),l.checkDividerVisibility(),l.menuPositioning(e),l.menuItemClickAction(t),l.checkSelectiveMenuItemsState(t)},150))}),s.$document.on("click",l.hideMenuOnClick),s.$builder.on("wpformsFieldTabToggle",l.hideMenuOnClick)},menuItemClickAction(i){const n=i.data("field-id");s.$contextMenuItem.off("click").on("click",function(){const e=o(this);var t;e.hasClass("wpforms-context-menu-list-item-has-child")||((t={edit:()=>l.handleEditAction(i,n),duplicate:()=>l.handleDuplicateAction(i),delete:()=>l.handleDeleteAction(i),required:()=>l.handleRequiredAction(e,n),label:()=>l.handleLabelAction(e,n),"smart-logic":()=>l.handleSmartLogicAction(i,n),"field-size":()=>l.handleSizeAction(e,n)}[e.data("action")])&&t(),l.hideMenu())})},handleEditAction(e,t){e.trigger("click"),o(`#wpforms-field-option-basic-${t} .wpforms-field-option-group-toggle`).trigger("click")},handleDuplicateAction(e){e.find(".wpforms-field-duplicate").first().trigger("click")},handleDeleteAction(e){e.find(".wpforms-field-delete").first().trigger("click")},handleRequiredAction(e,t){o(`#wpforms-field-option-${t}-required`).trigger("click");t=l.checkRequiredState(t)?"active":"inactive";l.toggleItemText(e,t)},handleLabelAction(e,t){o(`#wpforms-field-option-${t}-label_hide`).trigger("click");t=l.checkLabelState(t)?"active":"inactive";l.toggleItemText(e,t)},handleSmartLogicAction(e,t){e.trigger("click"),o(`#wpforms-field-option-conditionals-${t} .wpforms-field-option-group-toggle`).trigger("click"),o(`#wpforms-field-option-${t} .wpforms-field-option-group-conditionals .education-modal`).trigger("click")},handleSizeAction(e,t){var i=e.data("value");o(`#wpforms-field-option-${t}-size`).val(i).trigger("change"),e.addClass("wpforms-context-menu-list-item-active").siblings().removeClass("wpforms-context-menu-list-item-active")},toggleItemText(e,t){var e=e.find(".wpforms-context-menu-list-item-text"),i=e.data("active-text"),n=e.data("inactive-text")||e.text();i&&(e.data("inactive-text",n),e.text("active"===t?i:n))},checkSelectiveMenuItemsState(e){const n=e.data("field-id");s.$contextMenuSelectiveItem.each(function(){var e=o(this),t=e.data("action");const i=e.data("value");(0,{required:()=>l.checkRequiredState(n),label:()=>l.checkLabelState(n),"field-size":()=>l.checkFieldSizeState(n,i)}[t])()?(e.addClass("wpforms-context-menu-list-item-active"),l.toggleItemText(e,"active")):(e.removeClass("wpforms-context-menu-list-item-active"),l.toggleItemText(e,"inactive"))})},checkRequiredState(e){return o(`#wpforms-field-option-${e}-required[type="checkbox"]`).is(":checked")},checkLabelState(e){return o(`#wpforms-field-option-${e}-label_hide[type="checkbox"]`).is(":checked")},checkFieldSizeState(e,t){return o(`#wpforms-field-option-${e}-size`).val()===t},menuPositioning(e){var t=s.$contextMenu.width(),i=s.$contextMenu.height(),n=d.innerWidth,o=d.innerHeight;s.$contextMenu.removeClass("wpforms-context-menu-selective-left");let l=e.pageY,c=e.pageX;e.pageY+i>o&&(l=o-i-15),e.pageX+t>n&&(c=n-t-15,s.$contextMenu.addClass("wpforms-context-menu-selective-left")),s.$contextMenu.css({top:l+"px",left:c+"px"}),s.$contextMenu.fadeIn(150)},checkMenuItemsVisibility(e){const t=e.data("field-id"),i={edit:()=>l.shouldHideEdit(e),duplicate:()=>l.shouldHideDuplicate(e),delete:()=>l.shouldHideDelete(e),required:()=>l.shouldHideRequired(t),label:()=>l.shouldHideLabel(t),"smart-logic":()=>l.shouldHideSmartLogic(t),"field-size":()=>l.shouldHideFieldSize(t,e)};s.$contextMenuItem.each(function(){var e=o(this),t=e.data("action");(0,i[t])()&&e.hide()})},shouldHideEdit(e){return e.hasClass("internal-information-not-editable")},shouldHideDuplicate(e){e=e.find(".wpforms-field-duplicate");return 0===e.length||"none"===e.css("display")},shouldHideDelete(e){e=e.find(".wpforms-field-delete");return 0===e.length||"none"===e.css("display")},shouldHideRequired(e){return 0===o(`#wpforms-field-option-${e}-required[type="checkbox"]`).length},shouldHideLabel(e){e=o(`#wpforms-field-option-${e}-label_hide[type="checkbox"]`);return 0===e.length||e.parents(".wpforms-field-option-row").hasClass("wpforms-disabled")},shouldHideFieldSize(e,t){t=0<t.closest(".wpforms-field-layout").length,e=o(`#wpforms-field-option-${e}-size`);return 0===e.length||t||e.parent().hasClass("wpforms-hidden")},shouldHideSmartLogic(e){return 0===o("#wpforms-field-option-conditionals-"+e).length&&0===o(`#wpforms-field-option-${e} .wpforms-field-option-group-conditionals .education-modal`).length},checkDividerVisibility(){s.$contextMenuDivider.each(function(){var e=o(this),t=e.data("visibility");let i=!0;t.split(",").forEach(function(e){"none"!==o('.wpforms-context-menu-list-item[data-action="'+e.trim()+'"]').css("display")&&(i=!1)}),i?e.hide():e.show()})},hideMenu(){s.$contextMenu.fadeOut(150),setTimeout(function(){s.$contextMenuItem.show()},150)},hideMenuOnClick(e){o(e.target).closest(l.selectors.contextMenu).length||l.hideMenu()}};return l}(document,window,jQuery),WPForms.Admin.Builder.ContextMenu.init();