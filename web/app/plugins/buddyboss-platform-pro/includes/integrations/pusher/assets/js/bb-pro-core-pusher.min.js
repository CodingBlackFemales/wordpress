window.bp=window.bp||{},window.Backbone=window.Backbone||[],function(g){bp.Pusher_FrontCommon={pusher:{},typer_data:{},xhr:!1,can_type:!0,throttleTime:6e3,clearInterval:6e3,clearTimerId:[],pendingRemoves:[],leaveWaitingTime:5e3,chunks_event:[],bb_pusher_channels:[],worker_enabled:!1,try_reconnect:!1,start:function(){"undefined"!=typeof bb_pusher_vars&&void 0!==bb_pusher_vars.loggedin_user_id&&0!==parseInt(bb_pusher_vars.loggedin_user_id)&&(this.setupGlobals(),this.addListeners(),g(document).on("ready",function(){bp.Pusher_FrontCommon.setupToast()}))},setupGlobals:function(){bp.Pusher_FrontCommon.typer_data=[],bb_pusher_vars.current_thread_recipients_count=0,bb_pusher_vars.current_thread_group_id=0,bp.Pusher_FrontCommon.pusher=this.pusherGlobalObject(),bp.Pusher_FrontCommon.pusher&&void 0!==bp.Pusher_FrontCommon.pusher.channels&&"on"===bb_pusher_vars.is_live_messaging_enabled&&(bp.Pusher_FrontCommon.pusher.signin(),bp.Pusher_FrontCommon.bb_pusher_channels.push("private-bb-pro-global"),bp.Pusher_FrontCommon.bb_pusher_channels.push("private-bb-user-"+bb_pusher_vars.loggedin_user_id),0<Object.keys(bb_pusher_vars.group_threads).length&&g.each(bb_pusher_vars.group_threads,function(e,r){bp.Pusher_FrontCommon.bb_pusher_channels.push("private-bb-message-thread-"+r)}),bp.Pusher_FrontCommon.pusherLiveMessage(),!0!==bp.Pusher_FrontCommon.worker_enabled)&&(bp.Pusher_FrontCommon.pusher.connection.bind("disconnected",function(){bp.Pusher_FrontCommon.removed_channels(),!0===bp.Pusher_FrontCommon.try_reconnect&&bp.Pusher_FrontCommon.pusher.connect()}),bp.Pusher_FrontCommon.pusher.connection.bind("connected",function(){!0===bp.Pusher_FrontCommon.try_reconnect&&(bp.Pusher_FrontCommon.try_reconnect=!1)})),bp.Pusher_FrontCommon.subscribe_channels()},subscribe_channels:function(){bp.Pusher_FrontCommon.bb_pusher_channels.forEach(function(e){var r;"private-bb-pro-global"===e?bp.Pusher_FrontCommon.pusherGlobalChannel(e):-1<e.search("private-bb-message-thread-")?(r=e.replace("private-bb-message-thread-",""),bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(parseInt(r))):-1<e.search("private-bb-user-")&&bp.Pusher_FrontCommon.pusherSubscribeUserChannel(e)})},removed_channels:function(){jQuery.each(bb_pusher_vars,function(e){-1!==e.indexOf("live_message_")&&delete bb_pusher_vars[e]})},addListeners:function(){g(document).ajaxSuccess(function(e,r,s){var a,n="";bp.Pusher_FrontCommon.pusher&&void 0!==bp.Pusher_FrontCommon.pusher.channels&&"on"===bb_pusher_vars.is_live_messaging_enabled&&(s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=messages_get_user_message_threads")&&void 0!==r.responseText&&!0===(n=g.parseJSON(r.responseText)).success&&n.data&&0<(a=n.data.threads).length&&a.forEach(function(e){bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(parseInt(e.id))}),s.hasOwnProperty("url"))&&"string"==typeof s.url&&-1<s.url.search("action=buddyboss_theme_get_header_unread_messages")&&void 0!==r.responseText&&"on"===bb_pusher_vars.is_live_messaging_enabled&&!0===(n=g.parseJSON(r.responseText)).success&&n.data&&""!=(a=n.data.contents)&&((s=document.createElement("div")).innerHTML=a,0<(r=g(s).find("li")).length&&g.each(r,function(e,r){r=g(r).attr("data-thread-id");bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(parseInt(r))}),s.remove())})},setupToast:function(){var e=bp.Pusher_FrontCommon,r=e.readCookie("bb-thread-delete"),r=(r&&(jQuery(document).trigger("bb_trigger_toast_message",["",r,"warning",null,!0]),e.createCookie("bb-thread-delete","",-1)),e.readCookie("bb-message-component-disabled")),r=(r&&(jQuery(document).trigger("bb_trigger_toast_message",["",r,"warning",null,!0]),e.createCookie("bb-message-component-disabled","",-1)),e.readCookie("bb-message-group-thread-deleted"));r&&(jQuery(document).trigger("bb_trigger_toast_message",["",r,"info",null,!0]),e.createCookie("bb-message-group-thread-deleted","",-1))},pusherGlobalObject:function(){var e={params:{bb_pusher_user_id:bb_pusher_vars.loggedin_user_id,bb_pusher_user_data:bb_pusher_vars.user_data,alien_hash:bb_pusher_vars.alien_hash}};return void 0===window.SharedWorker||void 0===bp.bb_pusher_shared?(bp.Pusher_FrontCommon.worker_enabled=!1,new Pusher(bb_pusher_vars.app_key,{authorizer:PusherBatchAuthorizer,cluster:bb_pusher_vars.app_cluster,authEndpoint:bb_pusher_vars.auth_endpoint,auth:e,userAuthentication:{endpoint:bb_pusher_vars.user_auth_endpoint,transport:"ajax"}})):(bp.Pusher_FrontCommon.worker_enabled=!0,bp.bb_pusher_shared.constructor(bb_pusher_vars.app_key,{encrypted:!0,authorizer:bb_pusher_vars.bb_pro_pusher_auth,cluster:bb_pusher_vars.app_cluster,authEndpoint:bb_pusher_vars.auth_endpoint,auth:e,userAuthentication:{endpoint:bb_pusher_vars.user_auth_endpoint,transport:"ajax"}}))},pusherGlobalChannel:function(e){bb_pusher_vars.global_channel=bp.Pusher_FrontCommon.pusher.subscribe(e),bb_pusher_vars.global_channel.bind("pusher:subscription_succeeded",function(){}),bb_pusher_vars.global_channel.bind("pusher:subscription_error",function(){}),bp.Pusher_FrontCommon.pusherModeration(bb_pusher_vars.global_channel),bp.Pusher_FrontCommon.pusherComponents(bb_pusher_vars.global_channel),bp.Pusher_FrontCommon.pusherSettingsUpdate(bb_pusher_vars.global_channel),bb_pusher_vars.global_channel.bind("client-bb-pro-message-access-control-update",function(){var e;bb_pusher_vars.current_thread_recipients_count<=1&&"no"===bb_pusher_vars.is_admin&&(e=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+bb_pusher_vars.current_thread_id+"/?hash="+e,{trigger:!0})),void 0!==window.Backbone.trigger&&"no"===bb_pusher_vars.is_admin&&window.Backbone.trigger("relistelements")}),bb_pusher_vars.global_channel.bind("client-bb-pro-message-is-connected",function(){var e;0<parseInt(bb_pusher_vars.current_thread_id)&&"no"===bb_pusher_vars.is_admin&&(e=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+bb_pusher_vars.current_thread_id+"/?hash="+e,{trigger:!0})),void 0!==window.Backbone.trigger&&"no"===bb_pusher_vars.is_admin&&window.Backbone.trigger("relistelements")}),bb_pusher_vars.global_channel.bind("client-bb-pro-update-group-messages",function(e){var r,s,a;parseInt(e.previous)!==parseInt(e.updated)&&(bb_pusher_vars.current_thread.is_group_thread&&!0===bb_pusher_vars.current_thread.is_group_thread&&(r=(new Date).getTime(),a=(s=g(".message-lists .thread-item:first-child")).find(".bp-message-link").attr("data-thread-id"),parseInt(a)===parseInt(bb_pusher_vars.current_thread_id)&&(a=s.next(".thread-item").find(".bp-message-link").attr("data-thread-id")),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+a+"/?hash="+r,{trigger:!0})),0===parseInt(e.updated)&&jQuery(document).trigger("bb_trigger_toast_message",["",bb_pusher_vars.i18n.group_message_disabled,"warning",null,!0]),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),void 0!==window.wp.heartbeat)&&window.wp.heartbeat.connectNow()})},pusherSubscribeUserChannel:function(e){bb_pusher_vars.user_channel=bp.Pusher_FrontCommon.pusher.subscribe(e),bb_pusher_vars.user_channel.bind("pusher:subscription_succeeded",function(){}),bb_pusher_vars.user_channel.bind("pusher:subscription_error",function(){}),bb_pusher_vars.user_channel.bind("client-bb-pro-member-connection-requested",function(e){var s;bp.Nouveau.updateUserPresence(parseInt(e.friend_user_id),"online"),parseInt(bb_pusher_vars.loggedin_user_id)===parseInt(e.friend_user_id)&&(e=e.thread_ids,s=[],0<e.length&&g.each(e,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<s.length)&&g.each(s,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))})}),bb_pusher_vars.user_channel.bind("client-bb-pro-member-withdrawn-connection-request",function(e){var s;bp.Nouveau.updateUserPresence(parseInt(e.friend_user_id),"online"),parseInt(bb_pusher_vars.loggedin_user_id)===parseInt(e.friend_user_id)&&(e=e.thread_ids,s=[],0<e.length&&g.each(e,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<s.length)&&g.each(s,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))})}),bb_pusher_vars.user_channel.bind("client-bb-pro-member-accepted-connection-request",function(e){var r=e.thread_ids,s=[];bp.Nouveau.updateUserPresence(parseInt(e.initiator_user_id),"online"),0<r.length&&g.each(r,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<s.length&&g.each(s,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))}),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements")}),bb_pusher_vars.user_channel.bind("client-bb-pro-member-rejected-connection-request",function(e){var r=e.thread_ids,s=[],a=(new Date).getTime();bp.Nouveau.updateUserPresence(parseInt(e.initiator_user_id),"online"),0<r.length&&g.each(r,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<s.length&&g.each(s,function(e,r){parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(a=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+a,{trigger:!0})),parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(a=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+a,{trigger:!0}))}),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements")}),bb_pusher_vars.user_channel.bind("client-bb-pro-member-blocked",function(s){var e,a,n,t;bp.Nouveau.updateUserPresence(parseInt(s.creator_id),"online"),"on"===bb_pusher_vars.is_live_messaging_enabled&&(s.creator_id&&parseInt(s.creator_id)===parseInt(bb_pusher_vars.loggedin_user_id)||s.blocked_id&&parseInt(s.blocked_id)===parseInt(bb_pusher_vars.loggedin_user_id))&&(e=s.thread_ids,a=[],0<e.length&&g.each(e,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&a.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<a.length)&&(g.each(a,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))}),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements"),"on"===bb_pusher_vars.is_live_messaging_enabled&&(s.creator_id&&parseInt(s.creator_id)===parseInt(bb_pusher_vars.loggedin_user_id)||s.blocked_id&&parseInt(s.blocked_id)===parseInt(bb_pusher_vars.loggedin_user_id))&&(s.blocked_id&&parseInt(s.blocked_id)===parseInt(bb_pusher_vars.loggedin_user_id)&&(n="",g.each(bb_pusher_vars.blocked_users_ids,function(e,r){parseInt(s.blocked_id)===parseInt(r.id)&&(n=e)}),""!==n)&&delete bb_pusher_vars.blocked_users_ids[n],s.creator_id&&parseInt(s.creator_id)===parseInt(bb_pusher_vars.loggedin_user_id)&&(t="",g.each(bb_pusher_vars.is_blocked_by_users,function(e,r){parseInt(s.creator_id)===parseInt(r.id)&&(t=e)}),""!==t)&&delete bb_pusher_vars.is_blocked_by_users[t],void 0!==window.wp.heartbeat)&&window.wp.heartbeat.connectNow()}),bb_pusher_vars.user_channel.bind("client-bb-pro-member-unblocked",function(s){var e,a,n,t;bp.Nouveau.updateUserPresence(parseInt(s.creator_id),"online"),"on"===bb_pusher_vars.is_live_messaging_enabled&&(s.creator_id&&parseInt(s.creator_id)===parseInt(bb_pusher_vars.loggedin_user_id)||s.unblocked_id&&parseInt(s.unblocked_id)===parseInt(bb_pusher_vars.loggedin_user_id))&&(e=s.thread_ids,a=[],0<e.length&&g.each(e,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&a.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<a.length)&&(g.each(a,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))}),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements"),"on"===bb_pusher_vars.is_live_messaging_enabled&&(n="",g.each(bb_pusher_vars.blocked_users_ids,function(e,r){parseInt(s.unblocked_id)===parseInt(r.id)&&(n=e)}),t="",g.each(bb_pusher_vars.is_blocked_by_users,function(e,r){parseInt(s.creator_id)===parseInt(r.id)&&(t=e)}),s.creator_id&&parseInt(s.creator_id)===parseInt(bb_pusher_vars.loggedin_user_id)&&s.unblocked_id&&""!==n&&delete bb_pusher_vars.blocked_users_ids[n],s.unblocked_id)&&parseInt(s.unblocked_id)===parseInt(bb_pusher_vars.loggedin_user_id)&&s.creator_id&&""!==t&&delete bb_pusher_vars.is_blocked_by_users[t]}),bb_pusher_vars.user_channel.bind("client-bb-pro-group-message-group-update-notify",function(e){var r,s,a,n,t,o=e.action;""!==o&&(a=e.thread_id,r=0,e=e.sender_id,t="",bp.Nouveau.updateUserPresence(parseInt(e),"online"),void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[a]&&(r=parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[a])),"group_message_group_joined"===o||"group_message_group_un_ban"===o?(void 0!==window.wp.heartbeat&&window.wp.heartbeat.connectNow(),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),0<r&&parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&void 0!==bp.Nouveau.Messages&&(t=(new Date).getTime(),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+t,{trigger:!0}))):"group_message_group_promoted"===o||"group_message_group_demoted"===o?0<r&&parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&void 0!==bp.Nouveau.Messages&&(t=(new Date).getTime(),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+t,{trigger:!0})):"group_message_group_left"!==o&&"group_message_group_ban"!==o&&"groups_remove_member"!==o||(parseInt(e)===parseInt(bb_pusher_vars.loggedin_user_id)&&0<r&&void 0!==bp.Nouveau.Messages&&(bp.Nouveau.Messages.threads.remove(bp.Nouveau.Messages.threads.get(r)),0<r)&&bb_pusher_vars.bb_pro_pusher_thread_ids[a]&&delete bb_pusher_vars.bb_pro_pusher_thread_ids[a],0<r&&r===parseInt(bb_pusher_vars.current_thread_id)&&(t=(new Date).getTime(),parseInt(e)===parseInt(bb_pusher_vars.loggedin_user_id)?(s=(a=g(".message-lists .thread-item:first-child")).find(".bp-message-link").attr("data-thread-id"),parseInt(s)===r&&(s=a.next(".thread-item").find(".bp-message-link").attr("data-thread-id")),a=g(".single-message-thread-header .participants-name").text(),n="","group_message_group_left"===o?n=bb_pusher_vars.i18n.thread_left+a:"group_message_group_ban"===o?n=bb_pusher_vars.i18n.group_banned+a:"groups_remove_member"===o&&(n=bb_pusher_vars.i18n.remove_from_group+a),jQuery(document).trigger("bb_trigger_toast_message",["",n,"info",null,!0]),void 0!==s&&void 0!==bp.Nouveau.Messages?(bb_pusher_vars.current_thread_id=parseInt(s),bp.Nouveau.Messages.router.navigate("view/"+s+"/?hash="+t,{trigger:!0})):void 0!==bp.Nouveau.Messages&&(bb_pusher_vars.current_thread_id=0,bp.Nouveau.Messages.router.navigate("compose/",{trigger:!0}))):void 0!==bp.Nouveau.Messages&&bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+t,{trigger:!0})),parseInt(e)===parseInt(bb_pusher_vars.loggedin_user_id)&&(void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),void 0!==window.wp.heartbeat)&&window.wp.heartbeat.connectNow()))}),bb_pusher_vars.user_channel.bind("client-bb-pro-new-group-message",function(s){var a=bp.Pusher_FrontCommon.json2array(s.recipients);setTimeout(function(){var e,r;void 0!==a&&-1!==g.inArray(bb_pusher_vars.alien_hash,a)&&(void(e=0)!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[s.thread_id]&&(e=parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[s.thread_id])),0<parseInt(e)?(r=(new Date).getTime(),parseInt(e)===parseInt(bb_pusher_vars.current_thread_id)&&bp.Nouveau.Messages.router.navigate("view/"+e+"/?hash="+r,{trigger:!0}),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),void 0!==window.wp.heartbeat&&window.wp.heartbeat.connectNow()):void 0!==s.thread&&(bb_pusher_vars.group_threads[s.thread_id]=parseInt(s.thread),bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(parseInt(s.thread)),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements"))},500)}),bb_pusher_vars.user_channel.bind("client-bb-pro-new-thread-create",function(e){var r=e.thread_id,s=bp.Pusher_FrontCommon.json2array(e.recipients);setTimeout(function(){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0===bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&void 0!==s&&-1!==g.inArray(bb_pusher_vars.alien_hash,s)&&(void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),void 0!==window.wp.heartbeat)&&window.wp.heartbeat.connectNow()},500)}),bb_pusher_vars.user_channel.bind("client-bb-pro-reconnect",function(){(bp.Pusher_FrontCommon.try_reconnect=!0)===bp.Pusher_FrontCommon.worker_enabled&&bp.bb_pusher_shared.sendMessage("updateReconnect",{try_reconnect:!0})})},pusherSubscribeThreadsChannels:function(e){var r="live_message_"+e;void 0===bb_pusher_vars[r]&&(bb_pusher_vars[r]=bp.Pusher_FrontCommon.pusher.subscribe("private-bb-message-thread-"+e),bp.Pusher_FrontCommon.pusherMessageListen(bb_pusher_vars[r]))},pusherLiveMessage:function(){void 0!==bb_pusher_vars.current_thread_id&&0<bb_pusher_vars.current_thread_id&&bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(bb_pusher_vars.current_thread_id),g(document).on("heartbeat-tick",function(e,r){void 0!==r.bb_pro_pusher_thread_ids&&(bb_pusher_vars.bb_pro_pusher_thread_ids=r.bb_pro_pusher_thread_ids,0<Object.keys(r.bb_pro_pusher_thread_ids).length)&&g.each(r.bb_pro_pusher_thread_ids,function(e,r){bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(parseInt(r))}),void 0!==r.blocked_users_ids&&(bb_pusher_vars.blocked_users_ids=r.blocked_users_ids),void 0!==r.suspended_users_ids&&(bb_pusher_vars.suspended_users_ids=r.suspended_users_ids),void 0!==r.is_blocked_by_users&&(bb_pusher_vars.is_blocked_by_users=r.is_blocked_by_users),void 0!==r.group_threads&&(bb_pusher_vars.group_threads=r.group_threads),void 0!==bb_pusher_vars.group_threads&&0<Object.keys(bb_pusher_vars.group_threads).length&&g.each(bb_pusher_vars.group_threads,function(e,r){bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(parseInt(r))})}),g(document).on("click","#message-threads .thread-item",bp.Pusher_FrontCommon.pusherUpdateChannel.bind(this)),g(document).on("click",".bp-messages-nav-panel #compose",bp.Pusher_FrontCommon.pusherCompose.bind(this)),g(document).on("keyup","#message_content",bp.Pusher_FrontCommon.pusherMessageTypingEvent.bind(this)),g(document).ajaxComplete(function(e,r,s){var a,n;s.hasOwnProperty("data")&&"string"==typeof s.data&&0<s.data.search("action=messages_send_reply")&&void 0!==r.responseText&&void 0!==(r=g.parseJSON(r.responseText)).data.type&&"error"===r.data.type&&(a={hash:(r=bp.Pusher_FrontCommon.bbParseParams(bb_pusher_vars.ajax_url+"?"+s.data)).hash,thread_id:r.thread_id,sender_id:parseInt(bb_pusher_vars.loggedin_user_id)},n="live_message_"+bb_pusher_vars.current_thread_id,bb_pusher_vars.current_thread_id&&parseInt(bb_pusher_vars.current_thread_id)===parseInt(r.thread_id)&&bb_pusher_vars[n]&&bb_pusher_vars[n].trigger("client-bb-pro-after-ajax-fail",a),n={hash:r.hash,actions:s.data,canceltext:bb_pusher_vars.cancel_text,notdeliveredtext:bb_pusher_vars.not_delivered_text,tryagaintext:bb_pusher_vars.try_again_text,thread_id:r.thread_id},bp.Pusher_FrontCommon.renderAjaxUpdateFailedMessage(n),!0===bp.Pusher_FrontCommon.worker_enabled)&&bp.bb_pusher_shared.sendMessage("renderAjaxUpdateFailedMessage",n)}),g(document).ajaxSuccess(function(e,r,s){var a,n,t,o,_="";s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=messages_get_thread_messages")&&void 0!==r.responseText&&!0===(o=g.parseJSON(r.responseText)).success&&o.data&&(a=parseInt(o.data.thread.id),bb_pusher_vars.current_thread=o.data,parseInt(bb_pusher_vars.current_thread_id)===a&&(a in bp.Pusher_FrontCommon.typer_data||(bp.Pusher_FrontCommon.typer_data[a]=[]),n=bp.Pusher_FrontCommon.typer_data[a].filter(function(e){return null!=e}),bp.Pusher_FrontCommon.singleThreadTypingIndicator(n),bp.Pusher_FrontCommon.threadListTypingIndicator(a,n),clearTimeout(bp.Pusher_FrontCommon.clearTimerId[a]),bp.Pusher_FrontCommon.clearTimerId[a]=setTimeout(function(){parseInt(a)===parseInt(bb_pusher_vars.current_thread_id)&&bp.Pusher_FrontCommon.singleThreadTypingIndicator([]),bp.Pusher_FrontCommon.threadListTypingIndicator(a,[])},bp.Pusher_FrontCommon.clearInterval)),bb_pusher_vars.current_thread_recipients_count=o.data.thread.recipients.current_count,bb_pusher_vars.current_thread_group_id=""!==o.data.group_id?parseInt(o.data.group_id):0,0===parseInt(bb_pusher_vars.current_thread_id))&&a&&(bb_pusher_vars.current_thread_id=a),s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=messages_get_user_message_threads")&&void 0!==r.responseText&&(n=g.parseJSON(r.responseText)).data.threads&&0<(o=n.data.threads).length&&o.forEach(function(e){var r=parseInt(e.id),e=(r in bp.Pusher_FrontCommon.typer_data||(bp.Pusher_FrontCommon.typer_data[r]=[]),bp.Pusher_FrontCommon.typer_data[r].filter(function(e){return null!=e}));bp.Pusher_FrontCommon.singleThreadTypingIndicator(e),bp.Pusher_FrontCommon.threadListTypingIndicator(r,e),clearTimeout(bp.Pusher_FrontCommon.clearTimerId[r]),bp.Pusher_FrontCommon.clearTimerId[r]=setTimeout(function(){parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&bp.Pusher_FrontCommon.singleThreadTypingIndicator([]),bp.Pusher_FrontCommon.threadListTypingIndicator(r,[])},bp.Pusher_FrontCommon.clearInterval)}),s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=messages_send_reply")&&void 0!==r.responseText&&(void 0!==(n=g.parseJSON(r.responseText)).data.type&&"error"===n.data.type?(t={hash:(o=bp.Pusher_FrontCommon.bbParseParams(bb_pusher_vars.ajax_url+"?"+s.data)).hash,thread_id:o.thread_id,sender_id:parseInt(bb_pusher_vars.loggedin_user_id)},_="live_message_"+bb_pusher_vars.current_thread_id,bb_pusher_vars.current_thread_id&&parseInt(bb_pusher_vars.current_thread_id)===parseInt(o.thread_id)&&bb_pusher_vars[_]&&bb_pusher_vars[_].trigger("client-bb-pro-after-ajax-fail",t),_={hash:o.hash,actions:s.data,canceltext:bb_pusher_vars.cancel_text,notdeliveredtext:bb_pusher_vars.not_delivered_text,tryagaintext:bb_pusher_vars.try_again_text,thread_id:o.thread_id},bp.Pusher_FrontCommon.renderAjaxUpdateFailedMessage(_),!0===bp.Pusher_FrontCommon.worker_enabled&&bp.bb_pusher_shared.sendMessage("renderAjaxUpdateFailedMessage",_)):(t={hash:n.data.hash,message:n.data.messages[0],recipient_inbox_unread_counts:n.data.recipient_inbox_unread_counts,thread_id:n.data.thread_id},bp.Pusher_FrontCommon.renderAjaxUpdateMessage(t),bp.Pusher_FrontCommon.bb_update_header_messages())),s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=messages_delete")&&void 0!==r.responseText&&(void 0!==(o=g.parseJSON(r.responseText)).data.recipient_inbox_unread_counts&&bp.Pusher_FrontCommon.updateInboxMessageUnreadCount(bp.Pusher_FrontCommon.json2array(o.data.recipient_inbox_unread_counts)),bp.Pusher_FrontCommon.bb_update_header_messages()),s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=heartbeat")&&0<bb_pusher_vars.bb_pro_pusher_thread_ids.length&&bb_pusher_vars.bb_pro_pusher_thread_ids.forEach(function(e){var r;(e=parseInt(e))===parseInt(bb_pusher_vars.current_thread_id)&&(e in bp.Pusher_FrontCommon.typer_data||(bp.Pusher_FrontCommon.typer_data[e]=[]),r=bp.Pusher_FrontCommon.typer_data[e].filter(function(e){return null!=e}),bp.Pusher_FrontCommon.singleThreadTypingIndicator(r),bp.Pusher_FrontCommon.threadListTypingIndicator(e,r),clearTimeout(bp.Pusher_FrontCommon.clearTimerId[e]),bp.Pusher_FrontCommon.clearTimerId[e]=setTimeout(function(){parseInt(e)===parseInt(bb_pusher_vars.current_thread_id)&&bp.Pusher_FrontCommon.singleThreadTypingIndicator([]),bp.Pusher_FrontCommon.threadListTypingIndicator(e,[])},bp.Pusher_FrontCommon.clearInterval))}),s.hasOwnProperty("data")&&"string"==typeof s.data&&(-1<s.data.search("action=messages_unread")||-1<s.data.search("action=messages_read"))&&void 0!==r.responseText&&void 0!==window.wp.heartbeat&&window.wp.heartbeat.connectNow(),s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=messages_hide_thread")&&void 0!==r.responseText&&void 0!==bp.Nouveau.Messages.threads&&(void 0!==bp.Nouveau.Messages.threads.length&&0<bp.Nouveau.Messages.threads.length?bb_pusher_vars.current_thread_id=bp.Nouveau.Messages.threads.at(0).id:bb_pusher_vars.current_thread_id=0),s.hasOwnProperty("data")&&"string"==typeof s.data&&-1<s.data.search("action=groups_join_group")&&void 0!==r.responseText&&void 0!==(_=g.parseJSON(r.responseText)).success&&!0===_.success&&bp.Pusher_FrontCommon.bb_update_header_messages()}),g(document).ajaxError(function(e,r,s){var a,n,t;s.hasOwnProperty("data")&&"string"==typeof s.data&&0<s.data.search("action=messages_send_reply")&&(n={hash:(a=bp.Pusher_FrontCommon.bbParseParams(bb_pusher_vars.ajax_url+"?"+s.data)).hash,thread_id:a.thread_id,sender_id:parseInt(bb_pusher_vars.loggedin_user_id)},t="live_message_"+bb_pusher_vars.current_thread_id,bb_pusher_vars.current_thread_id&&parseInt(bb_pusher_vars.current_thread_id)===parseInt(a.thread_id)&&bb_pusher_vars[t]&&bb_pusher_vars[t].trigger("client-bb-pro-after-ajax-fail",n),t={hash:a.hash,actions:s.data,canceltext:bb_pusher_vars.cancel_text,notdeliveredtext:bb_pusher_vars.not_delivered_text,tryagaintext:bb_pusher_vars.try_again_text,thread_id:a.thread_id},bp.Pusher_FrontCommon.renderAjaxUpdateFailedMessage(t),!0===bp.Pusher_FrontCommon.worker_enabled&&bp.bb_pusher_shared.sendMessage("renderAjaxUpdateFailedMessage",t),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements")}),g(document).ajaxSend(function(e,r,s){var a,n,t,o,_,d,i,u,b,p,h,c;s.hasOwnProperty("data")&&"string"==typeof s.data&&0<s.data.search("action=messages_send_reply")&&(a=bp.Pusher_FrontCommon.bb_unserialize(s.data),n=[],t=[],o=[],_=[],d=[],i={},u=window.deparam(s.data),c='<div class="message_send_sending"><span class="info-text-send-message">'+bb_pusher_vars.sending_text+"</span></div>",delete a.nonce,delete a.action,g.each(a,function(e){(-1<e.search("media")||-1<e.search("video")||-1<e.search("document")||-1<e.search("gif_data"))&&delete a[e]}),void 0!==u.media&&u.media&&(u.media.forEach(function(e){var r=e.thumb,s=(void 0!==e.js_preview&&(r=e.js_preview),null),a=null;1===u.media.length&&(s=e.image_h,a=e.image_w),n.push({id:e.id,attachment_id:e.id,full:e.url,privacy:e.privacy,thumbnail:e.msg_url||e.medium||e.thumb,title:e.name,height:s,width:a,menu_order:parseInt(e.menu_order)}),t.push({id:e.id,attachment_id:e.id,full:e.url,privacy:e.privacy,thumbnail:r,title:e.name,height:s,width:a,menu_order:parseInt(e.menu_order)})}),1<n.length&&n.sort(function(e,r){return e.menu_order-r.menu_order}),1<t.length)&&t.sort(function(e,r){return e.menu_order-r.menu_order}),void 0!==u.video&&u.video&&(u.video.forEach(function(e){void 0===e.js_preview&&(e.js_preview=bb_pusher_vars.video_default_url),_.push({id:e.id,attachment_id:e.id,full:e.url,privacy:e.privacy,thumbnail:bb_pusher_vars.video_default_url,title:e.name,vid_ids_fake:e.vid_msg_url,ext:e.ext,menu_order:parseInt(e.menu_order)}),d.push({id:e.id,attachment_id:e.id,full:e.url,privacy:e.privacy,thumbnail:e.js_preview,title:e.name,vid_ids_fake:e.vid_msg_url,ext:e.ext,menu_order:parseInt(e.menu_order)})}),1<_.length&&_.sort(function(e,r){return e.menu_order-r.menu_order}),1<d.length)&&d.sort(function(e,r){return e.menu_order-r.menu_order}),void 0!==u.document&&u.document&&(u.document.forEach(function(e){o.push({id:e.id,attachment_id:e.id,full:e.url,privacy:e.privacy,thumbnail:"",title:e.name,url:e.url,svg_icon:e.svg_icon,extension:e.extension,author:"",preview:"",full_preview:"",text_preview:"",mp3_preview:"",document_title:e.name,mirror_text:"",size:e.size,extension_description:"",download_text:"",download:"",copy_download_link:"",msg_preview:"",menu_order:parseInt(e.menu_order)})}),1<o.length)&&o.sort(function(e,r){return e.menu_order-r.menu_order}),void 0!==u.gif_data&&u.gif_data&&(p="",void 0!==u.gif_data.images["480w_still"].url&&(p=u.gif_data.images["480w_still"].url),i.video_url=u.gif_data.images.original_mp4.mp4,i.preview_url=p),p=new URLSearchParams(s.data),s=Object.fromEntries(p),p=(p=g.trim(g("<p>"+s.content+"<p>").text())).replace(/&nbsp;/g," "),h=b=void 0!==a.hash?a.hash:(new Date).getTime(),s=p=""===p?"":s.content,void 0!==u.resend&&(h=b+" sending",s+=c),(n||_||o)&&(h+=" has-medias"),a.id=b,a.sender_id=bb_pusher_vars.loggedin_user_id,a.sender_name=bb_pusher_vars.loggedin_user_name,a.gif=i,a.is_user_suspended="true"===a.is_user_suspended,a.is_user_blocked="true"===a.is_user_blocked,a.is_user_deleted="true"===a.is_user_deleted,a.sender_avatar=bb_pusher_vars.sender_avatar,a.sender_link=bb_pusher_vars.sender_link,a.display_date=bp.Pusher_FrontCommon.getWPCurrentTime(),a.display_date_list=bb_pusher_vars.display_date,a.className=h,a.sender_is_you=!0,a.thread_id=bb_pusher_vars.current_thread_id,a.content=s,a.excerpt="",s&&(a.excerpt=s.replace(/(<br\s*?\/?>|<\/(\w+)><(\w+)>)/g," ").replace(/(<([^>]+)>)/gi,"").replace(/\s+/g," "),75<a.excerpt.length)&&(a.excerpt=a.excerpt.substring(0,75)+"..."),a.media=n,a.video=_,a.document=o,a.is_group=!1,void 0!==bb_pusher_vars.current_thread.group_id&&0<parseInt(bb_pusher_vars.current_thread.group_id)&&(a.is_group=!0),a.has_media=!1,(0<n.length||0<_.length||0<o.length||void 0!==i.video_url&&void 0!==i.preview_url)&&(a.has_media=!0),void 0!==u.resend?(bp.Pusher_FrontCommon.renderUpdateSendingMessage(a),!0===bp.Pusher_FrontCommon.worker_enabled&&bp.bb_pusher_shared.sendMessage("resend-message-ajax-send",a)):(a.media=t,a.video=d,bp.Pusher_FrontCommon.renderMessage(a),!0===bp.Pusher_FrontCommon.worker_enabled&&bp.bb_pusher_shared.sendMessage("before-message-ajax-send",a)),a.media=n,a.video=_,c="live_message_"+bb_pusher_vars.current_thread_id,a.content=p,bb_pusher_vars[c]&&(a.sender_is_you=!1,bp.Pusher_FrontCommon.triggerPusherChunked(bb_pusher_vars[c],"client-bb-pro-before-message-ajax-send",a)),g("#messages-media-button").length&&g("#messages-media-button").removeClass("active"),g("#messages-video-button").length&&g("#messages-video-button").removeClass("active"),g("#messages-document-button").length&&g("#messages-document-button").removeClass("active"),g("#messages-gif-button").length&&g("#messages-gif-button").removeClass("active"),g(window).trigger("scroll"))})},pusherMessageListen:function(e){e.bind("pusher:subscription_succeeded",function(){}),e.bind("pusher:subscription_error",function(){}),e.bind("client-bb-pro-before-message-ajax-send",function(e){var r;void 0!==e.sender_id&&(bp.Nouveau.updateUserPresence(parseInt(e.sender_id),"online"),void 0!==e.thread_id)&&bp.Pusher_FrontCommon.threadTypingEnd(parseInt(e.thread_id),parseInt(e.sender_id)),void 0!==e.message_chunk_id?(bp.Pusher_FrontCommon.chunks_event.hasOwnProperty(e.message_chunk_id)||(bp.Pusher_FrontCommon.chunks_event[e.message_chunk_id]={chunks:[]}),(r=bp.Pusher_FrontCommon.chunks_event[e.message_chunk_id]).chunks[e.message_chunk_index]=e.message_chunk,e.message_chunk_final&&r.chunks.length===e.message_total_chunk&&(bp.Pusher_FrontCommon.renderMessage(JSON.parse(r.chunks.join(""))),delete bp.Pusher_FrontCommon.chunks_event[e.message_chunk_id])):bp.Pusher_FrontCommon.renderMessage(e)}),bp.Pusher_FrontCommon.bindWithPusherChunking(e,"client-bb-pro-after-message-ajax-complete",function(e){e.message,bp.Pusher_FrontCommon.renderAjaxUpdateMessage(e),bp.Pusher_FrontCommon.updateInboxMessageUnreadCount(e.recipient_inbox_unread_counts),bp.Pusher_FrontCommon.bb_update_header_messages(),g(window).trigger("scroll")}),e.bind("client-bb-pro-thread-delete-message",function(e){void 0!==window.Backbone.trigger&&void 0!==e.thread_id&&(window.Backbone.trigger("onMessageDeleteSuccess",e),bp.Pusher_FrontCommon.bb_update_header_messages())}),e.bind("client-bb-pro-after-ajax-fail",function(e){void 0!==window.Backbone.trigger&&void 0!==e.thread_id&&parseInt(e.thread_id)===parseInt(bb_pusher_vars.current_thread_id)&&window.Backbone.trigger("onMessageAjaxFail",e)}),e.bind("client-bb-pro-typing-start",function(e){var r=parseInt(e.thread_id),s=parseInt(e.user_id);bp.Nouveau.updateUserPresence(s,"online"),s!==parseInt(bb_pusher_vars.loggedin_user_id)&&(r in bp.Pusher_FrontCommon.typer_data||(bp.Pusher_FrontCommon.typer_data[r]=[]),s in bp.Pusher_FrontCommon.typer_data[r]||(bp.Pusher_FrontCommon.typer_data[r][s]=e.username),e=bp.Pusher_FrontCommon.typer_data[r].filter(function(e){return null!=e}),parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&bp.Pusher_FrontCommon.singleThreadTypingIndicator(e),bp.Pusher_FrontCommon.threadListTypingIndicator(r,e),clearTimeout(bp.Pusher_FrontCommon.clearTimerId[r]),bp.Pusher_FrontCommon.clearTimerId[r]=setTimeout(function(){bp.Pusher_FrontCommon.threadTypingEnd(r,s)},bp.Pusher_FrontCommon.clearInterval))}),e.bind("client-bb-pro-typing-end",function(e){bp.Pusher_FrontCommon.threadTypingEnd(e.thread_id,e.user_id)}),e.bind("client-bb-pro-group-message-group-update-notify",function(e){var r,s,a,n,t,o=e.action;""!==o&&(a=e.thread_id,r=0,e=e.sender_id,t="",bp.Nouveau.updateUserPresence(parseInt(e),"online"),void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[a]&&(r=parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[a])),"group_message_group_joined"===o||"group_message_group_un_ban"===o?(void 0!==window.wp.heartbeat&&window.wp.heartbeat.connectNow(),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),0<r&&parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&void 0!==bp.Nouveau.Messages&&(t=(new Date).getTime(),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+t,{trigger:!0}))):"group_message_group_promoted"===o||"group_message_group_demoted"===o?0<r&&parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&void 0!==bp.Nouveau.Messages&&(t=(new Date).getTime(),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+t,{trigger:!0})):"group_message_group_left"!==o&&"group_message_group_ban"!==o&&"groups_remove_member"!==o||(parseInt(e)===parseInt(bb_pusher_vars.loggedin_user_id)&&0<r&&void 0!==bp.Nouveau.Messages&&(bp.Nouveau.Messages.threads.remove(bp.Nouveau.Messages.threads.get(r)),0<r)&&bb_pusher_vars.bb_pro_pusher_thread_ids[a]&&delete bb_pusher_vars.bb_pro_pusher_thread_ids[a],0<r&&r===parseInt(bb_pusher_vars.current_thread_id)&&(t=(new Date).getTime(),parseInt(e)===parseInt(bb_pusher_vars.loggedin_user_id)?(s=(a=g(".message-lists .thread-item:first-child")).find(".bp-message-link").attr("data-thread-id"),parseInt(s)===r&&(s=a.next(".thread-item").find(".bp-message-link").attr("data-thread-id")),a=g(".single-message-thread-header .participants-name").text(),n="","group_message_group_left"===o?n=bb_pusher_vars.i18n.thread_left+a:"group_message_group_ban"===o?n=bb_pusher_vars.i18n.group_banned+a:"groups_remove_member"===o&&(n=bb_pusher_vars.i18n.remove_from_group+a),jQuery(document).trigger("bb_trigger_toast_message",["",n,"info",null,!0]),void 0!==s&&void 0!==bp.Nouveau.Messages?(bb_pusher_vars.current_thread_id=parseInt(s),bp.Nouveau.Messages.router.navigate("view/"+s+"/?hash="+t,{trigger:!0})):void 0!==bp.Nouveau.Messages&&(bb_pusher_vars.current_thread_id=0,bp.Nouveau.Messages.router.navigate("compose/",{trigger:!0}))):void 0!==bp.Nouveau.Messages&&bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+t,{trigger:!0})),parseInt(e)===parseInt(bb_pusher_vars.loggedin_user_id)&&(void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements"),void 0!==window.wp.heartbeat)&&window.wp.heartbeat.connectNow()))}),e.bind("client-bb-pro-group-thread-deleted",function(e){var r=e.thread_id,s=0;0<(s=void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]?parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]):s)&&s===parseInt(bb_pusher_vars.current_thread_id)?(r=e.group_name+bb_pusher_vars.i18n.deleted,1<bp.Nouveau.Messages.threads.length?(bp.Nouveau.Messages.threads.remove(parseInt(s)),bb_pusher_vars.current_thread_id=parseInt(bp.Nouveau.Messages.threads.at(0).id),bp.Nouveau.Messages.router.navigate("view/"+bb_pusher_vars.current_thread_id+"/",{trigger:!0})):(BP_Nouveau.messages.hasThreads=!1,bb_pusher_vars.current_thread_id=0,bp.Nouveau.Messages.router.navigate("compose/",{trigger:!0})),void 0!==window.wp.heartbeat&&window.wp.heartbeat.connectNow(),jQuery(document).trigger("bb_trigger_toast_message",["",r,"info",null,!0])):(bp.Nouveau.Messages.threads.remove(parseInt(s)),void 0!==window.Backbone.trigger&&"no"===bb_pusher_vars.is_admin&&window.Backbone.trigger("relistelements"),void 0!==window.wp.heartbeat&&window.wp.heartbeat.connectNow())}),e.bind("client-bb-pro-group-setting-update",function(e){var r=e.thread_id,s=0;0!==(s=void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]?parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]):s)&&bb_pusher_vars.current_thread_id===s&&"no"===bb_pusher_vars.is_admin&&-1!==g.inArray(bb_pusher_vars.alien_hash,e.member_ids)&&(r=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+bb_pusher_vars.current_thread_id+"/?hash="+r,{trigger:!0}))}),e.bind("client-bb-pro-thread-delete",function(e){var r,s=e.thread_id,a=0,n=e.recipients;void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[s]&&(a=parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[s])),0!==parseInt(a)&&(parseInt(a)===parseInt(bb_pusher_vars.current_thread_id)?(r="",void 0!==e.group_name?(r=e.group_name+bb_pusher_vars.i18n.deleted,bp.Pusher_FrontCommon.createCookie("bb-message-group-thread-deleted",r,5)):(e=(e=bp.Pusher_FrontCommon.json2array(n).map(function(e){if(e.user_id!==bb_pusher_vars.alien_hash)return e.name})).filter(function(e){return null!=e}),r=wp.i18n.sprintf(bb_pusher_vars.i18n.conversion_delete,e.join(", ")),bp.Pusher_FrontCommon.createCookie("bb-thread-delete",r,5)),"undefined"!=typeof BP_Nouveau&&void 0!==BP_Nouveau.messages&&void 0!==BP_Nouveau.messages.message_url?window.location.href=BP_Nouveau.messages.message_url:window.location.reload()):(0<(e=g('#message-threads li .bp-message-link[data-thread-id="'+a+'"]')).length&&e.parents(".thread-item").remove(),0<(r=g('#header-messages-dropdown-elem li[data-thread-id="'+a+'"]')).length&&r.remove(),n[bb_pusher_vars.alien_hash]&&(n=bp.Pusher_FrontCommon.json2array(n),bp.Pusher_FrontCommon.updateInboxMessageUnreadCount(n),bp.Pusher_FrontCommon.bb_update_header_messages(),0<a)&&bb_pusher_vars.bb_pro_pusher_thread_ids[s]&&delete bb_pusher_vars.bb_pro_pusher_thread_ids[s]))})},threadTypingEnd:function(e,r){var e=parseInt(e),s=parseInt(r),r=(bp.Nouveau.updateUserPresence(s,"online"),e in bp.Pusher_FrontCommon.typer_data||(bp.Pusher_FrontCommon.typer_data[e]=[]),r in bp.Pusher_FrontCommon.typer_data[e]&&delete bp.Pusher_FrontCommon.typer_data[e][s],bp.Pusher_FrontCommon.typer_data[e].filter(function(e){return null!=e}));parseInt(e)===parseInt(bb_pusher_vars.current_thread_id)&&bp.Pusher_FrontCommon.singleThreadTypingIndicator(r),bp.Pusher_FrontCommon.threadListTypingIndicator(e,r)},singleThreadTypingIndicator:function(e){var r;0<e.length&&g(".bp-messages-content .bp-messages-notice").find(".bp-user-messages-feedback").length<1?(r=e.length+bb_pusher_vars.i18n.two_typing,1===e.length?r="<strong>"+e.join("</strong>, <strong>")+"</strong>"+bb_pusher_vars.i18n.single_typing:2===e.length?r="<strong>"+e.join("</strong>"+bb_pusher_vars.i18n.separator+"<strong>")+"</strong>"+bb_pusher_vars.i18n.typing:2<e.length&&(r="<strong>"+e[0]+"</strong>"+bb_pusher_vars.i18n.separator+(e.length-1)+bb_pusher_vars.i18n.multiple_typing),g(".bb-pusher-typing-indicator .bb-pusher-typing-indicator-text-inner").html(r),g(".bb-pusher-typing-indicator").removeClass("bp-hide")):g(".bb-pusher-typing-indicator").addClass("bp-hide")},threadListTypingIndicator:function(e,r){var s=g('#message-threads li .bp-message-link[data-thread-id="'+e+'"]'),a=(0<r.length&&(0===g(".bp-messages-notice").find(".bp-user-messages-feedback").length||"unarchived"!==bp.Nouveau.Messages.threadType)?(a=r.length+bb_pusher_vars.i18n.two_typing,1===r.length&&(a=r.join(", ")+bb_pusher_vars.i18n.single_typing),s.find(".typing-indicator").html(a).removeClass("bp-hide"),s.find(".thread-excerpt").addClass("bp-hide")):(s.find(".typing-indicator").html("").addClass("bp-hide"),s.find(".thread-excerpt").removeClass("bp-hide")),g('#header-messages-dropdown-elem li[data-thread-id="'+e+'"]'));0<a.length&&(0<r.length&&0===g(".bp-messages-notice").find(".bp-user-messages-feedback").length?(s=r.length+bb_pusher_vars.i18n.two_typing,1===r.length&&(s=r.join(", ")+bb_pusher_vars.i18n.single_typing),a.find(".typing-indicator").html(s).removeClass("bp-hide"),a.find(".posted").addClass("bp-hide")):(a.find(".typing-indicator").html("").addClass("bp-hide"),a.find(".posted").removeClass("bp-hide")))},pusherUpdateChannel:function(e){g(e.currentTarget).hasClass("optionsOpen")||(e=g(e.currentTarget).find(".bp-message-link").data("thread-id"))&&(bb_pusher_vars.current_thread_id=parseInt(e),bb_pusher_vars.thread_channel="private-bb-message-thread-"+e,0!==parseInt(e))&&-1!==g.inArray(parseInt(e),bb_pusher_vars.bb_pro_pusher_thread_ids)&&bp.Pusher_FrontCommon.pusherSubscribeThreadsChannels(e)},pusherCompose:function(){bb_pusher_vars.current_thread_id=0,bb_pusher_vars.thread_channel=""},pusherMessageTypingEvent:function(e){var r,s,a=g(e.currentTarget).text();0!==parseInt(bb_pusher_vars.current_thread_id)&&13!==e.keyCode&&9!==e.keyCode&&16!==e.keyCode&&(r="live_message_"+bb_pusher_vars.current_thread_id,(e=document.createElement("div")).innerHTML=a,s=e.textContent||e.innerText||"",setTimeout(function(){""!==s&&bb_pusher_vars[r]?bp.Pusher_FrontCommon.can_type&&(bp.Pusher_FrontCommon.can_type=!1,bb_pusher_vars[r].trigger("client-bb-pro-typing-start",{username:bb_pusher_vars.loggedin_user_name,user_id:bb_pusher_vars.loggedin_user_id,thread_id:bb_pusher_vars.current_thread_id}),setTimeout(function(){bp.Pusher_FrontCommon.can_type=!0},bp.Pusher_FrontCommon.throttleTime)):""===s&&bb_pusher_vars[r]&&(bp.Pusher_FrontCommon.can_type=!0,bb_pusher_vars[r].trigger("client-bb-pro-typing-end",{username:bb_pusher_vars.loggedin_user_name,user_id:bb_pusher_vars.loggedin_user_id,thread_id:bb_pusher_vars.current_thread_id}))},300))},pusherModeration:function(e){e.bind("client-bb-pro-member-suspended",function(e){var s;e.user_id&&void(bb_pusher_vars.suspended_users_ids[e.user_id]=0)!==window.wp.heartbeat&&window.wp.heartbeat.connectNow(),e.user_id===bb_pusher_vars.alien_hash?window.location.reload():(e=e.thread_ids,s=[],0<e.length&&g.each(e,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<s.length&&(g.each(s,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))}),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements"))}),e.bind("client-bb-pro-member-deleted",function(e){var s;e.user_id===bb_pusher_vars.alien_hash?window.location.reload():(e=e.thread_ids,s=[],0<e.length&&g.each(e,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),0<s.length&&(g.each(s,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))}),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements"))}),e.bind("client-bb-pro-member-unsuspended",function(e){var r=e.thread_ids,s=[];0<r.length&&g.each(r,function(e,r){void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids&&void 0!==bb_pusher_vars.bb_pro_pusher_thread_ids[r]&&s.push(parseInt(bb_pusher_vars.bb_pro_pusher_thread_ids[r]))}),e.user_id&&void 0!==bb_pusher_vars.suspended_users_ids[e.user_id]&&delete bb_pusher_vars.suspended_users_ids[e.user_id],0<s.length&&(g.each(s,function(e,r){var s;parseInt(r)===parseInt(bb_pusher_vars.current_thread_id)&&(s=(new Date).getTime(),window.location.href.replace(window.location.search,""),bp.Nouveau.Messages.router.navigate("view/"+r+"/?hash="+s,{trigger:!0}))}),void 0!==window.Backbone.trigger)&&window.Backbone.trigger("relistelements")})},pusherComponents:function(e){e.bind("client-bb-pro-active-components",function(e){var r=e.previous,e=e.updated;r.messages&&void 0===e.messages&&(void 0!==bb_pusher_vars.current_thread_id?(r=bb_pusher_vars.i18n.disabled_private_message,bp.Pusher_FrontCommon.createCookie("bb-message-component-disabled",r,5),window.location.href=bb_pusher_vars.home_url):(g(document.body).find(".bb-message-dropdown-notification").length&&g(document.body).find(".bb-message-dropdown-notification").remove(),g(document.body).find(".bp-messages-nav").length&&g(document.body).find(".bp-messages-nav").remove(),g(document.body).find(".bp-compose-messages-nav").length&&g(document.body).find(".bp-compose-messages-nav").remove(),g(document.body).find(".bp-inbox-sub-nav").length&&g(document.body).find(".bp-inbox-sub-nav").remove(),g(document.body).find("#wp-admin-bar-my-account-messages").length&&g(document.body).find("#wp-admin-bar-my-account-messages").remove(),g(document.body).find(".header-aside-inner #wp-admin-bar-my-account-messages").length&&g(document.body).find(".header-aside-inner #wp-admin-bar-my-account-messages").remove()))})},pusherSettingsUpdate:function(e){e.bind("client-bb-pro-pusher-settings-change",function(){window.location.reload()})},bb_unserialize:function(e){for(var r,s,a,n=encodeURIComponent(e).replace("&","%26").replace("=","%3D").split("%26"),t={},o=0,_=n.length;o<_;o++)(a=(s=n[o].split("%3D"))[0]).indexOf("[]")===a.length-2?(void 0===t[r=a.substring(0,a.length-2)]&&(t[r]=[]),t[decodeURIComponent(r)].push(decodeURIComponent(s[1]))):t[decodeURIComponent(a)]=decodeURIComponent(s[1]);return t},renderMessage:function(e){var r=[],s=(e.is_deleted=0,e.is_new=!0,e.is_starred=!1,e.star_link="",e.date=new Date,void 0!==e.gif&&Object.keys(e.gif).length<1&&delete e.gif,void 0!==e.video&&e.video.length<1&&delete e.video,void 0!==e.document&&e.document.length<1&&delete e.document,void 0!==e.media&&e.media.length<1&&delete e.media,bp.Pusher_FrontCommon.threadTypingEnd(parseInt(e.thread_id),parseInt(e.sender_id)),[]),a=(Object.values(bb_pusher_vars.blocked_users_ids).forEach(function(e){s[parseInt(e.id)]=e}),0<s.length&&void 0!==s[parseInt(e.sender_id)]&&(e.is_user_blocked=!0,e.sender_name=s[parseInt(e.sender_id)].blocked_user_name,e.sender_avatar=s[parseInt(e.sender_id)].blocked_avatar_url,e.sender_link="",bb_pusher_vars.blocked_message_text)&&(e.content=bb_pusher_vars.blocked_message_text,void 0!==e.gif&&delete e.gif,void 0!==e.video&&delete e.video,void 0!==e.document&&delete e.document,void 0!==e.media)&&delete e.media,-1<g.inArray(parseInt(e.sender_id),bb_pusher_vars.suspended_users_ids)&&(e.is_user_suspended=!0,e.sender_name=bb_pusher_vars.suspended_avatar,e.sender_avatar=bb_pusher_vars.suspended_avatar,e.sender_link="",bb_pusher_vars.suspended_message_text)&&(e.content=bb_pusher_vars.suspended_message_text,void 0!==e.gif&&delete e.gif,void 0!==e.video&&delete e.video,void 0!==e.document&&delete e.document,void 0!==e.media)&&delete e.media,[]);Object.values(bb_pusher_vars.is_blocked_by_users).forEach(function(e){a[parseInt(e.id)]=e}),0<a.length&&void 0!==a[parseInt(e.sender_id)]&&(e.is_user_blocked_by=!0,e.sender_name=a[parseInt(e.sender_id)].blocked_user_name,e.sender_avatar=a[parseInt(e.sender_id)].blocked_avatar_url,bb_pusher_vars.blocked_by_message_text)&&(e.content=bb_pusher_vars.blocked_by_message_text,void 0!==e.gif&&delete e.gif,void 0!==e.video&&delete e.video,void 0!==e.document&&delete e.document,void 0!==e.media)&&delete e.media,r.push(e),void 0!==window.Backbone.trigger&&void 0!==e.thread_id&&parseInt(e.thread_id)===parseInt(bb_pusher_vars.current_thread_id)&&window.Backbone.trigger("onSentMessage",r),void 0!==window.Backbone.trigger&&(r={hash:e.hash,message:e,thread_id:e.thread_id},window.Backbone.trigger("relistelements",r))},renderAjaxUpdateMessage:function(e){var r=[],s=(Object.values(bb_pusher_vars.blocked_users_ids).forEach(function(e){r[parseInt(e.id)]=e}),[]);Object.values(bb_pusher_vars.is_blocked_by_users).forEach(function(e){s[parseInt(e.id)]=e}),void 0!==e.thread_id&&void 0!==e.message&&(0<r.length&&void 0!==r[parseInt(e.message.sender_id)]&&(e.message.is_user_blocked=!0,e.message.sender_name=r[parseInt(e.message.sender_id)].blocked_user_name,e.message.sender_avatar=r[parseInt(e.message.sender_id)].blocked_avatar_url,e.message.sender_link="",bb_pusher_vars.blocked_message_text)&&(e.message.content=bb_pusher_vars.blocked_message_text,void 0!==e.message.gif&&delete e.message.gif,void 0!==e.message.video&&delete e.message.video,void 0!==e.message.document&&delete e.message.document,void 0!==e.message.media)&&delete e.message.media,-1<g.inArray(parseInt(e.message.sender_id),bb_pusher_vars.suspended_users_ids)&&(e.message.is_user_suspended=!0,e.message.sender_name=bb_pusher_vars.suspended_avatar,e.message.sender_avatar=bb_pusher_vars.suspended_avatar,e.message.sender_link="",bb_pusher_vars.suspended_message_text)&&(e.content=bb_pusher_vars.suspended_message_text,void 0!==e.message.gif&&delete e.message.gif,void 0!==e.message.video&&delete e.message.video,void 0!==e.message.document&&delete e.message.document,void 0!==e.message.media)&&delete e.message.media,0<s.length)&&void 0!==s[parseInt(e.message.sender_id)]&&(e.message.is_user_blocked_by=!0,e.message.sender_name=s[parseInt(e.message.sender_id)].blocked_user_name,e.message.sender_avatar=s[parseInt(e.message.sender_id)].blocked_avatar_url,bb_pusher_vars.blocked_by_message_text)&&(e.message.content=bb_pusher_vars.blocked_by_message_text,void 0!==e.message.gif&&delete e.message.gif,void 0!==e.message.video&&delete e.message.video,void 0!==e.message.document&&delete e.message.document,void 0!==e.message.media)&&delete e.message.media,void 0!==window.Backbone.trigger&&void 0!==e.thread_id&&parseInt(e.thread_id)===parseInt(bb_pusher_vars.current_thread_id)&&window.Backbone.trigger("onReplySentSuccess",e),void 0!==window.Backbone.trigger&&window.Backbone.trigger("relistelements",e)},renderUpdateSendingMessage:function(e){var r=[];e.is_deleted=0,e.is_new=!0,e.is_starred=!1,e.star_link="",e.date=new Date,void 0!==e.gif&&Object.keys(e.gif).length<1&&delete e.gif,void 0!==e.video&&e.video.length<1&&delete e.video,void 0!==e.document&&e.document.length<1&&delete e.document,void 0!==e.media&&e.media.length<1&&delete e.media,r.push(e),void 0!==window.Backbone.trigger&&void 0!==e.thread_id&&parseInt(e.thread_id)===parseInt(bb_pusher_vars.current_thread_id)&&window.Backbone.trigger("onReplyReSend",r)},renderAjaxUpdateFailedMessage:function(e){void 0!==window.Backbone.trigger&&void 0!==e.thread_id&&parseInt(e.thread_id)===parseInt(bb_pusher_vars.current_thread_id)&&window.Backbone.trigger("onSentMessageError",e)},updateInboxMessageUnreadCount:function(e){e&&e.forEach(function(e){e.user_id===bb_pusher_vars.alien_hash&&(e.user_id=parseInt(bb_pusher_vars.loggedin_user_id));var r=parseInt(e.inbox_unread_count);parseInt(bb_pusher_vars.current_thread_id)===parseInt(e.thread_id)&&parseInt(bb_pusher_vars.loggedin_user_id)===parseInt(e.user_id)&&(r-=parseInt(e.current_thread_unread_count),g.ajax({type:"POST",url:bb_pusher_vars.ajax_url,data:{action:"bb_pusher_update_current_thread_unread_count",thread_id:e.thread_id,current_user_id:bb_pusher_vars.loggedin_user_id},success:function(){},error:function(){return!1}})),parseInt(bb_pusher_vars.current_thread_id)!==parseInt(e.thread_id)&&(g(document.body).find(".bb-message-dropdown-notification").length&&g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id).length&&(g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id+" span.count").length&&0<r?g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id+" span.count").text(r):g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id+" span.count").length&&0===r?g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id+" span.count").remove():0===g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id+" span.count").length&&0<r&&g(document.body).find(".bb-message-dropdown-notification .bb-member-unread-count-span-"+e.user_id).append('<span class="count">'+r+"</span>")),g(document.body).find(".bp-buddypanel-menu-item-messages-count-"+e.user_id).length)&&0<r&&g(document.body).find(".bp-buddypanel-menu-item-messages-count-"+e.user_id).each(function(){g(this).find(".bb-messages-inbox-unread-count").length?g(this).find(".bb-messages-inbox-unread-count").text(r).removeClass("bp-hide"):g(this).find("> a").append('<span class="count bb-messages-inbox-unread-count">'+r+"</span>")})})},bb_update_header_messages:function(){!g(document.body).find("#header-messages-dropdown-elem").length||bp.Pusher_FrontCommon.xhr||(g(document.body).find("#header-messages-dropdown-elem ul.notification-list").html('<p class="bb-header-loader"><i class="bb-icon-loader animate-spin"></i></p>'),bp.Pusher_FrontCommon.xhr=g.get(ajaxurl,{action:"buddyboss_theme_get_header_unread_messages"},function(e){e.success&&void 0!==e.data&&void 0!==e.data.contents&&g("#header-messages-dropdown-elem ul.notification-list").length&&(g(document.body).find("#header-messages-dropdown-elem ul.notification-list").html(e.data.contents),bp.Pusher_FrontCommon.xhr=!1)}))},json2array:function(r){var s=[];return Object.keys(r).forEach(function(e){s.push(r[e])}),s},arrayIntersect:function(e,r){g(e).filter(r)},createCookie:function(e,r,s){var a,n="";s&&((a=new Date).setTime(a.getTime()+60*s*1e3),n="; expires="+a.toGMTString()),document.cookie=e+"="+r+n+"; path=/"},readCookie:function(e){for(var r=e+"=",s=document.cookie.split(";"),a=s.length,n=0;n<a;n++){for(var t=s[n];" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(r))return t.substring(r.length,t.length)}return null},bbParseParams:function(e){var r,s={};if(e=""===(e+="")?window.location+"":e){if(-1===(e=-1!==e.indexOf("#")?e.substr(0,e.indexOf("#")):e).indexOf("?"))return{};if(""==(e=e.substr(e.indexOf("?")+1,e.length)))return;for(;r=a.exec(e);)!function e(r,s,a){var n,t;-1!==(s+="").indexOf(".")?(n=s.split("."),t=s.split(/\.(.+)?/)[1],r[n[0]]||(r[n[0]]={}),""!==t&&e(r[n[0]],t,a)):-1!==s.indexOf("[")?(s=(n=s.split("["))[0],""==(t=(n=n[1].split("]"))[0])?((r=r||{})[s]&&g.isArray(r[s])||(r[s]=[]),r[s].push(a)):((r=r||{})[s]&&g.isArray(r[s])||(r[s]=[]),r[s][parseInt(t)]=a)):(r=r||{})[s]=a}(s,n(r[1]),n(r[2]))}return s},SHA1:function(e){function r(e,r){return e<<r|e>>>32-r}function s(e){for(var r="",s=7;0<=s;s--)r+=(e>>>4*s&15).toString(16);return r}for(var a,n,t,o,_,d,i,u,b=new Array(80),p=1732584193,h=4023233417,c=2562383102,g=271733878,m=3285377520,v=(e=function(e){e=e.replace(/\r\n/g,"\n");for(var r="",s=0;s<e.length;s++){var a=e.charCodeAt(s);a<128?r+=String.fromCharCode(a):r=127<a&&a<2048?(r+=String.fromCharCode(a>>6|192))+String.fromCharCode(63&a|128):(r=(r+=String.fromCharCode(a>>12|224))+String.fromCharCode(a>>6&63|128))+String.fromCharCode(63&a|128)}return r}(e)).length,l=[],w=0;w<v-3;w+=4)n=e.charCodeAt(w)<<24|e.charCodeAt(w+1)<<16|e.charCodeAt(w+2)<<8|e.charCodeAt(w+3),l.push(n);switch(v%4){case 0:w=2147483648;break;case 1:w=e.charCodeAt(v-1)<<24|8388608;break;case 2:w=e.charCodeAt(v-2)<<24|e.charCodeAt(v-1)<<16|32768;break;case 3:w=e.charCodeAt(v-3)<<24|e.charCodeAt(v-2)<<16|e.charCodeAt(v-1)<<8|128}for(l.push(w);l.length%16!=14;)l.push(0);for(l.push(v>>>29),l.push(v<<3&4294967295),a=0;a<l.length;a+=16){for(w=0;w<16;w++)b[w]=l[a+w];for(w=16;w<=79;w++)b[w]=r(b[w-3]^b[w-8]^b[w-14]^b[w-16],1);for(t=p,o=h,_=c,d=g,i=m,w=0;w<=19;w++)u=r(t,5)+(o&_|~o&d)+i+b[w]+1518500249&4294967295,i=d,d=_,_=r(o,30),o=t,t=u;for(w=20;w<=39;w++)u=r(t,5)+(o^_^d)+i+b[w]+1859775393&4294967295,i=d,d=_,_=r(o,30),o=t,t=u;for(w=40;w<=59;w++)u=r(t,5)+(o&_|o&d|_&d)+i+b[w]+2400959708&4294967295,i=d,d=_,_=r(o,30),o=t,t=u;for(w=60;w<=79;w++)u=r(t,5)+(o^_^d)+i+b[w]+3395469782&4294967295,i=d,d=_,_=r(o,30),o=t,t=u;p=p+t&4294967295,h=h+o&4294967295,c=c+_&4294967295,g=g+d&4294967295,m=m+i&4294967295}return(u=s(p)+s(h)+s(c)+s(g)+s(m)).toLowerCase()},triggerPusherChunked:function(e,r,s){var a=JSON.stringify(s),n=new Blob([a]).size,t=parseInt(bb_pusher_vars.content_size_limit),o=Math.ceil(n/t),_=Math.random();if(1<o)for(var d=1;d<=o;d++)e.trigger(r,{message_chunk_id:_,message_chunk_index:d-1,message_total_chunk:o,message_chunk:a.substr((d-1)*t,t),message_chunk_final:n<=t*d});else e.trigger(r,s)},bindWithPusherChunking:function(e,r,s){e.bind(r,s),e.bind("chunked-"+r,function(e){bp.Pusher_FrontCommon.chunks_event.hasOwnProperty(e.message_chunk_id)||(bp.Pusher_FrontCommon.chunks_event[e.message_chunk_id]={chunks:[]});var r=bp.Pusher_FrontCommon.chunks_event[e.message_chunk_id];r.chunks[e.message_chunk_index]=e.message_chunk,e.message_chunk_final&&r.chunks.length===e.message_total_chunk&&(s(JSON.parse(r.chunks.join(""))),delete bp.Pusher_FrontCommon.chunks_event[e.message_chunk_id])})},getWPCurrentTime:function(){var e=new Date,r=bb_pusher_vars.wp_offset,r=60*(e.getTimezoneOffset()+60*r)*1e3,r=(e.setTime(e.getTime()+r),e.getHours()),e=e.getMinutes(),s=12<=r?bb_pusher_vars.i18n.post_meridiem:bb_pusher_vars.i18n.ante_meridiem;return(r=(r%=12)||12)+":"+(e=e<10?"0"+e:e)+" "+s},removeFailedMessage:function(e){!0===bp.Pusher_FrontCommon.worker_enabled&&bp.bb_pusher_shared.sendMessage("onCancelRemoveMessage",e)}};var a=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};bp.Pusher_FrontCommon.start()}((bp,jQuery));