window.bp=window.bp||{},function(s){bp.Zoom_Common={start:function(){this.setupGlobals(),this.addListeners()},setupGlobals:function(){},addListeners:function(){s(document).on("click","#bp-zoom-check-connection, #bp-zoom-group-check-connection",this.checkConnection.bind(this)),s(document).on("change","#bp-zoom-api-key, #bp-zoom-api-secret, #bp-zoom-api-email, #bp-group-zoom-api-key, #bp-group-zoom-api-secret, #bp-group-zoom-api-email",this.checkApiFields.bind(this)),s(document).on("change","#bp-edit-group-zoom",this.toggleGroupSettings.bind(this)),s(document).on("click",".copy-webhook-link",this.copyWebhookLink.bind(this)),s(document).on("click",".bp-step-nav li > a, .bp-step-actions > span",this.bpStepsNavigate.bind(this)),s(document).on("keyup",".zoom-group-instructions-cloned-input",this.copyInputData.bind(this)),s(document).on("keyup",".zoom-group-instructions-main-input",this.copyMainInputData.bind(this)),s(document).on("click",".bp-zoom-group-show-instructions .save-settings",this.zoomInstructionSave.bind(this)),s(window).on("keyup",this.zoomInstructionNavigate.bind(this)),s(document).find(".bb-group-zoom-settings-container").length&&s(document).on("click","form#group-settings-form button.bb-save-settings",this.zoomSettingsSave.bind(this)),void 0!==jQuery.fn.magnificPopup&&jQuery(".show-zoom-instructions").magnificPopup({type:"inline",midClick:!0})},copyWebhookLink:function(o){var e=s(o.currentTarget),t=e.attr("data-balloon");if(e.closest(".bp-zoom-group-show-instructions").length&&(t=e.attr("data-text")),e.hasClass("copied"))return!1;o.preventDefault();o=document.createElement("textarea");o.value=e.data("webhook-link"),(e.closest(".bp-zoom-group-show-instructions").length?e.closest(".bp-zoom-group-show-instructions")[0]:document.body).appendChild(o),o.select();try{document.execCommand("copy")&&(e.addClass("copied"),e.closest(".bp-zoom-group-show-instructions").length?e.html('<span class="bb-icon-l bb-icon-check"></span> '+e.data("copied")):e.attr("data-balloon",e.data("copied")),setTimeout(function(){e.removeClass("copied")},2e3),setTimeout(function(){e.closest(".bp-zoom-group-show-instructions").length?e.html('<span class="bb-icon-l bb-icon-duplicate"></span> '+t):e.attr("data-balloon",t)},3e3))}catch(o){console.log("Oops, unable to copy")}(e.closest(".bp-zoom-group-show-instructions").length?e.closest(".bp-zoom-group-show-instructions")[0]:document.body).removeChild(o)},checkApiFields:function(o){var e=s("#bp-zoom-api-key").length?s("#bp-zoom-api-key").val():s("#bp-group-zoom-api-key").length?s("#bp-group-zoom-api-key").val():"",t=s("#bp-zoom-api-secret").length?s("#bp-zoom-api-secret").val():s("#bp-group-zoom-api-secret").length?s("#bp-group-zoom-api-secret").val():"",n=s("#bp-zoom-api-email").length?s("#bp-zoom-api-email").val():s("#bp-group-zoom-api-email").length?s("#bp-group-zoom-api-email").val():"";o.preventDefault(),""===e||""===t||""===n?jQuery("#bp-zoom-check-connection, #bp-zoom-group-check-connection").hide():jQuery("#bp-zoom-check-connection, #bp-zoom-group-check-connection").show()},checkConnection:function(o){var e=s("#bp-zoom-api-key").length?s("#bp-zoom-api-key").val():s("#bp-group-zoom-api-key").length?s("#bp-group-zoom-api-key").val():"",t=s("#bp-zoom-api-secret").length?s("#bp-zoom-api-secret").val():s("#bp-group-zoom-api-secret").length?s("#bp-group-zoom-api-secret").val():"",n=s("#bp-zoom-api-email").length?s("#bp-zoom-api-email").val():s("#bp-group-zoom-api-email").length?s("#bp-group-zoom-api-email").val():"";if(o.preventDefault(),""===e||""===t||""===n)return!1;s(document).find("#bp-zoom-group-check-connection").addClass("loading"),s.ajax({type:"GET",url:bpZoomMeetingCommonVars.ajax_url,data:{action:"zoom_api_check_connection",key:e,secret:t,email:n},success:function(o){void 0!==o.data&&o.data.message&&(alert(o.data.message),s(document).find("#bp-zoom-group-check-connection").removeClass("loading"))}})},toggleGroupSettings:function(o){var e=s(o.target),t=e.closest("form").find("#bp-group-zoom-settings");o.preventDefault(),e.is(":checked")?(s("#bp-group-zoom-settings, #bp-zoom-group-show-instructions").removeClass("bp-hide"),s("#bp-group-zoom-settings-additional").removeClass("bp-hide"),s("#bp-zoom-check-connection, #bp-zoom-group-check-connection").show(),t.find("#bp-group-zoom-api-key, #bp-group-zoom-api-secret, #bp-group-zoom-api-email").attr("required",!0)):(s("#bp-group-zoom-settings, #bp-zoom-group-show-instructions").addClass("bp-hide"),s("#bp-group-zoom-settings-additional").addClass("bp-hide"),s("#bp-zoom-check-connection, #bp-zoom-group-check-connection").hide(),t.find("#bp-group-zoom-api-key, #bp-group-zoom-api-secret, #bp-group-zoom-api-email").removeAttr("required"))},bpStepsNavigate:function(o){o.preventDefault();var e,o=s(o.currentTarget),t=(o.closest(".bp-step-nav").length?(o.closest("li").addClass("selected").siblings().removeClass("selected"),o.closest(".bp-step-nav-main").find(".bp-step-block"+o.attr("href")).addClass("selected").siblings().removeClass("selected")):o.closest(".bp-step-actions").length&&(t=o.closest(".bp-step-nav-main").find(".bp-step-block.selected"),e=o.closest(".bp-step-nav-main").find(".bp-step-nav li.selected"),o.hasClass("bp-step-prev")?(t.removeClass("selected").prev().addClass("selected"),e.removeClass("selected").prev().addClass("selected")):o.hasClass("bp-step-next")&&(t.removeClass("selected").next().addClass("selected"),e.removeClass("selected").next().addClass("selected"))),o.closest(".bp-step-nav-main").find(".bp-step-nav li").length);0==o.closest(".bp-step-nav-main").find(".bp-step-nav li.selected").index()?o.closest(".bp-step-nav-main").find(".bp-step-actions .bp-step-prev").hide():o.closest(".bp-step-nav-main").find(".bp-step-actions .bp-step-prev").show(),o.closest(".bp-step-nav-main").find(".bp-step-nav li.selected").index()==t-1?o.closest(".bp-step-nav-main").addClass("last-tab").find(".bp-step-actions .bp-step-next").hide():o.closest(".bp-step-nav-main").removeClass("last-tab").find(".bp-step-actions .bp-step-next").show()},copyInputData:function(o){s(document).find("input[name="+s(o.currentTarget).attr("name").replace("-popup","")+"]").val(s(o.currentTarget).val())},copyMainInputData:function(o){s(document).find("input[name="+s(o.currentTarget).attr("name")+"-popup]").val(s(o.currentTarget).val())},zoomSettingsSave:function(o){""!==s(o.target).closest("form").find("#bp-group-zoom-api-key").val().trim()&&""!==s(o.target).closest("form").find("#bp-group-zoom-api-secret").val().trim()&&""!==s(o.target).closest("form").find("#bp-group-zoom-api-email").val().trim()&&s(o.target).addClass("loading")},zoomInstructionSave:function(){void 0!==jQuery.fn.magnificPopup&&s.magnificPopup.close(),s(document).find("#group-settings-form button.bb-save-settings").trigger("click")},zoomInstructionNavigate:function(o){s(".bp-zoom-group-show-instructions").length&&(39==o.keyCode?s(".bp-zoom-group-show-instructions .bp-step-actions .bp-step-next:visible").trigger("click"):37==o.keyCode&&s(".bp-zoom-group-show-instructions .bp-step-actions .bp-step-prev:visible").trigger("click"))}},bp.Zoom_Common.start()}((bp,jQuery));