window.bp=window.bp||{},function(b){bp.EmotionPicker={start:function(){this.setupGlobals(),this.addListeners()},setupGlobals:function(){this.defaultColor="#000000",this.currentEventHandler=null,this.editorMode="reactionEmotion",this.defaultData={id:"",type:"emotions",name:"",icon:"",icon_color:this.defaultColor,icon_text:"",text_color:this.defaultColor,notification_text:"",icon_path:"",is_active:!0},void 0===this.iconPreviewData&&(this.iconPreviewData=this.defaultData,window.iconPreviewData=this.iconPreviewData),"undefined"==typeof bbProEmojiPreviewTemplate&&(window.bbProEmojiPreviewTemplate=wp.template("buddyboss-emojis-picker-preview")),"undefined"==typeof bbProEmojiSettingTemplate&&(window.bbProEmojiSettingTemplate=wp.template("buddyboss-emoji-picker-setting")),"undefined"==typeof bbProCustomIconPreviewTemplate&&(window.bbProCustomIconPreviewTemplate=wp.template("bbpro-custom-icon-picker-preview")),"undefined"==typeof bbProCustomIconSettingTemplate&&(window.bbProCustomIconSettingTemplate=wp.template("bbpro-custom-icon-picker-setting")),"undefined"==typeof bbProBuddyBossIconPreviewTemplate&&(window.bbProBuddyBossIconPreviewTemplate=wp.template("buddyboss-pro-new-icon-preview")),"undefined"==typeof bbProBuddyBossIconSettingsTemplate&&(window.bbProBuddyBossIconSettingsTemplate=wp.template("buddyboss-pro-new-icon-settings")),"undefined"==typeof bbProAddEmotion&&(window.bbProAddEmotion=wp.template("bb-pro-add-emotion")),"undefined"==typeof bbProIconsCategoryList&&(window.bbProIconsCategoryList=wp.template("buddyboss-icons-category-list")),"undefined"==typeof bbProEmojisCategoryList&&(window.bbProEmojisCategoryList=wp.template("buddyboss-emojis-category-list")),"undefined"==typeof bbProNoResults&&(window.bbProNoResults=wp.template("buddyboss-no-results")),this.emotionTypeFilter(),this.customIconPickerTabs(),this.categoryFilter(),this.handleEmojiSearch(),this.bbIconPreviewSettings(),this.bbEmojiPreviewSettings(),this.customIconPreviewSettings(),this.customIconUpload(),this.deleteCustomIcon(),this.saveSelectedIcon()},addListeners:function(){var o=this;b(document).on("click",".bb_emotions_add_new",function(e){o.openEmotionPickerModal(e)}),b(document).on("click",".bb_emotions_edit",function(e){o.openEmotionPickerModal(e)}),b(document).on("click","button#bbpro_icon_modal_close",function(e){o.closeEmotionPickerModal(e)}),b(document).on("click","#bb-reaction-button-chooser",function(e){o.openEmotionPickerModal(e),o.resetEditorMode("reactionButton")}),this.handleIconColor(),this.handleIconTextColor(),this.handleNotificationText(),this.handleIconText()},resetEditorMode:function(e){this.editorMode=e;var o=b("#bbpro_emotion_modal"),i=o.find(".bbpro-modal-box__header h3"),t=o.find(".bbpro-emotion-type-select-filter"),n=o.find("#bbpro-icon-right-section"),r=o.find("#bbpro-icon-left-section"),a=o.find("#icon-picker-saved"),o=o.find("#bbpro-icons .bbpro-icon-tag-render"),c="reactionButton"===e?"bb-icons":"emotions",s=i.text(),d=a.val();"reactionButton"===e?(e=b("#bb-reaction-button-hidden-field").val(),this.iconPreviewData.icon=e,this.iconPreviewData.type=c,window.iconPreviewData=this.iconPreviewData,void 0!==e&&""!==e?(this.loadBBIconPreviewOnEdit(),(e=document.querySelector("#bbpro-icon-left-section .icons .bbpro-icon.selected"))&&e.scrollIntoView({behavior:"auto"})):t.val(c).trigger("change"),o.find(".bb-icon-rf").toggleClass("bb-icon-r bb-icon-rf"),r.addClass("full-width"),n.hide(),t.hide()):(this.iconPreviewData.icon="",this.iconPreviewData.icon_text="",this.iconPreviewData.type=c,window.iconPreviewData=this.iconPreviewData,t.val(c).trigger("change"),o.find(".bb-icon-r").toggleClass("bb-icon-r bb-icon-rf"),r.removeClass("full-width"),t.show(),n.show()),i.text(i.attr("data-alternate-title")),i.attr("data-alternate-title",s.trim()),a.val(a.attr("data-alternate-title")),a.attr("data-alternate-title",d.trim())},openEmotionPickerModal:function(e){e.preventDefault();var e=b(e.currentTarget),o=(this.currentEventHandler=e).attr("data-type"),i=e.attr("data-icon"),t=null,n="";void 0!==i&&0<i.length?(t=b.parseJSON(i),this.iconPreviewData=t,n=".bbpro-icon","custom"===(o=(window.iconPreviewData=t).type)&&this.saveLocalStorage(o,t)):o=this.iconPreviewData.type;var i=e.parents(".bb_emotions_item").find('input[type="checkbox"]'),e=!0;void 0!==i&&0<i.length&&(e=i.prop("checked")),window.iconPreviewData.isActive=e,this.iconPreviewData=window.iconPreviewData,b(document).find("#bbpro_emotion_modal").css("display","block"),b(document).find("body").addClass("modal-open"),b(".bbpro_select_icon").prop("disabled",!0),o=void 0!==o?o:"emotions",b(".bbpro-emotion-type-select-filter").val(o),b(".bbpro-icon-search-input").val("").trigger("keyup"),null!=t?"emotions"===o?this.loadEmojiPreviewOnEdit():"bb-icons"===o?this.loadBBIconPreviewOnEdit():"custom"===o&&this.loadCustomIconPreviewOnEdit():this.loadDefaultPreviewOnAdd(),""!==n&&null!==(i=document.querySelector("#bbpro-icon-left-section .icons "+n+".selected"))&&i.scrollIntoView({behavior:"auto"}),bp.EmotionPicker.lazyLoad(".lazy-emoji"),b("#bbpro-emojis").on("scroll",function(){bp.EmotionPicker.lazyLoad(".lazy-emoji")})},lazyLoad:function(e){var o=b(e);if(o.length)for(var i=0;i<o.length;i++){var t=!1;(t=!t&&o[i].getBoundingClientRect().top<=(window.innerHeight||document.documentElement.clientHeight)+window.scrollY?!0:t)&&o[i].getAttribute("data-src")&&(o[i].src=o[i].getAttribute("data-src"),o[i].removeAttribute("data-src"),b(o[i]).on("load",function(){b(this).removeClass("lazy")}))}},closeEmotionPickerModal:function(e){e.preventDefault(),b("#bbpro_emotion_modal").css("display","none"),b(document).find("body").removeClass("modal-open"),b(".bbpro-icon-search-input").val("").trigger("keyup"),b(document).find(".bbpro-icon-file-upload").prev().find(".bbpro_icon_preview").find(".inner").hasClass("croppie-container")&&(b(document).find(".bbpro-icon-file-upload").prev().find(".bbpro_icon_preview").hide().find(".inner").show().html(""),b(document).find(".bbpro-icon-file-upload").prev().find(".bbpro_icon_preview").find(".inner").removeClass("croppie-container"),b(document).find(".bbpro_custom_icon_upload").val("")),"reactionButton"===bp.EmotionPicker.editorMode&&bp.EmotionPicker.resetEditorMode("reactionEmotion"),this.deleteLocalStorage("custom"),window.iconPreviewData=this.defaultData,bp.EmotionPicker.resetPreviewSettings()},emotionTypeFilter:function(){var d=this;b(document).on("change",".bbpro-emotion-type-select-filter",function(){var e=b(this),o=b(".bbpro-icon-category-filter-select"),i=b(".bbpro-icon-search"),t=b("#bbpro-icons"),n=b(".bbpro-buddyboss-icon-settings"),r=b("#bbpro-emojis"),a=b(".bbpro-emojis-settings"),c=b("#bbpro-custom-upload"),s=b(".bbpro-custom-upload-settings");switch(b("#bbpro-icon-right-section").show(),b("#bbpro-icon-left-section").removeClass("full-width"),b("#icon-picker-saved").attr("disabled",!0),e.val()){case"bb-icons":o.replaceWith(window.bbProIconsCategoryList()),i.show(),r.addClass("bbpro-hide"),a.addClass("bbpro-hide"),c.addClass("bbpro-hide"),s.addClass("bbpro-hide"),t.removeClass("bbpro-hide"),n.removeClass("bbpro-hide"),b(".bbpro-icon-tag-render").show();break;case"custom":o.hide(),i.hide(),r.addClass("bbpro-hide"),a.addClass("bbpro-hide"),t.addClass("bbpro-hide"),n.addClass("bbpro-hide"),c.removeClass("bbpro-hide"),s.removeClass("bbpro-hide"),(0<c.find(".bbpro-custom-icons-list .bbpro-icon").length?c.find("li.bbpro-tab-uploaded"):(b("#bbpro_emotion_modal").find(".bbpro-tab-uploaded").hide(),c.find("li.bbpro-tab-upload-icon"))).trigger("click");break;default:o.replaceWith(window.bbProEmojisCategoryList()),i.show(),c.addClass("bbpro-hide"),s.addClass("bbpro-hide"),t.addClass("bbpro-hide"),n.addClass("bbpro-hide"),r.removeClass("bbpro-hide"),a.removeClass("bbpro-hide")}o.val("all").trigger("change"),b(".bbpro-icon-search-input").val("").trigger("keyup"),b(".bbpro_select_icon").attr("data-screen",e.val()),d.resetPreviewSettings()})},categoryFilter:function(){var a=this;b(document).on("change",".bbpro-icon-category-filter-select",function(){var e,o=b(this).val(),i=b(".bbpro-emotion-type-select-filter").val(),t=b(".bbpro-icon-search-input").val(),n=b("bb-icons"===i?".bbpro-icon-tag-render":".bbpro-emoji-tag-render"),r="bb-icons"===i?"#bbpro-icons":"#bbpro-emojis";b(r).find(".bb-pro-no-results-screen").remove(),"all"===o&&""===t?n.show():(n.hide(),n="",n=("bb-icons"===i?(e=b('.bbpro-icon-tag-render[data-group="'+o+'"]'),b('.bbpro-icon-tag-render[data-css="'+a.iconPreviewData.name+'" i]')):(e=b('.bbpro-emoji-tag-render[data-group="'+o+'"]'),b('.bbpro-emoji-tag-render[data-name="'+a.iconPreviewData.name+'" i]'))).attr("data-group"),(e="all"!==o?e.filter(function(){return("bb-icons"===i?b(this).attr("data-css"):b(this).attr("data-name")).includes(t)}):b("bb-icons"===i?'.bbpro-icon-tag-render[data-css*="'+t+'" i]':'.bbpro-emoji-tag-render[data-name*="'+t+'" i]')).show(),""!==n&&"all"!==o&&n!==o&&a.resetPreviewSettings(),e.length<=0&&b(r).append(window.bbProNoResults()))})},handleEmojiSearch:function(){b(document).on("keyup",".bbpro-icon-search-input",function(e){e.stopImmediatePropagation();var o,e=b(this).val(),i=b(".bbpro-emotion-type-select-filter").val(),t=b(".bbpro-icon-category-filter-select").val(),n=b("bb-icons"===i?".bbpro-icon-tag-render":".bbpro-emoji-tag-render"),r="bb-icons"===i?"#bbpro-icons":"#bbpro-emojis";if(b(r).find(".bb-pro-no-results-screen").remove(),""===e){if("all"===t)return void n.show();if(n.hide(),"bb-icons"===i&&"all"!==t)return void b('.bbpro-icon-tag-render[data-group="'+t+'"]').show();if("emotions"===i&&"all"!==t)return void b('.bbpro-emoji-tag-render[data-group="'+t+'"]').show()}n.hide(),"bb-icons"===i?o=b('.bbpro-icon-tag-render[data-label-lower*="'+e.toLowerCase()+'"]'):(o=b('.bbpro-emoji-tag-render[data-name*="'+e+'" i]'),bp.EmotionPicker.lazyLoad(".lazy-emoji")),(o="all"!==t?o.filter(function(){return b(this).attr("data-group")===t}):o).show(),o.length<=0&&b(r).append(window.bbProNoResults())})},handleNotificationText:function(){var o=this;b(document).on("keyup",".bbpro-icon-notification-text",function(e){e.stopImmediatePropagation(),o.iconPreviewData.notification_text=b(this).val(),window.iconPreviewData=o.iconPreviewData,b("#icon-picker-saved").attr("disabled",!1)})},handleIconText:function(){var o=this;b(document).on("input",".bbpro-new-icon-label",function(e){e.stopImmediatePropagation();e=b(this).siblings(".bbpro-icon-text-limit");12<b(this).val().length?e.addClass("has-limit-error"):e.removeClass("has-limit-error"),o.iconPreviewData.icon_text=b(this).val(),b(this).siblings(".bbpro-icon-text-limit").children("span").text(o.iconPreviewData.icon_text.length),window.iconPreviewData=o.iconPreviewData,o.updatePreviewTemplate(),b("#icon-picker-saved").attr("disabled",!1)})},customIconUpload:function(){var a=this;b(document).on("change mousemove",".bbpro_icon_preview .croppie-container .cr-slider",function(){var e=b(this).val(),e=Number(100*+e)/1.5,e=parseInt(e)+"%";b(this).closest(".croppie-container").closest(".bbpro_icon_preview").find(".cr-percentage").html(e)}),b(document).on("change",".bbpro_custom_icon_upload",function(){var e=this;a.readImageUpload(e,function(t){b(document).find(".bbpro-icon-file-upload").prev().find(".bbpro_icon_preview").find(".inner").hasClass("croppie-container")&&(b(document).find(".bbpro-icon-file-upload").prev().find(".bbpro_icon_preview").hide().find(".inner").show().html(""),b(document).find(".bbpro-icon-file-upload").prev().find(".bbpro_icon_preview").find(".inner").removeClass("croppie-container"),b(document).find(".bbpro_custom_icon_upload").val(""));var n=b(e).parent().prev(),r=b(n).find(".bbpro_icon_preview"),o=(n.find(".bbpro_icon_preview").show().find(".inner").show().html(""),n.addClass("hasPreview"),r.find(".inner").croppie({viewport:{width:120,height:120},enableExif:!0,boundary:{width:120,height:120},enforceBoundary:!1}));o.croppie("bind",{url:t}).then(function(){b(".bbpro_icon_preview .croppie-container .cr-slider").trigger("change")}),r.find(".done").click(function(e){e.preventDefault();var i=b(this);if(i.hide(),i.parent().find(".loading").show(),i.hasClass("disabled"))return!1;i.addClass("disabled"),o.croppie("result",{type:"blob",size:{height:200,width:200}}).then(function(e){var o=new FormData,e=(o.append("icon",e),o.append("action","bbpro_icon_picker_upload"),o.append("nonce",b("#bbpro-upload-nonce").val()),b.ajax({url:window.bbEmotionsEditor.ajaxurl,type:"POST",data:o,processData:!1,contentType:!1}));e.done(function(e){a.addCustomIcon(e.data),n.find(".inner").hasClass("croppie-container")&&n.find(".inner").removeClass("croppie-container")}),e.fail(function(){try{alert(t.data)}catch(e){alert(window.bbEmotionsEditor.upload_error_notice)}}),e.always(function(){i.removeClass("disabled"),i.show(),i.parent().find(".loading").hide(),r.hide(),n.removeClass("hasPreview")})})})})})},addCustomIcon:function(e){var e=b('<a href="javascript:void(0);" class="bbpro-icon custom" data-value="custom/'+e.id+'"><img src="'+e.url+'" /></a>'),e=(b(document).find("#bbpro-icon-left-section .bbpro-custom-icons-list").append(e),b(".bbpro-tab-upload-icon")),o=b(".bbpro-tab-uploaded"),i=b(".bbpro-tab-upload-icon-content"),t=b(".bbpro-tab-uploaded-content");e.removeClass("current"),i.removeClass("current"),o.addClass("current"),t.addClass("current"),b("#bbpro-icon-right-section").show(),b("#bbpro-icon-left-section").removeClass("full-width"),b("#bbpro_emotion_modal").find(".bbpro-tab-uploaded").show(),b(document).find("#bbpro-icon-left-section .bbpro-custom-icons-list").find("a:last-child").trigger("click")},updatePreviewTemplate:function(e){"custom"===(e=void 0===e?b(document).find(".bbpro-emotion-type-select-filter").val():e)?(b(".bbpro-custom-icon-picker-message-box").hide(),b(".bbpro-custom-icon-picker-preview-box").html(window.bbProCustomIconPreviewTemplate(window.iconPreviewData))):"bb-icons"===e?(b(".bbpro-new-icon-icon-picker-message-box").hide(),b(".bbpro-new-icon-picker-preview-box").html(window.bbProBuddyBossIconPreviewTemplate(window.iconPreviewData))):(b(".bbpro-emoji-picker-message-box").hide(),b(".bbpro-emoji-picker-preview-box").html(window.bbProEmojiPreviewTemplate(window.iconPreviewData))),setTimeout(function(){var e=b("#bbpro-icon-right-section > div:not(.bbpro-hide)"),o=e.find(".bbpro-icon-text-limit");12<e.find(".bbpro-new-icon-label").val().length?o.addClass("has-limit-error"):o.removeClass("has-limit-error")},0)},updateSettingsTemplate:function(e){"custom"===(e=void 0===e?b(document).find(".bbpro-emotion-type-select-filter").val():e)?(b(".bbpro-custom-icon-picker-message-box").hide(),b(".bbpro-custom-icon-picker-settings-box").html(window.bbProCustomIconSettingTemplate(window.iconPreviewData))):"bb-icons"===e?(b(".bbpro-new-icon-icon-picker-message-box").hide(),b(".bbpro-new-icon-picker-settings-box").html(window.bbProBuddyBossIconSettingsTemplate(window.iconPreviewData))):(b(".bbpro-emoji-picker-message-box").hide(),b(".bbpro-emoji-picker-settings-box").html(window.bbProEmojiSettingTemplate(window.iconPreviewData))),bp.EmotionPicker.handleIconColor(),bp.EmotionPicker.handleIconTextColor()},bbIconPreviewSettings:function(){var i=this;b(document).on("click",".bbpro-icon-tag-render",function(){b(".bbpro-icon-tag-render").removeClass("selected"),b(this).addClass("selected"),b("#icon-picker-saved").attr("disabled",!1);var e=b(this).attr("data-css"),o=b(this).attr("data-label");i.iconPreviewData.name=e,i.iconPreviewData.icon=e,i.iconPreviewData.icon_text=o,i.iconPreviewData.type="bb-icons",i.iconPreviewData.notification_text="",i.iconPreviewData.icon_color=i.defaultColor,i.iconPreviewData.text_color=i.defaultColor,window.iconPreviewData=i.iconPreviewData,i.updatePreviewTemplate("bb-icons"),i.updateSettingsTemplate("bb-icons")})},bbEmojiPreviewSettings:function(){var o=this;b(document).on("click",".bbpro-emoji-tag-render",function(){b(".bbpro-emoji-tag-render").removeClass("selected"),b(this).addClass("selected");var e=b(this).attr("data-name");e=(e=e.replace("-"," ")).replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),o.iconPreviewData.name=b(this).attr("data-name"),o.iconPreviewData.icon=b(this).attr("data-unicode"),o.iconPreviewData.icon_path=b(this).find("img").attr("src"),o.iconPreviewData.icon_text=e,o.iconPreviewData.type="emotions",o.iconPreviewData.text_color=o.defaultColor,o.iconPreviewData.notification_text="",window.iconPreviewData=o.iconPreviewData,b("#icon-picker-saved").attr("disabled",!1),o.updatePreviewTemplate("emotions"),o.updateSettingsTemplate("emotions")})},resetPreviewSettings:function(e){"custom"===(e=void 0!==e&&""!==e?e:b(document).find(".bbpro-emotion-type-select-filter").val())&&(b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-custom-icons-list").find(".selected").removeClass("selected"),b(".bbpro-custom-icon-picker-message-box").show(),b("#icon-picker-saved").attr("disabled",!0),b(".bbpro-custom-icon-picker-preview-box").html(""),b(".bbpro-custom-icon-picker-settings-box").html(""),b("#bbpro_emotion_modal ").find(".bbpro-custom-icons-list a.bbpro-icon").length<=0?(b("#bbpro_emotion_modal").find(".bbpro-tab-upload-icon").trigger("click"),b("#bbpro_emotion_modal").find(".bbpro-tab-uploaded").hide()):b("#bbpro_emotion_modal").find(".bbpro-tab-uploaded").show()),"bb-icons"===e&&(b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-icons-list").find(".selected").removeClass("selected"),b(".bbpro-new-icon-icon-picker-message-box").show(),b(".bbpro-new-icon-picker-preview-box").html(""),b(".bbpro-new-icon-picker-settings-box").html("")),"emotions"===e&&(b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .icons").find(".selected").removeClass("selected"),b(".bbpro-emoji-picker-message-box").show(),b(".bbpro-emoji-picker-preview-box").html(""),b(".bbpro-emoji-picker-settings-box").html("")),b("#icon-picker-saved").attr("disabled",!0)},customIconPreviewSettings:function(){var i=this;b(document).on("click",".bbpro-dialog-icon-picker .bbpro-custom-icons-list .bbpro-icon",function(e){e.preventDefault(),b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-custom-icons-list").find(".selected").removeClass("selected"),b(this).addClass("selected");var e=b(this).attr("data-value"),o=i.getLocalStorage("custom");i.iconPreviewData.name=e.replace("custom/",""),i.iconPreviewData.icon=e,i.iconPreviewData.icon_path=b(this).find("img").attr("src"),i.iconPreviewData.type="custom",i.iconPreviewData.icon_text=o&&void 0!==o.icon_text?o.icon_text:"",i.iconPreviewData.notification_text="",i.iconPreviewData.text_color=o&&void 0!==o.text_color?o.text_color:i.defaultColor,window.iconPreviewData=i.iconPreviewData,b("#icon-picker-saved").attr("disabled",!1),i.updatePreviewTemplate("custom"),i.updateSettingsTemplate("custom")})},deleteCustomIcon:function(){b(document).on("click",".bbpro-delete-icon",function(e){e.preventDefault();var o,i,t,n,r,a,e=!1;(e="undefined"!==window.showNotice?window.showNotice.warn():e)&&(o=b(this),e=(i=b(".bbpro-dialog-icon-picker").find(".bbpro-custom-icons-list").find(".selected")).attr("data-value"),t=b(".bbpro-custom-icon-picker-message-box"),n=t.html(),!0===i.hasClass("custom"))&&(void(r=0)!==window.iconPreviewData&&void 0!==window.iconPreviewData.id&&(r=window.iconPreviewData.id),(a=new FormData).append("action","bbpro_delete_custom_icon"),a.append("elm1_data_val",e),a.append("task","delete_custom_icon"),a.append("id",r),a.append("nonce",b("#bbpro-delete-nonce").val()),b.ajax({url:window.window.bbEmotionsEditor.ajaxurl,type:"POST",data:a,processData:!1,contentType:!1,beforeSend:function(){o.show().addClass("disabled").prop("diabled",!0),o.find(".bbpro-delete-icon-loader").show()},error:function(e){t.html('<p class="bbpro_notice bb-reaction-error"><i class = "bb-icon-f bb-icon-info-triangle" ></i>'+e.statusText+"</p>"),t.show(),setTimeout(function(){t.html(n),t.hide(),o.show().removeClass("disabled").prop("disabled",!1).find(".bbpro-delete-icon-loader").hide()},1e4)},success:function(e){!0===e.success?(i.remove(),bp.EmotionPicker.resetPreviewSettings("custom")):(t.html('<p class="bbpro_notice bb-reaction-error"><i class = "bb-icon-f bb-icon-info-triangle" ></i>'+e.data+"</p>"),t.show()),setTimeout(function(){t.html(n),t.hide(),o.show().removeClass("disabled").prop("disabled",!1).find(".bbpro-delete-icon-loader").hide()},5e3)}}))})},saveSelectedIcon:function(){var t=this;b(document).on("click",".bbpro_select_icon",function(){var e,o,i;"reactionButton"===t.editorMode?(b("#bb-reaction-button-hidden-field").val(t.iconPreviewData.icon),b("#bb-reaction-button-chooser").html('<i class="bb-icon-'+t.iconPreviewData.icon+'"></i>'),t.resetEditorMode("reactionEmotion"),b("#bbpro_emotion_modal").css("display","none"),b(document).find("body").removeClass("modal-open")):(e=b(".bbpro-emotion-type-select-filter").val(),o=".bbpro-emoji-picker-message-box",i="","custom"===e?o=".bbpro-custom-icon-picker-message-box":"bb-icons"===e&&(o=".bbpro-new-icon-icon-picker-message-box"),void 0===t.iconPreviewData?i=window.bbEmotionsEditor.no_data_found:""===t.iconPreviewData.icon_text?i=window.bbEmotionsEditor.icon_label_required:12<t.iconPreviewData.icon_text.length&&(i=window.bbEmotionsEditor.icon_label__length),""!==i?(b(document).find(o).show(),b(document).find(o).html('<p class="bbpro_notice bb-reaction-error"><i class = "bb-icon-f bb-icon-info-triangle" ></i>'+i+"</p>"),setTimeout(function(){b(document).find(o).html(""),b(document).find(o).hide()},1e4)):(b("#bbpro_emotion_modal").css("display","none"),b(document).find("body").removeClass("modal-open"),null!==t.currentEventHandler&&t.currentEventHandler.parents(".bb_emotions_item").replaceWith(window.bbProAddEmotion(t.iconPreviewData)),t.deleteLocalStorage(e),window.iconPreviewData=t.defaultData,b(document).trigger("bbpro-icon-selected",t.iconPreviewData)))})},handleIconColor:function(){b(document).find(".bbpro-icon-color").wpColorPicker({defaultColor:bp.EmotionPicker.defaultColor,change:function(e,o){bp.EmotionPicker.iconPreviewData.icon_color=o.color.toString(),window.iconPreviewData=bp.EmotionPicker.iconPreviewData,bp.EmotionPicker.updatePreviewTemplate("bb-icons"),b("#icon-picker-saved").attr("disabled",!1)},clear:function(){bp.EmotionPicker.iconPreviewData.icon_color=bp.EmotionPicker.defaultColor,window.iconPreviewData=bp.EmotionPicker.iconPreviewData,bp.EmotionPicker.updatePreviewTemplate("bb-icons"),b("#icon-picker-saved").attr("disabled",!1)},palettes:["#8D8D92","#EA4D3D","#EA445A","#F19937","#65C465","#58A7D7","#3379F6","#5756CE"]})},handleIconTextColor:function(){var i=this;b(".bbpro-icon-text-color").wpColorPicker({defaultColor:bp.EmotionPicker.defaultColor,change:function(e,o){i.iconPreviewData.text_color=o.color.toString(),window.iconPreviewData=i.iconPreviewData,bp.EmotionPicker.updatePreviewTemplate(),b("#icon-picker-saved").attr("disabled",!1)},clear:function(){i.iconPreviewData.text_color=i.defaultColor,window.iconPreviewData=i.iconPreviewData,bp.EmotionPicker.updatePreviewTemplate(),b("#icon-picker-saved").attr("disabled",!1)},palettes:["#8D8D92","#EA4D3D","#EA445A","#F19937","#65C465","#58A7D7","#3379F6","#5756CE"]})},loadBBIconPreviewOnEdit:function(){b(".bbpro-emotion-type-select-filter").val("bb-icons"),b(".bbpro-emojis-list").addClass("bbpro-hide"),b(".bbpro-emojis-settings").addClass("bbpro-hide"),b("#bbpro-custom-upload").addClass("bbpro-hide"),b(".bbpro-custom-upload-settings").addClass("bbpro-hide"),b(".bbpro-icons-list").removeClass("bbpro-hide"),b(".bbpro-buddyboss-icon-settings").removeClass("bbpro-hide"),b(".bbpro-icon-category-filter-select").show(),b(".bbpro-icon-search").show(),b(".bbpro-icon-category-filter-select").replaceWith(window.bbProIconsCategoryList()),b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-icons-list").find("a").hasClass("selected")&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-icons-list").find(".selected").removeClass("selected"),0<b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-icons-list").find('a[data-css="'+window.iconPreviewData.icon+'"]').length&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-icons-list").find('a[data-css="'+window.iconPreviewData.icon+'"]').addClass("selected"),this.updatePreviewTemplate("bb-icons"),this.updateSettingsTemplate("bb-icons")},loadEmojiPreviewOnEdit:function(){b(".bbpro-emotion-type-select-filter").val("emotions"),b(".bbpro-icons-list").addClass("bbpro-hide"),b(".bbpro-buddyboss-icon-settings").addClass("bbpro-hide"),b("#bbpro-custom-upload").addClass("bbpro-hide"),b(".bbpro-custom-upload-settings").addClass("bbpro-hide"),b(".bbpro-emojis-list").removeClass("bbpro-hide"),b(".bbpro-emojis-settings").removeClass("bbpro-hide"),b(".bbpro-icon-search").show();var e=b(".bbpro-icon-category-filter-select");e.show(),e.replaceWith(window.bbProEmojisCategoryList()),b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-emojis-list").find("a").hasClass("selected")&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-emojis-list").find(".selected").removeClass("selected"),0<b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-emojis-list").find('a[data-name="'+window.iconPreviewData.name+'"]').length&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-emojis-list").find('a[data-name="'+window.iconPreviewData.name+'"]').addClass("selected"),this.updatePreviewTemplate("emotions"),this.updateSettingsTemplate("emotions")},loadCustomIconPreviewOnEdit:function(){b(".bbpro-emojis-list").addClass("bbpro-hide"),b(".bbpro-emojis-settings").addClass("bbpro-hide"),b(".bbpro-icons-list").addClass("bbpro-hide"),b(".bbpro-buddyboss-icon-settings").addClass("bbpro-hide"),b("#bbpro-custom-upload").removeClass("bbpro-hide"),b(".bbpro-custom-upload-settings").removeClass("bbpro-hide"),b(".bbpro-icon-category-filter-select").hide(),b(".bbpro-icon-search").hide(),b("#bbpro_emotion_modal li.bbpro-tab-uploaded").trigger("click"),b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-custom-icons-list").find("a").hasClass("selected")&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-custom-icons-list").find(".selected").removeClass("selected"),0<b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-custom-icons-list").find('a[data-value="custom/'+window.iconPreviewData.name+'"]').length&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-custom-icons-list").find('a[data-value="custom/'+window.iconPreviewData.name+'"]').addClass("selected"),this.updatePreviewTemplate("custom"),this.updateSettingsTemplate("custom")},customIconPickerTabs:function(){b(document).on("click","li.bbpro-tab-uploaded",function(e){e.preventDefault();e=b(this).attr("data-tab");b("#bbpro_emotion_modal li.bbpro-tab-upload-icon").removeClass("current"),b("#bbpro-tab-upload-icon").removeClass("current"),b(this).addClass("current"),b("#"+e).addClass("current"),b("#bbpro-icon-right-section").show(),b("#bbpro-icon-left-section").removeClass("full-width"),b(".bbpro_select_icon").attr("data-screen","custom")}),b(document).on("click","li.bbpro-tab-upload-icon",function(e){e.preventDefault();e=b(this).attr("data-tab");b("#bbpro_emotion_modal li.bbpro-tab-uploaded").removeClass("current"),b("#bbpro-tab-uploaded").removeClass("current"),b(this).addClass("current"),b("#"+e).addClass("current"),b("#bbpro-icon-right-section").hide(),b("#bbpro-icon-left-section").addClass("full-width"),b(".bbpro_select_icon").attr("disabled",!0)})},readImageUpload:function(o,n){var e,i=b(o).closest(".upload_field");if(o.files&&o.files[0]){const t=o.files[0],r=t.size,a=["image/png"],c=t.type;return a.indexOf(c)<=-1?(alert(window.bbEmotionsEditor.invalid_upload_notice),""!==i.find(".bbpro_upload_preview").attr("src")&&void 0!==i.find(".bbpro_upload_preview").attr("src")&&(i.find(".delete").show(),i.find(".replace").show()),!1):409600<r?(alert(window.bbEmotionsEditor.max_upload_size_notice),""!==i.find(".bbpro_upload_preview").attr("src")&&void 0!==i.find(".bbpro_upload_preview").attr("src")&&(i.find(".delete").show(),i.find(".replace").show()),!1):((e=new FileReader).onload=function(i){var e=window.URL||window.webkitURL;const t=new Image;t.onload=function(){var e,o;"image/svg+xml"===c?(o=(e=document.createElement("canvas")).getContext("2d"),t.width<100&&t.height<100?(e.width=300,e.height=300):(e.width=t.width,e.height=t.height),o.drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height),n(e.toDataURL("image/png"),{width:e.width,height:e.height})):n(i.target.result,{width:this.width,height:this.height})},t.src=e.createObjectURL(o.files[0])},void e.readAsDataURL(o.files[0]))}""!==i.find(".bbpro_upload_preview").attr("src")&&void 0!==i.find(".bbpro_upload_preview").attr("src")&&(i.find(".delete").show(),i.find(".replace").show())},loadDefaultPreviewOnAdd:function(){b(".bbpro-emotion-type-select-filter").val("emotions"),b(".bbpro-icons-list").addClass("bbpro-hide"),b(".bbpro-buddyboss-icon-settings").addClass("bbpro-hide"),b("#bbpro-custom-upload").addClass("bbpro-hide"),b(".bbpro-custom-upload-settings").addClass("bbpro-hide"),b(".bbpro-emojis-list").removeClass("bbpro-hide"),b(".bbpro-emojis-settings").removeClass("bbpro-hide"),b(".bbpro-icon-search").show();var e=b(".bbpro-icon-category-filter-select");e.show(),e.replaceWith(window.bbProEmojisCategoryList()),b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-emojis-list").find("a").hasClass("selected")&&b(document).find("#bbpro_emotion_modal #bbpro-icon-left-section .bbpro-emojis-list").find(".selected").removeClass("selected")},saveLocalStorage:function(e,o){localStorage.setItem(e,JSON.stringify(o))},getLocalStorage:function(e){e=localStorage.getItem(e);return JSON.parse(e)},deleteLocalStorage:function(e){localStorage.removeItem(e)}},bp.EmotionPicker.start()}((bp,jQuery));