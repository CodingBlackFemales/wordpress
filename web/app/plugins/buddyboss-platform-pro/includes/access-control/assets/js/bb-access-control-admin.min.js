window.bp=window.bp||{},function(a){bp.Access_Control_Admin={start:function(){this.setupGlobals(),this.addListeners()},setupGlobals:function(){},addListeners:function(){a(document).on("change",".access-control-select-box",this.showAccessControlSelect.bind(this)),a(document).on("change",".access-control-plugin-select-box",this.showPluginAccessControlSelect.bind(this)),a(document).on("change",".access-control-gamipress-select-box",this.showGamiPressAccessControlSelect.bind(this)),a(document).on("change",'.access-control-checkbox-list .parent input[type="checkbox"]',this.enableDisableOptions.bind(this)),a(document).on("change",".chb",this.enableDisableOptionsAllOrSpecific.bind(this)),a(document).on("change",".access-control-threaded-input",this.showHideChildDiv.bind(this)),a(window).on("load",this.changeNotices.bind(this)),a(document).on("change","input#bp_restrict_group_creation",this.group_creation_restrict.bind(this)),a(document).on("change","input#bp_media_profile_media_support, input#bp_media_messages_media_support, input#bp_media_forums_media_support",this.upload_photo_restrict.bind(this)),a(document).on("change","input#bp_video_profile_video_support, input#bp_video_messages_video_support, input#bp_video_forums_video_support",this.upload_video_restrict.bind(this)),a(document).on("change","input#bp_media_profile_document_support, input#bp_media_messages_document_support, input#bp_media_forums_document_support",this.upload_document_restrict.bind(this))},showHideChildDiv:function(e){var e=e.currentTarget,s=a(e).data("id"),c=a(e).closest(".parent."+s).next(".access-control-checkbox-list.child-"+s).find(".multiple_options"),t=a(e).closest(".parent."+s).next(".access-control-checkbox-list").find('input[type="checkbox"]'),o=a(e).closest(".parent."+s).next(".access-control-checkbox-list.child-"+s),s=a(e).closest(".parent."+s).next(".access-control-checkbox-list.child-"+s).find(".sub-child-"+s);a(e).prop("checked")?(c.children('input[data-value="all"]').trigger("click"),t.removeProp("disabled"),o.removeClass("access-control-hide-div"),o.children('input[data-value="all"]').trigger("click")):(c.children('input[data-value="all"]').trigger("click"),t.prop("disabled","disabled"),t.removeProp("checked"),s.addClass("access-control-hide-div"),o.addClass("access-control-hide-div")),bp.Access_Control_Admin.changeNotices()},enableDisableOptionsAllOrSpecific:function(e){var e=e.currentTarget,s=a(e).data("value"),c=a(e).data("id"),t=a(e).closest(".access-control-checkbox-list.child-"+c).find(".sub-child-"+c),c=a(e).closest(".access-control-checkbox-list.child-"+c).find(".sub-child-"+c+' input[type="checkbox"]');"specific"===s?t.length&&(c.attr("disabled",!1),t.parent().removeClass("access-control-hide-div"),t.removeClass("access-control-hide-div")):(c.prop("checked",!1),t.length&&(t.parent().addClass("access-control-hide-div"),t.addClass("access-control-hide-div"))),a(e).siblings(".chb").prop("checked",!1),a(e).prop("checked",!0)},showPluginAccessControlSelect:function(e){var s=e.currentTarget,e=a(s).val(),c=a(s).data("id"),t=a(s).hasClass("display-threaded"),o=a(s).data("label"),i=a(s).data("sub-label"),l=a(s).data("component-settings");""===e?a(s).siblings(".access-control-checkbox-list").html(""):a(s).hasClass("loading")||(a(s).addClass("loading"),a('<div class="loader-repair-tools" style="vertical-align: middle"></div>').insertAfter(s),a.ajax({type:"POST",url:bbAccessControlAdminVars.ajax_url,data:{action:"plugin_get_access_control_level_options",value:e,key:c,threaded:t,label:o,sub_label:i,component_settings:l},success:function(e){a(s).siblings(".loader-repair-tools").remove(),a(s).removeClass("loading"),void 0!==e.data&&e.data.message?(a(s).siblings(".access-control-checkbox-list").html(""),a(s).siblings(".access-control-checkbox-list").html(e.data.message),a(s).siblings(".access-control-checkbox-list").find('.access-control-checkbox-list input[type="checkbox"]').prop("disabled","disabled"),bp.Access_Control_Admin.changeNotices()):a(s).siblings(".access-control-checkbox-list").html("")},error:function(){a(s).removeClass("loading"),a(s).siblings(".loader-repair-tools").remove()}}))},showGamiPressAccessControlSelect:function(e){var s=e.currentTarget,e=a(s).val(),c=a(s).data("id"),t=a(s).hasClass("display-threaded"),o=a(s).data("label"),i=a(s).data("sub-label"),l=a(s).data("component-settings");""===e?a(s).siblings(".access-control-checkbox-list").html(""):a(s).hasClass("loading")||(a(s).addClass("loading"),a('<div class="loader-repair-tools" style="vertical-align: middle"></div>').insertAfter(s),a.ajax({type:"POST",url:bbAccessControlAdminVars.ajax_url,data:{action:"gamipress_get_access_control_level_options",value:e,key:c,threaded:t,label:o,sub_label:i,component_settings:l},success:function(e){a(s).siblings(".loader-repair-tools").remove(),a(s).removeClass("loading"),void 0!==e.data&&e.data.message?(a(s).siblings(".access-control-checkbox-list").html(""),a(s).siblings(".access-control-checkbox-list").html(e.data.message),a(s).siblings(".access-control-checkbox-list").find('.access-control-checkbox-list input[type="checkbox"]').prop("disabled","disabled"),bp.Access_Control_Admin.changeNotices()):a(s).siblings(".access-control-checkbox-list").html("")},error:function(){a(s).removeClass("loading"),a(s).siblings(".loader-repair-tools").remove()}}))},showAccessControlSelect:function(e){var s,c=e.currentTarget,e=a(c).val(),t=a(c).hasClass("display-threaded"),o=a(c).data("label"),i=a(c).data("sub-label"),l=a(c).data("component-settings");""===e?(a(c).siblings(".access-control-plugin-select-box").addClass("hidden"),a(c).siblings(".access-control-gamipress-select-box").addClass("hidden"),a(c).siblings(".access-control-checkbox-list").html("")):a(c).hasClass("loading")||(a(c).addClass("loading"),a(c).siblings(".access-control-gamipress-select-box").prop("selectedIndex",0),a(c).siblings(".access-control-plugin-select-box").prop("selectedIndex",0),s=a(c).attr("id"),"membership"===e?(a(c).siblings(".access-control-gamipress-select-box").addClass("hidden"),a(c).removeClass("loading").siblings(".access-control-plugin-select-box").removeClass("hidden"),a(c).siblings(".select-before-label").removeClass("hidden"),a(c).siblings(".select-after-label").removeClass("hidden"),a(c).siblings(".access-control-checkbox-list").html("")):"gamipress"===e?(a(c).siblings(".access-control-plugin-select-box").addClass("hidden"),a(c).siblings(".select-before-label").addClass("hidden"),a(c).siblings(".select-after-label").addClass("hidden"),a(c).removeClass("loading").siblings(".access-control-gamipress-select-box").removeClass("hidden"),a(c).siblings(".access-control-checkbox-list").html("")):(a(c).siblings(".access-control-plugin-select-box").addClass("hidden"),a(c).siblings(".select-before-label").addClass("hidden"),a(c).siblings(".select-after-label").addClass("hidden"),a(c).siblings(".access-control-gamipress-select-box").addClass("hidden"),a('<div class="loader-repair-tools" style="vertical-align: middle"></div>').insertAfter(c),a.ajax({type:"POST",url:bbAccessControlAdminVars.ajax_url,data:{action:"get_access_control_level_options",value:e,key:s,threaded:t,label:o,sub_label:i,component_settings:l},success:function(e){a(c).siblings(".loader-repair-tools").remove(),void 0!==e.data&&e.data.message?(a(c).siblings(".access-control-checkbox-list").html(""),a(c).siblings(".access-control-checkbox-list").html(e.data.message),a(c).siblings(".access-control-checkbox-list").find('.access-control-checkbox-list input[type="checkbox"]').prop("disabled","disabled"),bp.Access_Control_Admin.changeNotices()):a(c).siblings(".access-control-checkbox-list").html(""),a(c).removeClass("loading")},error:function(){a(c).removeClass("loading"),a(c).siblings(".loader-repair-tools").remove()}})))},enableDisableOptions:function(e){var e=e.currentTarget,s=a(e).closest(".parent").next(".access-control-checkbox-list").find('input[type="checkbox"]');a(e).prop("checked")?s.removeProp("disabled"):(s.prop("disabled","disabled"),s.removeProp("checked"))},changeNotices:function(){var e,s,c;a(".access-control-checkbox-list .access-control-checkbox-list .description").length&&(e=a(".access-control-select-box").val(),c="",c="membership"===e?(s=a(".access-control-select-box option:selected").text(),a(".access-control-plugin-select-box option[value="+a(".access-control-plugin-select-box").val()+"]").text()+" "+s):a("gamipress"===e?".access-control-gamipress-select-box option[value="+a(".access-control-gamipress-select-box").val()+"]":".access-control-select-box option[value="+a(".access-control-select-box").val()+"]").text(),a(".access-control-checkbox-list .access-control-checkbox-list .description").each(function(){var e=a(this).text(),e=bp.Access_Control_Admin.replaceAll(e,"{{select_value}}",c),e=(a(this).text(e),a(this).parent().prev(".parent").children("label").text()),e=a(this).text().replace("{{option_value}}","<strong>"+e+"</strong>");a(this).html(e)}))},replaceAll:function(e,s,c){s=s.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");return e.replace(new RegExp(s,"g"),c)},group_creation_restrict:function(e){a(e.currentTarget).prop("checked")?(a("#group_access_control_block tr:first-child td .bp-messages-feedback").hide(),a("#group_access_control_block tr:first-child td select:disabled").prop("disabled",!1),a("#group_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!1)):(a("#group_access_control_block tr:first-child td .bp-messages-feedback").show(),a("#group_access_control_block tr:first-child td select:visible").prop("disabled",!0),a("#group_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!0))},upload_photo_restrict:function(){1<=a("input#bp_media_profile_media_support:checked, input#bp_media_messages_media_support:checked, input#bp_media_forums_media_support:checked").length?(a("#media_access_control_block tr:first-child td .bp-messages-feedback").hide(),a("#media_access_control_block tr:first-child td select:visible").prop("disabled",!1),a("#media_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!1)):0===a("input#bp_media_profile_media_support:checked, input#bp_media_messages_media_support:checked, input#bp_media_forums_media_support:checked").length&&(a("#media_access_control_block tr:first-child td .bp-messages-feedback").show(),a("#media_access_control_block tr:first-child td select:visible").prop("disabled",!0),a("#media_access_control_block tr:first-child td .access-control-checkbox-list input").prop("disabled",!0))},upload_document_restrict:function(){1<=a("input#bp_media_profile_document_support:checked, input#bp_media_messages_document_support:checked, input#bp_media_forums_document_support:checked").length?(a("#media_access_control_block tr:nth-child(2) td .bp-messages-feedback").hide(),a("#media_access_control_block tr:nth-child(2) td select:visible").prop("disabled",!1),a("#media_access_control_block tr:nth-child(2) td .access-control-checkbox-list input").prop("disabled",!1)):0===a("input#bp_media_profile_document_support:checked, input#bp_media_messages_document_support:checked, input#bp_media_forums_document_support:checked").length&&(a("#media_access_control_block tr:nth-child(2) td .bp-messages-feedback").show(),a("#media_access_control_block tr:nth-child(2) td select:visible").prop("disabled",!0),a("#media_access_control_block tr:nth-child(2) td .access-control-checkbox-list input").prop("disabled",!0))},upload_video_restrict:function(){1<=a("input#bp_video_profile_video_support:checked, input#bp_video_messages_video_support:checked, input#bp_video_forums_video_support:checked").length?(a("#media_access_control_block tr:nth-child(3) td .bp-messages-feedback").hide(),a("#media_access_control_block tr:nth-child(3) td select:visible").prop("disabled",!1),a("#media_access_control_block tr:nth-child(3) td .access-control-checkbox-list input").prop("disabled",!1)):0===a("input#bp_video_profile_video_support:checked, input#bp_video_messages_video_support:checked, input#bp_video_forums_video_support:checked").length&&(a("#media_access_control_block tr:nth-child(3) td .bp-messages-feedback").show(),a("#media_access_control_block tr:nth-child(3) td select:visible").prop("disabled",!0),a("#media_access_control_block tr:nth-child(3) td .access-control-checkbox-list input").prop("disabled",!0))}},bp.Access_Control_Admin.start()}((bp,jQuery));