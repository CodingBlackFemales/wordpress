/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
!function(d){"use strict";window.BBLMS={init:function(){this.switchLdGridList(),this.toggleTheme(),this.learnDashSidePanel(),this.lms_user_profile_js(),this.lms_single_course(),this.course_archive_js(),this.quizDetails(),this.quizUpload(),this.setElementorSpacing(),this.courseViewCookie(),this.bbStickyLdSidebar(),this.singleLesson(),this.singleTopic(),this.singleQuiz(),this.showMoreParticipants(),this.inforBarStatus()},switchLdGridList:function(){var t=d(".bb-course-items:not(.is-cover)");if(window.sessionStorage){var e=sessionStorage.getItem("course-view");null==e&&(sessionStorage.setItem("course-view","grid"),e=sessionStorage.getItem("course-view")),d(".layout-view-course").removeClass("active"),t.removeClass("grid-view"),t.removeClass("bb-grid"),t.removeClass("list-view"),t.removeClass("bb-list"),"grid"===e?(d(".layout-view-course.layout-grid-view").addClass("active"),t.addClass("grid-view"),t.addClass("bb-grid")):(d(".layout-view-course.layout-list-view").addClass("active"),t.addClass("list-view"),t.addClass("bb-list"))}d(document).on("click",".grid-filters .layout-view-course",function(e){e.preventDefault(),t=d(e.target).closest("form").find(".bb-course-items:not(.is-cover)"),d(this).hasClass("layout-list-view")?(window.sessionStorage&&sessionStorage.setItem("course-view","list"),d(".layout-view-course").removeClass("active"),t.removeClass("grid-view"),t.removeClass("bb-grid"),t.removeClass("list-view"),t.removeClass("bb-list"),d(".layout-view-course.layout-list-view").addClass("active"),t.addClass("list-view"),t.addClass("bb-list"),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_save_view&option=bb_theme_learndash_grid_list&type=list",success:function(e){}})):(window.sessionStorage&&sessionStorage.setItem("course-view","grid"),d(".layout-view-course").removeClass("active"),t.removeClass("grid-view"),t.removeClass("bb-grid"),t.removeClass("list-view"),t.removeClass("bb-list"),d(".layout-view-course.layout-grid-view").addClass("active"),t.addClass("grid-view"),t.addClass("bb-grid"),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_save_view&option=bb_theme_learndash_grid_list&type=grid",success:function(e){}}))})},showMoreParticipants:function(){var e=d(".lms-course-members-list .lms-course-sidebar-heading .lms-count").text(),t=2,s=d(".lms-course-members-list #buddyboss_theme_learndash_course_participants_course_id").val(),a=d(".lms-course-members-list .bb-course-member-wrap .lme-more i"),i=d(".lms-course-members-list .bb-course-member-wrap .lme-more");d(".lms-course-members-list").on("click",".bb-course-member-wrap .lme-more",function(){d(this).hasClass("loading-members")||(d(this).addClass("loading-members"),a.removeClass("bb-icon-angle-down"),a.addClass("bb-icon-spin"),a.addClass("animate-spin"),d(".lms-course-members-list .bb-course-member-wrap .lme-less").hide(),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_get_course_participants&_wpnonce="+bs_data.learndash.nonce_get_courses+"&total="+e+"&page="+t+"&course="+s,success:function(e){d(".lms-course-members-list .bb-course-member-wrap .course-members-list.course-members-list-extra").show(),d(".lms-course-members-list .bb-course-member-wrap .course-members-list-extra").append(e.data.html),d(window).trigger("resize"),"false"===e.data.show_more&&d(".lms-course-members-list .bb-course-member-wrap .lme-more").remove(),t=e.data.page,0===d(".ld-sidebar-widgets").length&&d(".lms-topic-sidebar-wrapper .lms-topic-sidebar-data").animate({scrollTop:d(document).height()},1e3),a.addClass("bb-icon-angle-down"),a.removeClass("bb-icon-spin"),a.removeClass("animate-spin"),i.removeClass("loading-members")}}))})},fetchCourses:function(e){var a=d("#bb-courses-directory-form");void 0!==e&&0<d(e).length&&(a=d(e).closest("form.bb-courses-directory"));for(var t=!1,s=["filter-categories","filter-instructors","search"],i=0;i<s.length;i++){var o=BBGetUrlParameter(window.location.search,s[i]),r=a.find('[name="'+s[i]+'"]').val();if(o!==r)switch(s[i]){case"filter-categories":case"filter-instructors":!o&&"all"===r||(t=!0);break;default:t=!0}if(t)break}t&&a.find('[name="current_page"]').val(1);var n=a.serialize(),l=bs_data.learndash.course_archive_url;a.hasClass("bb-elementor-widget")&&(l=a.data("current_page_url"));var c="grid";return a.find(".layout-list-view").hasClass("active")&&(c="list"),n+="&view="+c+"&request_url="+encodeURIComponent(l),d.ajax({method:"GET",url:bs_data.ajaxurl,data:n+"&action=buddyboss_lms_get_courses&_wpnonce="+bs_data.learndash.nonce_get_courses,success:function(e){var t=a.find('[name="current_page"]').val();if(isNaN(t)&&(t=1),1<t&&(l+="page/"+t+"/"),l+="?"+n,window.history.pushState({bblms_has_changes:!0,courses_html:e.data.html,type:a.find('[name="type"]').val()},"",l),a.find(".bs-dir-list").html(e.data.html),a.find("li.selected a span").text(e.data.count),e.data.scopes)for(var s in e.data.scopes)a.find("li#courses-"+s+" a span").text(e.data.scopes[s]).show();d(".courses-nav").find(".bb-icon-loader").remove()}}),!1},fetchCoursesPagination:function(e){var a=d("#bb-courses-directory-form");void 0!==e&&0<d(e).length&&(a=d(e).closest("form.bb-courses-directory"));var i=a.serialize(),o=a.attr("action");a.hasClass("bb-elementor-widget")&&(o=a.data("current_page_url")),""===o&&(o=bs_data.learndash.course_archive_url);var t="list";a.find(".layout-grid-view").hasClass("active")&&(t="grid"),i+="&view="+t+"&request_url="+encodeURIComponent(o);var s=a.data("order");void 0!==s&&!1!==s&&(i=i+"&order="+s);var r=a.data("orderby");return void 0!==r&&!1!==r&&(i=i+"&orderby="+r),d.ajax({method:"GET",url:bs_data.ajaxurl,data:i+"&action=buddyboss_lms_get_courses&_wpnonce="+bs_data.learndash.nonce_get_courses,success:function(e){var t=a.find('[name="current_page"]').val();if(isNaN(t)&&(t=1),"/"!==o.substr(-1)&&(o+="/"),1<t&&(o+="page/"+t+"/"),o+="?"+i,window.history.pushState({bblms_has_changes:!0,courses_html:e.data.html,type:a.find('[name="type"]').val()},"",o),a.find(".bs-dir-list").html(e.data.html),a.find("li.selected a span").text(e.data.count),e.data.scopes)for(var s in e.data.scopes)a.find("li#courses-"+s+" a span").text(e.data.scopes[s]).show();d(".courses-nav").find(".bb-icon-loader").remove()}}),!1},course_archive_js:function(){d(document).on("change","#bb-courses-directory-form input[type=checkbox]",function(e){e.preventDefault(),window.BBLMS.fetchCourses()}),window.onpopstate=function(e){if(e.state&&(!!e.state.hasOwnProperty("bblms_has_changes")&&e.state.bblms_has_changes)){var t=d("#bb-courses-directory-form");t.find(".bs-dir-list").html(e.state.courses_html),t.find('[name="type"]').val(e.state.type),t.find(".component-navigation > li").each(function(){d(this).removeClass("selected"),BBGetUrlParameter(d(this).find(" > a").attr("href"),"type")===e.state.type&&d(this).addClass("selected")})}},d(document).on("click","#bb-course-list-grid-filters .grid-filters a",function(e){e.preventDefault(),d("#bb-course-list-grid-filters .grid-filters a").removeClass("active"),d(e.currentTarget).addClass("active");var t=d(e.currentTarget).data("view"),s=d(".ld-course-list-content");s.hasClass("list-view")&&s.removeClass("list-view"),s.hasClass("grid-view")&&s.removeClass("grid-view"),s.addClass(t+"-view"),d.ajax({method:"GET",url:bs_data.ajaxurl,data:"action=buddyboss_lms_save_view&option=bb_theme_learndash_grid_list&type="+t,success:function(e){}})}),d(document).ready(function(){if(d("body #bb-course-list-grid-filters").length){var e="";e=d("#bb-course-list-grid-filters .grid-filters .layout-grid-view").hasClass("active")?"grid-view":"list-view",d(".ld-course-list-content").addClass(e)}}),d(document).on("change","#bb-courses-directory-form [name='orderby'], #bb-courses-directory-form [name='filter-categories'], #bb-courses-directory-form [name='filter-instructors']",function(e){e.preventDefault(),window.BBLMS.fetchCourses(e.target)}),d(document).on("click","#bb-courses-directory-form .bs-sort-button",function(e){e.preventDefault(),e.currentTarget.classList.toggle("active"),d("#bs-courses-order-by").toggleClass("open")}),d(document).on("click","#bb-courses-directory-form .bb-lms-pagination a.page-numbers",function(e){e.preventDefault();var t=1,s=d(this).attr("href").split("/");if(0<s.length)for(var a=0;a<s.length;a++)if("page"===s[a]){t=s[a+1];break}0===d(this).closest("form").find('[name="current_page"]').length&&d("<input>").attr({type:"hidden",name:"current_page"}).appendTo(d(this).closest("form")),d(this).closest("form").find('[name="current_page"]').val(t),window.BBLMS.fetchCoursesPagination(e.target)}),d(document).on("click","#bb-courses-directory-form .component-navigation a:not(.more-button)",function(e){e.preventDefault(),d(this).closest(".component-navigation").find("> li").removeClass("selected"),d(this).closest("li").addClass("selected").append('<i class="bb-icon-loader animate-spin"></i>');var t=BBGetUrlParameter(d(this).attr("href"),"type");d(this).closest("form").find('[name="type"]').val(t),d(this).closest("form").find('[name="current_page"]').val(1),window.BBLMS.fetchCourses(e.target)}),document.addEventListener("click",function(e){var t=d("#course-order-dropdown"),s=e.target;if(t===s&&t.contains(s))return!1;for(var a=d("#bb-courses-directory-form .bs-dropdown"),i=d("#bb-courses-directory-form .bs-dropdown-link"),o=0;o<i.length;o++)i[o]===s||i[o].contains(s)||i[o].classList.remove("active");for(o=0;o<a.length;o++)a[o]!=s.parentElement.nextElementSibling&&a[o].classList.remove("open")}),d("form.bb-courses-directory").on("submit",function(e){return e.preventDefault(),window.BBLMS.fetchCourses(e.target),!1}),d("#bb-courses-directory-form #bs_members_search").on("keypress",function(e){13==e.which&&d(e.target).closest("form.bb-courses-directory").submit()})},toggleTheme:function(){d(document).on("click","#bb-toggle-theme",function(e){e.preventDefault();var t="";d("body").hasClass("bb-dark-theme")?(d.removeCookie("bbtheme",{path:"/"}),d("body").removeClass("bb-dark-theme")):(d.cookie("bbtheme","dark",{path:"/"}),d("body").addClass("bb-dark-theme"),t="dark"),"undefined"!=typeof toggle_theme_ajax&&null!=toggle_theme_ajax&&toggle_theme_ajax.abort();var s={action:"buddyboss_lms_toggle_theme_color",color:t};"undefined"!=typeof toggle_theme_ajax&&null!=toggle_theme_ajax&&(toggle_theme_ajax=d.post(ajaxurl,s,function(e){}))})},learnDashSidePanel:function(){function t(){0<d(".bb-buddypanel.bb-sfwd-aside .site-header--elementor").length&&(setTimeout(function(){d(window).trigger("resize")},300),setTimeout(function(){d(window).trigger("resize")},500))}d(document).on("click",".header-maximize-link",function(e){e.preventDefault(),d("body").addClass("lms-side-panel-close"),d(".lms-topic-sidebar-wrapper").addClass("lms-topic-sidebar-close"),d.cookie("lessonpanel","closed",{path:"/"}),t()}),d(document).on("click",".header-minimize-link",function(e){e.preventDefault(),d("body").removeClass("lms-side-panel-close"),d(".lms-topic-sidebar-wrapper").removeClass("lms-topic-sidebar-close"),d.removeCookie("lessonpanel",{path:"/"}),t()}),d(window).width()<768&&(d("body").addClass("lms-side-panel-close"),d(".lms-topic-sidebar-wrapper").addClass("lms-topic-sidebar-close show-in-mobile"),d(document).on("click",".header-minimize-link",function(e){e.preventDefault(),d("body").addClass("lms-side-panel-close-sm")}),d(document).click(function(e){var t=d(".header-minimize-link");t.is(e.target)||0!==t.has(e.target).length||d("body").removeClass("lms-side-panel-close-sm")})),d(window).on("resize",function(){d(window).width()<768&&d(document).click(function(e){var t=d(".header-minimize-link");t.is(e.target)||0!==t.has(e.target).length||d("body").removeClass("lms-side-panel-close-sm")})})},lms_course_single_js:function(){d(document).on("click",".learndash-course-single-nav",function(e){e.preventDefault(),d("ul.learndash-course-single-main-nav").find("li.current.selected").removeClass("current").removeClass("selected");var t=d(e.currentTarget).closest("li");t.addClass("current"),t.addClass("selected");var s=d(e.currentTarget).data("tab"),a=d(".learndash-course-single-tab-content");d.each(a,function(e){var t=d(this);t.data("tab")==s?t.removeClass("hide"):t.addClass("hide")})})},lms_single_course:function(){function e(){var e=d(".bb-learndash-banner").height(),t=d(".bb-thumbnail-preview .bb-preview-course-link-wrap");if(t.length)var s=t.height();else s=0;var a=e/2+s/2;820<d(window).width()&&d(".bb-single-course-sidebar.bb-preview-wrap").css({"margin-top":"-"+a+"px"})}function t(){var e=d("#main").width();d(".bb-learndash-banner .bb-course-banner-info.container").width(e)}d(".bb-course-video-overlay").magnificPopup({fixedBgPos:!0,fixedContentPos:!0,items:{src:".bb_course_video_details",type:"inline"},callbacks:{open:function(){d.magnificPopup.instance.close=function(){d(".mfp-container .mfp-content .bb_course_video_details video".length)&&(d("video").trigger("pause"),d.magnificPopup.proto.close.call(this))}}}}),e(),t(),d(window).on("resize",function(){t(),e()}),d(".bb-toggle-panel").on("click",function(e){e.preventDefault(),setTimeout(function(){t()},300),setTimeout(function(){t()},600)}),d(".lms-topic-sidebar-wrapper .lms-toggle-lesson").on("click",function(){setTimeout(function(){d(window).trigger("resize")},300)})},lms_user_profile_js:function(){d(document).on("click",".bb-lms-user-profile-tab",function(e){e.preventDefault(),d("ul.bb-lms-user-profile-tabs").find("li.current.selected").removeClass("current").removeClass("selected");var t=d(e.currentTarget).closest("li");t.addClass("current"),t.addClass("selected");var s=d(e.currentTarget).data("tab"),a=d(".bb-lms-user-profile-tab-content");d.each(a,function(e){var t=d(this);t.data("tab")==s?t.removeClass("hide"):t.addClass("hide")})})},quizDetails:function(){if(d("#bb-lms-quiz-id").length){var e=d("#bb-lms-quiz-id").val();d("div.quiz_progress_container").insertBefore(d(".wpProQuiz_results .wpProQuiz_resultTable")),d("#wpProQuiz_"+e).on("learndash-quiz-init",function(){})}},ajaxCompleteProcess:function(){d(document).ajaxComplete(function(e,t,s){if((s.data.indexOf("action=wp_pro_quiz_load_quiz_data")||s.data.indexOf("action=wp_pro_quiz_completed_quiz"))&&s.data&&""!=s.data){var a=s.data.split("&"),i="";for(var o in a)if(-1!=a[o].indexOf("action")){i=void 0!==(i=a[o].split("="))[1]?i[1]:"";break}if(""!=i&&"wp_pro_quiz_load_quiz_data"==i&&d(".wpProQuiz_resultTable").length){d(".bb_avg_progress").show();var r=new ProgressBar.Path("#bb_avg_shape",{duration:3e3,from:{color:"#ECCBFF",width:8},to:{color:"#ECCBFF",width:8},easing:"easeInOut",step:function(e,t){t.path.setAttribute("stroke",e.color),t.path.setAttribute("stroke-width",e.width)}}),n=t.responseJSON.averageResult;n=0<n?-n/100:0,r.animate(n)}if(""!=i&&"wp_pro_quiz_completed_quiz"==i&&d(".wpProQuiz_resultTable").length){a=decodeURIComponent(s.data).split("&");var l="";for(var o in a)if(-1!=a[o].indexOf("results")){l=void 0!==(l=a[o].split("="))[1]?l[1]:"",l=JSON.parse(l);break}void 0!==l.comp.result&&(l=l.comp.result);var c=new ProgressBar.Path("#quiz_shape_progress",{duration:3e3,from:{color:"#00A2FF",width:8},to:{color:"#7FE0FF",width:8},easing:"easeInOut",step:function(e,t){t.path.setAttribute("stroke",e.color),t.path.setAttribute("stroke-width",e.width)}});jQuery(".bb_progressbar_label").text(l+"%"),jQuery(".bb_progressbar_points").text(jQuery(".wpProQuiz_points").text()),0<l&&(l=-l/100),c.animate(l)}}})},quizUpload:function(){function e(){d("input.wpProQuiz_upload_essay[type=file]:not(.styled)").each(function(){var e=d(this),t=e.attr("id");e.addClass("styled"),e.after('<label for="'+t+'">'+bs_data.translation.choose_a_file_label+"</label>")}),d("input.wpProQuiz_upload_essay[type=file]").change(function(e){var t=d(this);t.next().html(t.val());0===t.val().length?t.next().html(bs_data.translation.choose_a_file_label):t.next().html(t.val().replace(/C:\\fakepath\\/i,""))})}e(),d(document).ajaxComplete(function(){e()})},courseViewCookie:function(){d("#bb-courses-directory-form .layout-grid-view").click(function(){d.cookie("courseview","grid")}),d("#bb-courses-directory-form .layout-list-view").click(function(){d.cookie("courseview","list")})},bbStickyLdSidebar:function(){function e(){var e=d("#masthead").outerHeight();if(820<d(window).width()&&0==d(".bb-ld-sticky-sidebar .ld-sidebar-widgets").length){d(".bb-ld-sticky-sidebar").stick_in_parent({offset_top:e+45});var t=0;d("body").hasClass("admin-bar")&&(t=32),d(".lms-topic-sidebar-data").css({"max-height":"calc(100vh - "+(e+t)+"px",top:e+t+"px"})}else d(".bb-ld-sticky-sidebar").trigger("sticky_kit:detach")}e(),d(window).on("resize",function(){e()}),d(window).on("scroll",function(){d("#learndash-payment-button-dropdown").length&&(d("#learndash-payment-button-dropdown").fadeOut("fast"),d(".learndash_checkout_buttons .learndash_checkout_button").removeClass("jq-dropdown-open").blur())}),0<d(".wpProQuiz_matrixSortString").length&&d("html").addClass("quiz-sort")},setElementorSpacing:function(){if(0<d(".elementor-location-header").length){var e=d(".elementor-location-header").outerHeight();d(".lms-topic-sidebar-wrapper, #learndash-page-content").css({"min-height":"calc(100vh - "+e+"px)"})}},showQuizNavigation:function(){var e=d(".wpProQuiz_list").find(".wpProQuiz_listItem"),t=d("#bb-lms-quiz-navigation");if(e.length&&t.length){for(var s="<ul>",a=1;a<=e.length;a++)s+='<li><a href="#" class="bb-lms-quiz-questions" data-index="'+(a-1)+'">'+a+"</a></li>";s+="</ul>",t.html(s)}},StyleInputQuestion:function(){function e(){d('.wpProQuiz_questionInput:not([type="text"]):not([type="email"]):not([type="tel"]):not([type="date"])').each(function(){d(this).hasClass("bbstyled")||d(this).addClass("bbstyled").after('<span class="input-style"></span>')})}e(),d(document).ajaxComplete(function(){e()})},singleLesson:function(){document.getElementById("learndash-page-content")&&d("#learndash-page-content").scroll(function(){d(window).trigger("resize")})},singleTopic:function(){var e=d("body.single-sfwd-topic .lms-topic-item.current");e.length&&(e.closest("div").show(),e.parents().closest("li").removeClass("lms-lesson-turnover"));for(var t=[".sfwd-lessons-template-default",".sfwd-topic-template-default",".sfwd-quiz-template-default"],s=0;s<t.length;s++)0<d(t[s]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap #comments.comments-area").length&&d(t[s]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap #comments.comments-area").remove(),0<d(t[s]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap .ld-focus-comments").length&&d(t[s]+" #learndash-page-content #learndash-content #learndash-page-content .learndash_content_wrap .ld-focus-comments").remove()},singleQuiz:function(){var e=d("body.single-sfwd-quiz .lms-quiz-item.current");if(e.length&&(e.closest("div").show(),e.parents().closest("li").removeClass("lms-lesson-turnover")),768<d(window).width()&&0<d(".wpProQuiz_quiz #bbpress-forums .bs-topic-sidebar-inner").length){['.wpProQuiz_content input.wpProQuiz_button[name="startQuiz"]','.wpProQuiz_content .wpProQuiz_QuestionButton[value="Next"]','.wpProQuiz_content .wpProQuiz_QuestionButton[value="Back"]'].forEach(function(e){d(e).click(function(){setTimeout(function(){d(window).trigger("scroll")},0)})})}},inforBarStatus:function(){d(".ld-course-status-segment").length&&d(".ld-course-status-segment").each(function(){""==d(this).find(".ld-course-status-label").text().trim()&&d(this).find(".ld-course-status-label").addClass("no-label")})}},d(document).ready(function(){window.BBLMS.init()})}(jQuery);