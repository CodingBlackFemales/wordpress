/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
jQuery(function(k){function C(e,i,o){if(e.find(".bbp-reply-form form").find("#bbp-template-notices").html(""),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media){e.find(".gif-media-search-dropdown").removeClass("open"),e.find("#whats-new-toolbar .toolbar-button").removeClass("active disable");var t=e.find("#whats-new-attachments .forums-attached-gif-container");t.length&&(t.addClass("closed"),t.find(".gif-image-container img").attr("src",""),t[0].style=""),e.find("#bbp_media_gif").length&&e.find("#bbp_media_gif").val(""),void 0!==i&&o&&(void 0!==bp.Nouveau.Media.dropzone_obj[i]&&(bp.Nouveau.Media.dropzone_obj[i].destroy(),bp.Nouveau.Media.dropzone_obj.splice(i,1),bp.Nouveau.Media.dropzone_media.splice(i,1)),e.find('div#forums-post-media-uploader[data-key="'+i+'"]').html(""),e.find('div#forums-post-media-uploader[data-key="'+i+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-document-uploader[data-key="'+i+'"]').html(""),e.find('div#forums-post-document-uploader[data-key="'+i+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-video-uploader[data-key="'+i+'"]').html(""),e.find('div#forums-post-video-uploader[data-key="'+i+'"]').addClass("closed").removeClass("open"))}}function j(e,i){var o=k(e).find(i+" > p").removeAttr("br").removeAttr("a").text(),t="",d="",n="",r=0;if(0<=o.indexOf("http://")?(n=o.indexOf("http://"),r=1):0<=o.indexOf("https://")?(n=o.indexOf("https://"),r=1):0<=o.indexOf("www.")&&(n=o.indexOf("www"),r=1),1===r){for(var a=n;a<o.length&&(" "!==o[a]&&"\n"!==o[a]);a++)t+=o[a];""!==t&&(d=k.trim(o.replace(t,""))),0===k.trim(d).length&&0!==k(e).find("iframe").length&&""!==t&&k(e).find(i+" > p:first").hide()}}k("body").hasClass("reply-edit")||k(document).on("submit",".bbp-reply-form form",function(e){if(e.preventDefault(),k(this).hasClass("submitting"))return!1;k(this).addClass("submitting");var i=!0,o=!0,t=k(e.target).find(".bbp-the-content").data("key"),d=!1;void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&(d=window.forums_medium_reply_editor[t]),(0<k(this).find("#bbp_media").length&&0<k(this).find("#bbp_document").length&&0<k(this).find("#bbp_video").length&&0<k(this).find("#bbp_media_gif").length&&""==k(this).find("#bbp_media").val()&&""==k(this).find("#bbp_document").val()&&""==k(this).find("#bbp_video").val()&&""==k(this).find("#bbp_media_gif").val()||0<k(this).find("#bbp_media").length&&0<k(this).find("#bbp_document").length&&0<k(this).find("#bbp_video").length&&k(this).find("#bbp_media_gif").length<=0&&""==k(this).find("#bbp_media").val()&&""==k(this).find("#bbp_video").val()&&""==k(this).find("#bbp_document").val()||0<k(this).find("#bbp_media_gif").length&&k(this).find("#bbp_media").length<=0&&k(this).find("#bbp_document").length<=0&&k(this).find("#bbp_video").length<=0&&""==k(this).find("#bbp_media_gif").val())&&(o=!1),0<k(this).find("#link_preview_data").length&&""!==k(this).find("#link_preview_data").val()&&(""!==JSON.parse(k(this).find("#link_preview_data").val()).link_url&&(o=!0));d&&""===k(k.parseHTML(k(this).find("#bbp_reply_content").val())).text().trim()&&0==o?(k(this).find(".bbp-the-content").addClass("error"),i=!1):d||""!==k.trim(k(this).find("#bbp_reply_content").val())||0!=o?(d&&k(this).find(".bbp-the-content").removeClass("error"),k(this).find("#bbp_reply_content").removeClass("error")):(k(this).find("#bbp_reply_content").addClass("error"),i=!1),i?function(e,i,o,t){var w={action:e,nonce:i};k.each(o,function(e,i){"action"===i.name?w.bbp_reply_form_action=i.value:w[i.name]=i.value});var g=t.closest("#bbpress-forums");k.post(window.bbpReplyAjaxJS.bbp_ajaxurl,w,function(d){if(d.success){g.find(".bbp-reply-form form").removeClass("submitting");var e="",i=k(".bb-quick-reply-form-wrap");if("edit"===d.reply_type)e='<li class="highlight">'+d.content+"</li>",k("#post-"+d.reply_id).parent("li").replaceWith(e).find("li").each(function(){j(this,".bbp-reply-content")});else{if(window.bbpReplyAjaxJS.threaded_reply&&d.reply_parent&&d.reply_parent!==d.reply_id){var o=null,t="1";if(k("#post-"+d.reply_parent).parent("li").data("depth")==window.bbpReplyAjaxJS.threaded_reply_depth){var n=parseInt(window.bbpReplyAjaxJS.threaded_reply_depth)-1;o=k("#post-"+d.reply_parent).closest("li.depth-"+n),t=window.bbpReplyAjaxJS.threaded_reply_depth}else o=k("#post-"+d.reply_parent).parent("li"),t=parseInt(o.data("depth"))+1;var r="ul";g.find(".bb-single-reply-list").is("ol")&&(r="ol"),o.find(">"+r+".bbp-threaded-replies").length||o.append("<"+r+' class="bbp-threaded-replies"></'+r+">"),e='<li class="highlight depth-'+t+'" data-depth="'+t+'">'+d.content+"</li>",o.find(">"+r+".bbp-threaded-replies").append(e).find("li").each(function(){j(this,".bbp-reply-content")})}else if(d.current_page==d.total_pages)e='<li class="highlight depth-1" data-depth="1">'+d.content+"</li>",g.find(".bb-single-reply-list").append(e).find("li").each(function(){j(this,".bbp-reply-content")});else{var a=d.redirect_url,p=a.substring(0,a.indexOf("#"));i.length||i.is(":visible")||(window.location.href=p)}jQuery(window).scroll()}if(void 0!==d.tags&&null!==d.tags){var l=g.find(".item-tags"),s=g.find(".item-tags ul");"none"===l.css("display")&&""!==d.tags?(l.append(d.tags),l.show()):""!==d.tags?(s.remove(),l.append(d.tags)):(l.hide(),s.remove())}""!==e&&(0<k("#post-"+d.reply_id).length&&k("body").animate({scrollTop:k("#post-"+d.reply_id).offset().top},500),setTimeout(function(){k(e).removeClass("highlight")},2e3));var m=g.find(".bbp-reply-form form").find("#forums-post-media-uploader").data("key"),b=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[m]&&bp.Nouveau.Media.dropzone_media[m].length){b=!0;for(var u=0;u<bp.Nouveau.Media.dropzone_media[m].length;u++)bp.Nouveau.Media.dropzone_media[m][u].saved=!0}var f=g.find(".bbp-reply-form form").find("#forums-post-document-uploader").data("key"),c=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[f]&&bp.Nouveau.Media.dropzone_media[f].length){c=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[f].length;u++)bp.Nouveau.Media.dropzone_media[f][u].saved=!0}var _=g.find(".bbp-reply-form form").find("#forums-post-video-uploader").data("key"),v=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[_]&&bp.Nouveau.Media.dropzone_media[_].length){v=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[_].length;u++)bp.Nouveau.Media.dropzone_media[_][u].saved=!0}var h=g.find(".bbp-reply-form form").find(".bbp-the-content").data("key");void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[h]&&window.forums_medium_reply_editor[h].resetContent(),g.find(".bbp-reply-form form").find(".bbp-the-content").removeClass("error"),i.length&&i.is(":visible")?g.find(".bbp-reply-form").hide():g.find("#bbp-close-btn").trigger("click"),g.find(".header-total-reply-count.bp-hide").removeClass("bp-hide"),d.total_reply_count&&(g.find(".header-total-reply-count .topic-reply-count").html(d.total_reply_count),g.find(".topic-lead .bs-replies").html(d.total_reply_count),k(".bs-forums-items").removeClass("topic-list-no-replies")),0<g.find(".replies-content .bp-feedback.info").length&&g.find(".replies-content .bp-feedback.info").remove(),g.find("#bbp_reply_content").val(""),g.find("#link_preview_data").val(""),bp.Nouveau.linkPreviews.options.link_url=null,bp.Nouveau.linkPreviews.options.link_image_index_save=0,C(g,m,b),C(g,f,c),C(g,_,v);var y=g.find(".scrubberpost");y.length&&y.each(function(e){if(k(this).hasClass("post-"+d.reply_id)){var i=k("#post-"+d.reply_id).parents("#bbpress-forums").find(".scrubber"),o=k(i).data("key"),t=window.BuddyBossThemeBbpScrubber.scrubbers[o];return t.total_item=parseInt(t.total_item,10)+1,t.to=parseInt(t.to,10)+1,window.BuddyBossThemeBbpScrubber.goToPost(parseInt(e,10)+1,"",o),!1}})}else void 0!==d.content&&g.find(".bbp-reply-form form").find("#bbp-template-notices").html(d.content);g.find(".bbp-reply-form form").removeClass("submitting"),k(".bbp-reply-form").trigger("bbp_after_submit_reply_form",{response:d,topic_id:w.bbp_topic_id})})}("reply",window.bbpReplyAjaxJS.reply_nonce,k(this).serializeArray(),k(this)):k(this).removeClass("submitting")});var s={init:function(){this.ajax_call(),this.moveToReply()},ajax_call:function(){k(document).on("click",'a[data-btn-id="bbp-reply-form"]',function(e){e.preventDefault();var i=k(this),o=i.closest("li"),n=i.data("topic-id"),r=o.find(".activity-discussion-title-wrap a").text(),t=o.data("bp-activity"),d=t.group_id?t.group_id:0;k(".bb-quick-reply-form-wrap").length&&k(".bb-quick-reply-form-wrap").remove(),k("body").addClass("bb-modal-overlay-open").append('<div class="bb-modal-overlay js-modal-close"></div>'),k(".bb-modal-overlay").fadeTo(0,1);var a=i.closest(".bb-grid .content-area"),p='<div id="bbpress-forums" class="bbpress-forums-activity bb-quick-reply-form-wrap"><div class="bbp-reply-form bb-modal bb-modal-box"><form id="new-post" name="new-post" method="post" action=""><fieldset class="bbp-form"><legend>'+window.bbpReplyAjaxJS.reply_to_text+' <span id="bbp-reply-exerpt"> '+r+'...</span><a href="#" id="bbp-close-btn" class="js-modal-close"><i class="bb-icon-close"></i></a></legend><div><div class="bbp-the-content-wrapper"><div class="bbp-the-content bbp_editor_reply_content medium-editor-element" contenteditable="true" data-placeholder="'+window.bbpReplyAjaxJS.type_reply_here_text+'"></div></div></fieldset></form></div></div>';a.append(p),a.find(".bb-quick-reply-form-wrap").show(0).find(".bbp-reply-form").addClass("bb-modal bb-modal-box").show(0),a.find(".bb-quick-reply-form-wrap .bbp-the-content-wrapper").addClass("loading").show(0);var l={action:"quick_reply_ajax",topic_id:n,group_id:d,"bbp-ajax":1};k.post(ajaxurl,l,function(e){if(a.append(e),a.find("div.bb-quick-reply-form-wrap").length){var i=a.find('div.bb-quick-reply-form-wrap[data-component="activity"');if(i.show(),i.not('[data-component="activity"]').hide(),i.find(".bbp-reply-form").length&&(i.find(".bbp-reply-form").addClass("bb-modal bb-modal-box"),i.find(".bbp-reply-form").show(),i.find(".bbp-reply-form").find("#bbp-reply-exerpt").text(r+"..."),i.find(".bbp-reply-form").find("#bbp_topic_id").val(n),s.addSelect2(i),s.addEditor(i),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media)){if(void 0!==bp.Nouveau.Media.options){var o=i.find(".bbp-reply-form").find(".forum-post-media-template").length?i.find(".bbp-reply-form").find(".forum-post-media-template")[0].innerHTML:"";bp.Nouveau.Media.options.previewTemplate=o}if(void 0!==bp.Nouveau.Media.documentOptions){var t=i.find(".bbp-reply-form").find(".forum-post-document-template").length?i.find(".bbp-reply-form").find(".forum-post-document-template")[0].innerHTML:"";bp.Nouveau.Media.documentOptions.previewTemplate=t}if(void 0!==bp.Nouveau.Media.videoOptions){var d=i.find(".bbp-reply-form").find(".forum-post-video-template").length?i.find(".bbp-reply-form").find(".forum-post-video-template")[0].innerHTML:"";bp.Nouveau.Media.videoOptions.previewTemplate=d}}i.find(".bbp-no-reply").length&&(i.find(".bbp-no-reply").addClass("bb-modal bb-modal-box"),i.find(".bbp-no-reply").show())}})})},addSelect2:function(e){var i=e.find(".bbp_topic_tags_dropdown"),d=[];i.length&&(i.select2({placeholder:i.attr("placeholder"),dropdownParent:i.closest("form").parent(),minimumInputLength:1,closeOnSelect:!0,tags:!0,language:"undefined"!=typeof bp_select2&&void 0!==bp_select2.lang?bp_select2.lang:"en",dropdownCssClass:"bb-select-dropdown bb-tag-list-dropdown",containerCssClass:"bb-select-container",tokenSeparators:[","," "],ajax:{url:bbpCommonJsData.ajax_url,dataType:"json",delay:1e3,data:function(e){return k.extend({},e,{_wpnonce:bbpCommonJsData.nonce,action:"search_tags"})},cache:!0,processResults:function(t){return!1===k.isEmptyObject(d)&&k.each(d,function(e,i){for(var o=0;o<t.data.results.length;o++)t.data.results[o].id===i&&t.data.results.splice(o,1)}),{results:t&&t.success?t.data.results:[]}}}}),i.on("select2:select",function(e){var i=e.params.data;d.push(i.id);var o=d.join(",");k("body #bbp_topic_tags").val(o),k("body .select2-search__field").trigger("click"),k("body .select2-search__field").trigger("click")}),i.on("select2:unselect",function(e){var i=e.params.data,o=(d=k.grep(d,function(e){return e!==i.id})).join(",");k("body #bbp_topic_tags").val(o),0===o.length&&k(window).scrollTop(k(window).scrollTop()+1)}))},addEditor:function(o){if(void 0!==window.MediumEditor){var t={buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor","pre"],relativeContainer:o.find("#whats-new-toolbar")[0],static:!0,updateOnEmptySelection:!0};o.find(".bbp_editor_reply_content").length&&(window.forums_medium_reply_editor=[],o.find(".bbp_editor_reply_content").each(function(e,d){var n=k(d).data("key");if(window.forums_medium_reply_editor[n]=new window.MediumEditor(d,{placeholder:{text:window.bbpEditorJsStrs.type_reply,hideOnClick:!0},toolbar:t,paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav"],unwrapTags:["ul","ol","li"]},imageDragging:!1,anchor:{linkValidation:!0}}),window.forums_medium_reply_editor[n].subscribe("editableInput",function(){var i=k(d).closest("form").find("#bbp_reply_content"),e=window.forums_medium_reply_editor[n].getContent(),o=document.createElement("div");o.innerHTML=e,k(o).find("span.atwho-query").replaceWith(function(){return this.innerText}),k(o).find("img.emoji").each(function(e,i){k(i).addClass("emojioneemoji");var o=k(i).attr("alt");k(i).attr("data-emoji-char",o),k(i).removeClass("emoji")}),k(o).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),i.val(k(o).html());var t=jQuery(d).html();t=(t=jQuery.trim(t.replace(/<div>/gi,"\n").replace(/<\/div>/gi,""))).replace(/&nbsp;/g," "),""!==jQuery("<p>"+t+"</p>").text()||0<=t.indexOf("emojioneemoji")?jQuery(d).closest("form").addClass("has-content"):jQuery(d).closest("form").removeClass("has-content"),!_.isUndefined(BP_Nouveau.forums.params.link_preview)&&BP_Nouveau.forums.params.link_preview&&(null!=window.forums_medium_reply_editor[n].linkTimeout&&clearTimeout(window.forums_medium_reply_editor[n].linkTimeout),window.forums_medium_reply_editor[n].linkTimeout=setTimeout(function(){var e=jQuery(d).closest("form");window.forums_medium_reply_editor[n].linkTimeout=null,bp.Nouveau.linkPreviews.currentTarget=window.forums_medium_reply_editor[n],bp.Nouveau.linkPreviews.scrapURL(i.val(),e.find("#whats-new-attachments"),e.find("#link_preview_data"))},500))}),!_.isUndefined(BP_Nouveau.forums.params.link_preview)&&BP_Nouveau.forums.params.link_preview){var i=jQuery(d).closest("form").find("#link_preview_data");0<i.length&&i.on("change",function(){if(""!==i.val()){var e=JSON.parse(i.val());e&&""!==e.link_url?jQuery(d).closest("form").addClass("has-link-preview"):jQuery(d).closest("form").removeClass("has-link-preview")}})}o.on("click","#whats-new-toolbar .show-toolbar",function(e){e.preventDefault();var i=k(e.currentTarget).closest(".bbp-reply-form").find(".bbp_editor_reply_content").data("key"),o=k(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");k(e.currentTarget).find(".toolbar-button").toggleClass("active"),k(e.currentTarget).find(".toolbar-button").hasClass("active")?(k(e.currentTarget).attr("data-bp-tooltip",k(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.forums_medium_reply_editor[i].exportSelection()&&o.addClass("medium-editor-toolbar-active")):(k(e.currentTarget).attr("data-bp-tooltip",k(e.currentTarget).attr("data-bp-tooltip-show")),null===window.forums_medium_reply_editor[i].exportSelection()&&o.removeClass("medium-editor-toolbar-active")),k(window.forums_medium_reply_editor[i].elements[0]).focus(),o.toggleClass("active")})}))}"undefined"!=typeof BP_Nouveau&&void 0!==BP_Nouveau.media&&void 0!==BP_Nouveau.media.emoji&&o.find(".bbp-the-content").length&&void 0!==k.prototype.emojioneArea&&o.find(".bbp-the-content").each(function(e,i){var o=k(i).attr("id"),t=k(i).data("key");k("#"+o).emojioneArea({standalone:!0,hideSource:!1,container:k("#"+o).closest("form").find("#whats-new-toolbar > .post-emoji"),autocomplete:!1,pickerPosition:"bottom",hidePickerOnBlur:!0,useInternalCDN:!1,events:{ready:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[t]&&window.forums_medium_topic_editor[t].resetContent(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&window.forums_medium_reply_editor[t].resetContent(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[t]&&window.forums_medium_forum_editor[t].resetContent()},emojibtn_click:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[t]&&window.forums_medium_topic_editor[t].checkContentChanged(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&window.forums_medium_reply_editor[t].checkContentChanged(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[t]&&window.forums_medium_forum_editor[t].checkContentChanged(),void 0===window.forums_medium_topic_editor&&k("#"+o).keyup(),k("#"+o)[0].emojioneArea.hidePicker()},search_keypress:function(){var e=this.search.val().toLowerCase();this.search.val(e)}}})}),void 0===window.forums_medium_reply_editor&&jQuery("#bbp_reply_content").on("keyup",function(){""!==jQuery("#bbp_reply_content").val().trim()?jQuery(this).closest("form").addClass("has-content"):jQuery(this).closest("form").removeClass("has-content")})},moveToReply:function(){if(0<window.location.href.indexOf("#post-")){var e=window.location.href.split("#post-"),i=e&&void 0!==e[1]?e[1]:"";if(!i||0==k("#post-"+i).length)return;var o,t=0;0<k("#wpadminbar").length&&(t=k("#wpadminbar").innerHeight()),o=k("body").hasClass("sticky-header")?k("#post-"+i).parent().offset().top-k("#masthead").innerHeight()-t:k("#post-"+i).parent().offset().top-t,k("html, body").animate({scrollTop:o},200)}}};s.init()});